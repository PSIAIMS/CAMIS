<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R vs SAS MMRM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contribution/contribution.html"> 
<span class="menu-text">Contribute</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-publications-and-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Publications and projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-publications-and-projects">    
        <li>
    <a class="dropdown-item" href="../publication/white_paper.html">
 <span class="dropdown-text">White paper</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publication/conference.html">
 <span class="dropdown-text">Conferences</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publication/dissertation.html">
 <span class="dropdown-text">Dissertation</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-news" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">News</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-news">    
        <li>
    <a class="dropdown-item" href="../minutes/index.html">
 <span class="dropdown-text">Meeting minutes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../blogs/index.html">
 <span class="dropdown-text">Blogs</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/PSIAIMS/CAMIS/">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/PSIAIMS/CAMIS/issues/">
            Report a Difference
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets">Datasets</a>
  <ul class="collapse">
  <li><a href="#fev-data" id="toc-fev-data" class="nav-link" data-scroll-target="#fev-data">FEV Data</a></li>
  <li><a href="#bcva-data" id="toc-bcva-data" class="nav-link" data-scroll-target="#bcva-data">BCVA Data</a></li>
  </ul></li>
  <li><a href="#model-implementations" id="toc-model-implementations" class="nav-link" data-scroll-target="#model-implementations">Model Implementations</a>
  <ul class="collapse">
  <li><a href="#ante-dependence-heterogeneous" id="toc-ante-dependence-heterogeneous" class="nav-link" data-scroll-target="#ante-dependence-heterogeneous">Ante-dependence (heterogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix" id="toc-proc-glimmix" class="nav-link" data-scroll-target="#proc-glimmix"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm" id="toc-mmrm" class="nav-link" data-scroll-target="#mmrm"><code>mmrm</code></a></li>
  </ul></li>
  <li><a href="#ante-dependence-homogeneous" id="toc-ante-dependence-homogeneous" class="nav-link" data-scroll-target="#ante-dependence-homogeneous">Ante-dependence (homogeneous)</a>
  <ul class="collapse">
  <li><a href="#mmrm-1" id="toc-mmrm-1" class="nav-link" data-scroll-target="#mmrm-1"><code>mmrm</code></a></li>
  </ul></li>
  <li><a href="#auto-regressive-heterogeneous" id="toc-auto-regressive-heterogeneous" class="nav-link" data-scroll-target="#auto-regressive-heterogeneous">Auto-regressive (heterogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-1" id="toc-proc-glimmix-1" class="nav-link" data-scroll-target="#proc-glimmix-1"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-2" id="toc-mmrm-2" class="nav-link" data-scroll-target="#mmrm-2"><code>mmrm</code></a></li>
  <li><a href="#gls" id="toc-gls" class="nav-link" data-scroll-target="#gls"><code>gls</code></a></li>
  </ul></li>
  <li><a href="#auto-regressive-homogeneous" id="toc-auto-regressive-homogeneous" class="nav-link" data-scroll-target="#auto-regressive-homogeneous">Auto-regressive (homogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-2" id="toc-proc-glimmix-2" class="nav-link" data-scroll-target="#proc-glimmix-2"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-3" id="toc-mmrm-3" class="nav-link" data-scroll-target="#mmrm-3"><code>mmrm</code></a></li>
  <li><a href="#gls-1" id="toc-gls-1" class="nav-link" data-scroll-target="#gls-1"><code>gls</code></a></li>
  <li><a href="#glmmtmb" id="toc-glmmtmb" class="nav-link" data-scroll-target="#glmmtmb"><code>glmmTMB</code></a></li>
  </ul></li>
  <li><a href="#compound-symmetry-heterogeneous" id="toc-compound-symmetry-heterogeneous" class="nav-link" data-scroll-target="#compound-symmetry-heterogeneous">Compound symmetry (heterogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-3" id="toc-proc-glimmix-3" class="nav-link" data-scroll-target="#proc-glimmix-3"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-4" id="toc-mmrm-4" class="nav-link" data-scroll-target="#mmrm-4"><code>mmrm</code></a></li>
  <li><a href="#gls-2" id="toc-gls-2" class="nav-link" data-scroll-target="#gls-2"><code>gls</code></a></li>
  <li><a href="#glmmtmb-1" id="toc-glmmtmb-1" class="nav-link" data-scroll-target="#glmmtmb-1"><code>glmmTMB</code></a></li>
  </ul></li>
  <li><a href="#compound-symmetry-homogeneous" id="toc-compound-symmetry-homogeneous" class="nav-link" data-scroll-target="#compound-symmetry-homogeneous">Compound symmetry (homogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-4" id="toc-proc-glimmix-4" class="nav-link" data-scroll-target="#proc-glimmix-4"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-5" id="toc-mmrm-5" class="nav-link" data-scroll-target="#mmrm-5"><code>mmrm</code></a></li>
  <li><a href="#gls-3" id="toc-gls-3" class="nav-link" data-scroll-target="#gls-3"><code>gls</code></a></li>
  </ul></li>
  <li><a href="#spatial-exponential" id="toc-spatial-exponential" class="nav-link" data-scroll-target="#spatial-exponential">Spatial exponential</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-5" id="toc-proc-glimmix-5" class="nav-link" data-scroll-target="#proc-glimmix-5"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-6" id="toc-mmrm-6" class="nav-link" data-scroll-target="#mmrm-6"><code>mmrm</code></a></li>
  <li><a href="#gls-4" id="toc-gls-4" class="nav-link" data-scroll-target="#gls-4"><code>gls</code></a></li>
  <li><a href="#glmmtmb-2" id="toc-glmmtmb-2" class="nav-link" data-scroll-target="#glmmtmb-2"><code>glmmTMB</code></a></li>
  </ul></li>
  <li><a href="#toeplitz-heterogeneous" id="toc-toeplitz-heterogeneous" class="nav-link" data-scroll-target="#toeplitz-heterogeneous">Toeplitz (heterogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-6" id="toc-proc-glimmix-6" class="nav-link" data-scroll-target="#proc-glimmix-6"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-7" id="toc-mmrm-7" class="nav-link" data-scroll-target="#mmrm-7"><code>mmrm</code></a></li>
  <li><a href="#glmmtmb-3" id="toc-glmmtmb-3" class="nav-link" data-scroll-target="#glmmtmb-3"><code>glmmTMB</code></a></li>
  </ul></li>
  <li><a href="#toeplitz-homogeneous" id="toc-toeplitz-homogeneous" class="nav-link" data-scroll-target="#toeplitz-homogeneous">Toeplitz (homogeneous)</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-7" id="toc-proc-glimmix-7" class="nav-link" data-scroll-target="#proc-glimmix-7"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-8" id="toc-mmrm-8" class="nav-link" data-scroll-target="#mmrm-8"><code>mmrm</code></a></li>
  </ul></li>
  <li><a href="#unstructured" id="toc-unstructured" class="nav-link" data-scroll-target="#unstructured">Unstructured</a>
  <ul class="collapse">
  <li><a href="#proc-glimmix-8" id="toc-proc-glimmix-8" class="nav-link" data-scroll-target="#proc-glimmix-8"><code>PROC GLIMMIX</code></a></li>
  <li><a href="#mmrm-9" id="toc-mmrm-9" class="nav-link" data-scroll-target="#mmrm-9"><code>mmrm</code></a></li>
  <li><a href="#gls-5" id="toc-gls-5" class="nav-link" data-scroll-target="#gls-5"><code>gls</code></a></li>
  <li><a href="#lmer" id="toc-lmer" class="nav-link" data-scroll-target="#lmer"><code>lmer</code></a></li>
  <li><a href="#glmmtmb-4" id="toc-glmmtmb-4" class="nav-link" data-scroll-target="#glmmtmb-4"><code>glmmTMB</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#benchmarking" id="toc-benchmarking" class="nav-link" data-scroll-target="#benchmarking">Benchmarking</a>
  <ul class="collapse">
  <li><a href="#convergence-times" id="toc-convergence-times" class="nav-link" data-scroll-target="#convergence-times">Convergence Times</a>
  <ul class="collapse">
  <li><a href="#fev-data-1" id="toc-fev-data-1" class="nav-link" data-scroll-target="#fev-data-1">FEV Data</a></li>
  <li><a href="#bcva-data-1" id="toc-bcva-data-1" class="nav-link" data-scroll-target="#bcva-data-1">BCVA Data</a></li>
  </ul></li>
  <li><a href="#marginal-treatment-effect-estimates-comparison" id="toc-marginal-treatment-effect-estimates-comparison" class="nav-link" data-scroll-target="#marginal-treatment-effect-estimates-comparison">Marginal Treatment Effect Estimates Comparison</a>
  <ul class="collapse">
  <li><a href="#fev-data-2" id="toc-fev-data-2" class="nav-link" data-scroll-target="#fev-data-2">FEV Data</a></li>
  <li><a href="#bcva-data-2" id="toc-bcva-data-2" class="nav-link" data-scroll-target="#bcva-data-2">BCVA Data</a></li>
  </ul></li>
  <li><a href="#impact-of-missing-data-on-convergence-rates" id="toc-impact-of-missing-data-on-convergence-rates" class="nav-link" data-scroll-target="#impact-of-missing-data-on-convergence-rates">Impact of Missing Data on Convergence Rates</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R vs SAS MMRM</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this vignette we briefly compare the <code>mmrm::mmrm</code>, SAS’s <code>PROC GLIMMIX</code>, <code>nlme::gls</code>, <code>lme4::lmer</code>, and <code>glmmTMB::glmmTMB</code> functions for fitting mixed models for repeated measures (MMRMs). A primary difference in these implementations lies in the covariance structures that are supported “out of the box”. In particular, <code>PROC GLIMMIX</code> and <code>mmrm</code> are the only procedures which provide support for many of the most common MMRM covariance structures. Most covariance structures can be implemented in <code>gls</code>, though users are required to define them manually. <code>lmer</code> and <code>glmmTMB</code> are more limited. We find that <code>mmmrm</code> converges more quickly than other R implementations while also producing estimates that are virtually identical to <code>PROC GLIMMIX</code>’s.</p>
</section>
<section id="datasets" class="level1">
<h1>Datasets</h1>
<p>Two datasets are used to illustrate model fitting with the <code>mmrm</code>, <code>lme4</code>, <code>nlme</code>, <code>glmmTMB</code> R packages as well as <code>PROC GLIMMIX</code>. These data are also used to compare these implementations’ operating characteristics.</p>
<section id="fev-data" class="level2">
<h2 class="anchored" data-anchor-id="fev-data">FEV Data</h2>
<p>The FEV dataset contains measurements of FEV1 (forced expired volume in one second), a measure of how quickly the lungs can be emptied. Low levels of FEV1 may indicate chronic obstructive pulmonary disease (COPD). It is summarized below.</p>
<pre><code>                                      Stratified by ARMCD
                               Overall       PBO           TRT
  n                              800           420           380
  USUBJID (%)
     PT[1-200]                   200           105 (52.5)     95 (47.5)
  AVISIT
     VIS1                        200           105            95
     VIS2                        200           105            95
     VIS3                        200           105            95
     VIS4                        200           105            95
  RACE (%)
     Asian                       280 (35.0)    152 (36.2)    128 (33.7)
     Black or African American   300 (37.5)    184 (43.8)    116 (30.5)
     White                       220 (27.5)     84 (20.0)    136 (35.8)
  SEX = Female (%)               424 (53.0)    220 (52.4)    204 (53.7)
  FEV1_BL (mean (SD))          40.19 (9.12)  40.46 (8.84)  39.90 (9.42)
  FEV1 (mean (SD))             42.30 (9.32)  40.24 (8.67)  44.45 (9.51)
  WEIGHT (mean (SD))            0.52 (0.23)   0.52 (0.23)   0.51 (0.23)
  VISITN (mean (SD))            2.50 (1.12)   2.50 (1.12)   2.50 (1.12)
  VISITN2 (mean (SD))          -0.02 (1.03)   0.01 (1.07)  -0.04 (0.98)</code></pre>
</section>
<section id="bcva-data" class="level2">
<h2 class="anchored" data-anchor-id="bcva-data">BCVA Data</h2>
<p>The BCVA dataset contains data from a randomized longitudinal ophthalmology trial evaluating the change in baseline corrected visual acuity (BCVA) over the course of 10 visits. BCVA corresponds to the number of letters read from a visual acuity chart. A summary of the data is given below:</p>
<pre><code>                                      Stratified by ARMCD
                               Overall         CTL            TRT
  n                             8605          4123           4482
  USUBJID (%)
     PT[1-1000]                 1000           494 (49.4)     506 (50.6)
  AVISIT
     VIS1                        983           482            501
     VIS2                        980           481            499
     VIS3                        960           471            489
     VIS4                        946           458            488
     VIS5                        925           454            471
     VIS6                        868           410            458
     VIS7                        816           388            428
     VIS8                        791           371            420
     VIS9                        719           327            392
     VIS10                       617           281            336
  RACE (%)
     Asian                       297 (29.7)    151 (30.6)     146 (28.9)
     Black or African American   317 (31.7)    149 (30.1)     168 (33.2)
     White                       386 (38.6)    194 (39.3)     192 (37.9)
  BCVA_BL (mean (SD))          75.12 (9.93)  74.90 (9.76)   75.40 (10.1)
  BCVA_CHG (mean (SD))
     VIS1                       5.59 (1.31)   5.32 (1.23)    5.86 (1.33)
     VIS10                      9.18 (2.91)   7.49 (2.58)   10.60 (2.36)</code></pre>
</section>
</section>
<section id="model-implementations" class="level1 tabset">
<h1 class="tabset">Model Implementations</h1>
<p>Listed below are some of the most commonly used covariance structures used when fitting MMRMs. We indicate which matrices are available “out of the box” for each implementation considered in this vignette. Note that this table is not exhaustive; <code>PROC GLIMMIX</code> and <code>glmmTMB</code> support additional spatial covariance structures.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 41%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Covariance structures</th>
<th style="text-align: center;"><code>mmrm</code></th>
<th style="text-align: center;"><code>PROC GLIMMIX</code></th>
<th style="text-align: center;"><code>gls</code></th>
<th style="text-align: center;"><code>lmer</code></th>
<th style="text-align: center;"><code>glmmTMB</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Ante-dependence (heterogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Ante-dependence (homogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Auto-regressive (heterogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Auto-regressive (homogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Compound symmetry (heterogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td style="text-align: center;">Compound symmetry (homogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Spatial exponential</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td style="text-align: center;">Toeplitz (heterogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Toeplitz (homogeneous)</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Unstructured</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
</tbody>
</table>
<p>Code for fitting MMRMs to the FEV data using each of the considered functions and covariance structures are provided below. Fixed effects for the visit number, treatment assignment and the interaction between the two are modeled.</p>
<section id="ante-dependence-heterogeneous" class="level2">
<h2 class="anchored" data-anchor-id="ante-dependence-heterogeneous">Ante-dependence (heterogeneous)</h2>
<section id="proc-glimmix" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=ANTE(1)</b>;
</code></pre>
</section>
<section id="mmrm" class="level3">
<h3 class="anchored" data-anchor-id="mmrm"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>adh(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="ante-dependence-homogeneous" class="level2">
<h2 class="anchored" data-anchor-id="ante-dependence-homogeneous">Ante-dependence (homogeneous)</h2>
<section id="mmrm-1" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-1"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula =FEV1 ~ ARMCD * AVISIT + <b>ad(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="auto-regressive-heterogeneous" class="level2">
<h2 class="anchored" data-anchor-id="auto-regressive-heterogeneous">Auto-regressive (heterogeneous)</h2>
<section id="proc-glimmix-1" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-1"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=ARH(1)</b>;
</code></pre>
</section>
<section id="mmrm-2" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-2"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>ar1h(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="gls" class="level3">
<h3 class="anchored" data-anchor-id="gls"><code>gls</code></h3>
<pre><code>gls(
  formula = FEV1 ~ ARMCD * AVISIT,
  data = fev_data,
  correlation = <b>corCAR1(form = ~AVISIT | USUBJID)</b>,
  weights = <b>varIdent(form = ~1|AVISIT)</b>,
  na.action = na.omit
)
</code></pre>
</section>
</section>
<section id="auto-regressive-homogeneous" class="level2">
<h2 class="anchored" data-anchor-id="auto-regressive-homogeneous">Auto-regressive (homogeneous)</h2>
<section id="proc-glimmix-2" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-2"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 =  ARMCD|AVISIT / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=AR(1)</b>;
</code></pre>
</section>
<section id="mmrm-3" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-3"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>ar1(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="gls-1" class="level3">
<h3 class="anchored" data-anchor-id="gls-1"><code>gls</code></h3>
<pre><code>gls(
  formula = FEV1 ~ ARMCD * AVISIT,
  data = fev_data,
  correlation = <b>corCAR1(form = ~AVISIT | USUBJID)</b>,
  na.action = na.omit
)
</code></pre>
</section>
<section id="glmmtmb" class="level3">
<h3 class="anchored" data-anchor-id="glmmtmb"><code>glmmTMB</code></h3>
<pre><code>glmmTMB(
  FEV1 ~ ARMCD * AVISIT + <b>ar1(0 + AVISIT | USUBJID)</b>,
  <b>dispformula = ~ 0</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="compound-symmetry-heterogeneous" class="level2">
<h2 class="anchored" data-anchor-id="compound-symmetry-heterogeneous">Compound symmetry (heterogeneous)</h2>
<section id="proc-glimmix-3" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-3"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=CSH</b>;
</code></pre>
</section>
<section id="mmrm-4" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-4"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>csh(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="gls-2" class="level3">
<h3 class="anchored" data-anchor-id="gls-2"><code>gls</code></h3>
<pre><code>gls(
  formula = FEV1 ~ ARMCD * AVISIT,
  data = fev_data,
  correlation = <b>corCompSymm(form = ~AVISIT | USUBJID)</b>,
  weights = <b>varIdent(form = ~1|AVISIT)</b>,
  na.action = na.omit
)
</code></pre>
</section>
<section id="glmmtmb-1" class="level3">
<h3 class="anchored" data-anchor-id="glmmtmb-1"><code>glmmTMB</code></h3>
<pre><code>glmmTMB(
  FEV1 ~ ARMCD * AVISIT + <b>cs(0 + AVISIT | USUBJID)</b>,
  <b>dispformula = ~ 0</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="compound-symmetry-homogeneous" class="level2">
<h2 class="anchored" data-anchor-id="compound-symmetry-homogeneous">Compound symmetry (homogeneous)</h2>
<section id="proc-glimmix-4" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-4"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=CS</b>;
</code></pre>
</section>
<section id="mmrm-5" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-5"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>cs(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="gls-3" class="level3">
<h3 class="anchored" data-anchor-id="gls-3"><code>gls</code></h3>
<pre><code>gls(
  formula = FEV1 ~ ARMCD * AVISIT,
  data = fev_data,
  correlation = <b>corCompSymm(form = ~AVISIT | USUBJID)</b>,
  na.action = na.omit
)
</code></pre>
</section>
</section>
<section id="spatial-exponential" class="level2">
<h2 class="anchored" data-anchor-id="spatial-exponential">Spatial exponential</h2>
<section id="proc-glimmix-5" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-5"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM / subject=USUBJID type=sp(exp)(visitn)</b> rcorr;
</code></pre>
</section>
<section id="mmrm-6" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-6"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>sp_exp(VISITN | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="gls-4" class="level3">
<h3 class="anchored" data-anchor-id="gls-4"><code>gls</code></h3>
<pre><code>gls(
  formula = FEV1 ~ ARMCD * AVISIT,
  data = fev_data,
  correlation = <b>corExp(form = ~AVISIT | USUBJID)</b>,
  weights = varIdent(form = ~1|AVISIT),
  na.action = na.omit
)
</code></pre>
</section>
<section id="glmmtmb-2" class="level3">
<h3 class="anchored" data-anchor-id="glmmtmb-2"><code>glmmTMB</code></h3>
<pre><code># NOTE: requires use of coordinates
glmmTMB(
  FEV1 ~ ARMCD * AVISIT + <b>exp(0 + AVISIT | USUBJID)</b>,
  <b>dispformula = ~ 0</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="toeplitz-heterogeneous" class="level2">
<h2 class="anchored" data-anchor-id="toeplitz-heterogeneous">Toeplitz (heterogeneous)</h2>
<section id="proc-glimmix-6" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-6"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID type=TOEPH</b>;
</code></pre>
</section>
<section id="mmrm-7" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-7"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>toeph(AVISIT | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="glmmtmb-3" class="level3">
<h3 class="anchored" data-anchor-id="glmmtmb-3"><code>glmmTMB</code></h3>
<pre><code> glmmTMB(
  FEV1 ~ ARMCD * AVISIT + <b>toep(0 + AVISIT | USUBJID)</b>,
  <b>dispformula = ~ 0</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="toeplitz-homogeneous" class="level2">
<h2 class="anchored" data-anchor-id="toeplitz-homogeneous">Toeplitz (homogeneous)</h2>
<section id="proc-glimmix-7" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-7"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = AVISIT|ARMCD / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID</b> <b>type=TOEP</b>;
</code></pre>
</section>
<section id="mmrm-8" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-8"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>toep(AVISIT | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
<section id="unstructured" class="level2">
<h2 class="anchored" data-anchor-id="unstructured">Unstructured</h2>
<section id="proc-glimmix-8" class="level3">
<h3 class="anchored" data-anchor-id="proc-glimmix-8"><code>PROC GLIMMIX</code></h3>
<pre><code>PROC GLIMMIX DATA = fev_data;
CLASS AVISIT(ref = 'VIS1') ARMCD(ref = 'PBO') USUBJID;
MODEL FEV1 = ARMCD|AVISIT / ddfm=satterthwaite solution chisq;
<b>RANDOM AVISIT / subject=USUBJID</b> <b>type=un</b>;
</code></pre>
</section>
<section id="mmrm-9" class="level3">
<h3 class="anchored" data-anchor-id="mmrm-9"><code>mmrm</code></h3>
<pre><code>mmrm(
  formula = FEV1 ~ ARMCD * AVISIT + <b>us(AVISIT | USUBJID)</b>,
  data = fev_data
)
</code></pre>
</section>
<section id="gls-5" class="level3">
<h3 class="anchored" data-anchor-id="gls-5"><code>gls</code></h3>
<pre><code>gls(
  formula = FEV1 ~  ARMCD * AVISIT,
  data = fev_data,
  correlation = <b>corSymm(form = ~AVISIT | USUBJID)</b>,
  weights = varIdent(form = ~1|AVISIT),
  na.action = na.omit
)
</code></pre>
</section>
<section id="lmer" class="level3">
<h3 class="anchored" data-anchor-id="lmer"><code>lmer</code></h3>
<pre><code>lmer(
  FEV1 ~ ARMCD * AVISIT + <b>(0 + AVISIT | USUBJID)</b>,
  data = fev_data,
  control = lmerControl(check.nobs.vs.nRE = "ignore"),
  na.action = na.omit
)
</code></pre>
</section>
<section id="glmmtmb-4" class="level3">
<h3 class="anchored" data-anchor-id="glmmtmb-4"><code>glmmTMB</code></h3>
<pre><code>glmmTMB(
  FEV1 ~ ARMCD * AVISIT + <b>us(0 + AVISIT | USUBJID)</b>,
  <b>dispformula = ~ 0</b>,
  data = fev_data
)
</code></pre>
</section>
</section>
</section>
<section id="benchmarking" class="level1">
<h1>Benchmarking</h1>
<p>Next, the MMRM fitting procedures are compared using the FEV and BCVA datasets. FEV1 measurements are modeled as a function of race, treatment arm, visit number, and the interaction between the treatment arm and the visit number. Change in BCVA is assumed to be a function of race, baseline BCVA, treatment arm, visit number, and the treatment–visit interaction. In both datasets, repeated measures are modeled using an unstructured covariance matrix. The implementations’ convergence times are evaluated first, followed by a comparison of their estimates. Finally, we fit these procedures on simulated BCVA-like data to assess the impact of missingness on convergence rates.</p>
<section id="convergence-times" class="level2">
<h2 class="anchored" data-anchor-id="convergence-times">Convergence Times</h2>
<section id="fev-data-1" class="level3">
<h3 class="anchored" data-anchor-id="fev-data-1">FEV Data</h3>
<p>The <code>mmrm</code>, <code>PROC GLIMMIX</code>, <code>gls</code>, <code>lmer</code>, and <code>glmmTMB</code> functions are applied to the FEV dataset 10 times. The convergence times are recorded for each replicate and are reported in the table below.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparison of convergence times: milliseconds</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Implementation</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">First Quartile</th>
<th style="text-align: right;">Third Quartile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mmrm</td>
<td style="text-align: right;">56.15</td>
<td style="text-align: right;">55.76</td>
<td style="text-align: right;">56.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">PROC GLIMMIX</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">100.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lmer</td>
<td style="text-align: right;">247.02</td>
<td style="text-align: right;">245.25</td>
<td style="text-align: right;">257.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">gls</td>
<td style="text-align: right;">687.63</td>
<td style="text-align: right;">683.50</td>
<td style="text-align: right;">692.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">glmmTMB</td>
<td style="text-align: right;">715.90</td>
<td style="text-align: right;">708.70</td>
<td style="text-align: right;">721.57</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>It is clear from these results that <code>mmrm</code> converges significantly faster than other R functions. Though not demonstrated here, this is generally true regardless of the sample size and covariance structure used. <code>mmrm</code> is faster than <code>PROC GLIMMIX</code>.</p>
</section>
<section id="bcva-data-1" class="level3">
<h3 class="anchored" data-anchor-id="bcva-data-1">BCVA Data</h3>
<p>The MMRM implementations are now applied to the BCVA dataset 10 times. The convergence times are presented below.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparison of convergence times: seconds</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Implementation</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">First Quartile</th>
<th style="text-align: right;">Third Quartile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mmrm</td>
<td style="text-align: right;">3.36</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">3.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">glmmTMB</td>
<td style="text-align: right;">18.65</td>
<td style="text-align: right;">18.14</td>
<td style="text-align: right;">18.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PROC GLIMMIX</td>
<td style="text-align: right;">36.25</td>
<td style="text-align: right;">36.17</td>
<td style="text-align: right;">36.29</td>
</tr>
<tr class="even">
<td style="text-align: left;">gls</td>
<td style="text-align: right;">164.36</td>
<td style="text-align: right;">158.61</td>
<td style="text-align: right;">165.93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lmer</td>
<td style="text-align: right;">165.26</td>
<td style="text-align: right;">157.46</td>
<td style="text-align: right;">166.42</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We again find that <code>mmrm</code> produces the fastest convergence times on average.</p>
</section>
</section>
<section id="marginal-treatment-effect-estimates-comparison" class="level2">
<h2 class="anchored" data-anchor-id="marginal-treatment-effect-estimates-comparison">Marginal Treatment Effect Estimates Comparison</h2>
<p>We next estimate the marginal mean treatment effects for each visit in the FEV and BCVA datasets using the MMRM fitting procedures. All R implementations’ estimates are reported relative to <code>PROC GLIMMIX</code>’s estimates. Convergence status is also reported.</p>
<section id="fev-data-2" class="level3">
<h3 class="anchored" data-anchor-id="fev-data-2">FEV Data</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../images/mmrm/review-treatment-fev-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The R procedures’ estimates are very similar to those output by <code>PROC GLIMMIX</code>, though <code>mmrm</code> and <code>gls</code> generate the estimates that are closest to those produced when using SAS. All methods converge using their default optimization arguments.</p>
</section>
<section id="bcva-data-2" class="level3">
<h3 class="anchored" data-anchor-id="bcva-data-2">BCVA Data</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../images/mmrm/review-treatment-bcva-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../images/mmrm/review-treatment-bcva-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><code>mmrm</code>, <code>gls</code> and <code>lmer</code> produce estimates that are virtually identical to <code>PROC GLIMMIX</code>’s, while <code>glmmTMB</code> does not. This is likely explained by <code>glmmTMB</code>’s failure to converge. Note too that <code>lmer</code> fails to converge.</p>
</section>
</section>
<section id="impact-of-missing-data-on-convergence-rates" class="level2">
<h2 class="anchored" data-anchor-id="impact-of-missing-data-on-convergence-rates">Impact of Missing Data on Convergence Rates</h2>
<p>The results of the previous benchmark suggest that the amount of patients missing from later time points affect certain implementations’ capacity to converge. We investigate this further by simulating data using a data-generating process similar to that of the BCVA datasets, though with various rates of patient dropout.</p>
<p>Ten datasets of 200 patients are generated each of the following levels of missingness: none, mild, moderate, and high. In all scenarios, observations are missing at random. The number patients observed at each visit is obtained for one replicated dataset at each level of missingness is presented in the table below.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Number of patients per visit</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">none</th>
<th style="text-align: right;">mild</th>
<th style="text-align: right;">moderate</th>
<th style="text-align: right;">high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">VIS01</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">196.7</td>
<td style="text-align: right;">197.6</td>
<td style="text-align: right;">188.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIS02</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">195.4</td>
<td style="text-align: right;">194.4</td>
<td style="text-align: right;">182.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VIS03</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">195.1</td>
<td style="text-align: right;">190.7</td>
<td style="text-align: right;">175.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIS04</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">194.1</td>
<td style="text-align: right;">188.4</td>
<td style="text-align: right;">162.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VIS05</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">191.6</td>
<td style="text-align: right;">182.5</td>
<td style="text-align: right;">142.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIS06</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">188.2</td>
<td style="text-align: right;">177.3</td>
<td style="text-align: right;">125.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VIS07</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">184.6</td>
<td style="text-align: right;">168.0</td>
<td style="text-align: right;">105.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIS08</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">178.5</td>
<td style="text-align: right;">155.4</td>
<td style="text-align: right;">82.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VIS09</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">175.3</td>
<td style="text-align: right;">139.9</td>
<td style="text-align: right;">58.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">VIS10</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">164.1</td>
<td style="text-align: right;">124.0</td>
<td style="text-align: right;">39.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The convergence rates of all implementations for stratified by missingness level is presented in the plot below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="../images/mmrm/review-convergence-rate-missingness-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><code>mmrm</code>, <code>gls</code>, and <code>PROC GLIMMIX</code> are resilient to missingness, only exhibiting some convergence problems in the scenarios with the most missingness. These implementations converged in all the other scenarios’ replicates. <code>glmmTMB</code>, on the other hand, has convergence issues in the no-, mild-, and high-missingness datasets, with the worst convergence rate occurring in the datasets with the most dropout. Finally, <code>lmer</code> is unreliable in all scenarios, suggesting that it’s convergence issues stem from something other than the missing observations.</p>
<p>Note that the default optimization schemes are used for each method; these schemes can be modified to potentially improve convergence rates.</p>
<p>A more comprehensive simulation study using data-generating processes similar to the one used here is outlined in the <a href="https://github.com/openpharma/mmrm/tree/main/simulations/missing-data-benchmarks"><code>simulations/missing-data-benchmarks</code></a> subdirectory. In addition to assessing the effect of missing data on software convergence rates, we also evaluate these methods’ fit times and empirical bias, variance, 95% coverage rates, type I error rates and type II error rates. <code>mmrm</code> is found to be the most most robust software for fitting MMRMs in scenarios where a large proportion of patients are missing from the last time points. Additionally, <code>mmrm</code> has the fastest average fit times regardless of the amount of missingness. All implementations considered produce similar empirical biases, variances, 95% coverage rates, type I error rates and type II error rates.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>