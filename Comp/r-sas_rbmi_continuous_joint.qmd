---
title: "R vs SAS Reference-Based Multiple Imputation (joint modelling): Continuous Data"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Reference-Based Multiple Imputation Comparison

The following table shows the types of reference-based multiple imputation (rbmi), the capabilities of each language, and whether or not the results from each language match. The following holds for data that are assumed to be normally distributed. In this comparison, we used the [rbmi](https://cran.r-project.org/web/packages/rbmi/index.html) package in R and the so-called [5 macros](https://www.lshtm.ac.uk/research/centres-projects-groups/missing-data#dia-missing-data) in SAS.

The following assumptions are made in both languages:

* Equal unstructured covariance matrix across treatment groups

* Same covariates formula for the imputation and analysis model

* Similar number of MCMC tuning parameters (burn-in, thinning) was used in the MCMC

* The one intermittent missingness was imputed under MAR assumptions for imputation strategies

| Analysis | Supported in R | Supported in SAS | Results Match | Notes |
|----------|----------------|------------------|---------------|-------|
| rbmi - MI MAR | [Yes](../R/rbmi_continuous_joint.html) | [Yes](../SAS/rbmi_continuous_joint_SAS.html) | Yes | Results will be (slightly) different given the randomness in multiple imputations |
| rbmi - MI MNAR Copy Reference | [Yes](../R/rbmi_continuous_joint.html) | [Yes](../SAS/rbmi_continuous_joint_SAS.html) | Yes | Results will be (slightly) different given the randomness in multiple imputations |
| rbmi - MI MNAR Jump to Reference | [Yes](../R/rbmi_continuous_joint.html) | [Yes](../SAS/rbmi_continuous_joint_SAS.html) | Yes | Results will be (slightly) different given the randomness in multiple imputations |
| rbmi - MI MNAR Copy Increments in Reference | [Yes](../R/rbmi_continuous_joint.html) | [Yes](../SAS/rbmi_continuous_joint_SAS.html) | Yes | Results will be (slightly) different given the randomness in multiple imputations |


## Comparison Results

The following figure compares the contrast estimate (and associated 95% confidence interval) for the explored dataset per number of multiple imputations *B* (ie, 500, 2000 and 5000). Note that the complete case analysis is presented across *B* for completeness. For the contrast estimate the range of the difference between R and SAS results are [-0.67 to 1.78]%, [-0.72 to 0.11]% and [0.29 to 0.80]% for respectively B=500, 2000, 5000.

```{r, echo=FALSE, fig.align='center', out.width="100%"}
knitr::include_graphics("../images/rbmi/COMP_fig1.PNG")
```
CC=Complete Case; MAR=Missing at Random; MNAR=Missing not at Random, CIR=Copy Increments in Reference; CR=Copy Reference; JR=Jump to Reference

# Summary and Recommendation

xxx

The computational time for B=500 was similar between the `rbmi` package and the `5 macros` with 26 and 23 seconds. However, for B=2000 the `5 macros` (44 seconds) was approximately double as fast than the `rbmi` package (92 seconds).

Do you came across an reference-based multiple imputation analysis using `rbmi` package which you were not able to perform using the `5 macros` in SAS, ir vice versa? Please reach out CAMIS, and/or raise issue at the [CAMIS Github](https://github.com/PSIAIMS/CAMIS/issues).

# References

xxx
