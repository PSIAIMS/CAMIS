{
  "hash": "b4897c935b6e3778bb51e73fb37b4bf3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Survey Summary Statistics using Python\"\nbibliography: ../Comp/survey-stats-summary.bib\n---\n\n\n\nWhen conducting large-scale trials on samples of the population, it can be necessary to use a more complex sampling design than a simple random sample.\n\n-   **Weighting** – If smaller populations are sampled more heavily to increase precision, then it is necessary to weight these observations in the analysis.\n\n-   **Finite population correction** – Larger samples of populations result in lower variability in comparison to smaller samples.\n\n-   **Stratification** – Dividing a population into sub-groups and sampling from each group. This protects from obtaining a very poor sample (e.g. under or over-represented groups), can give samples of a known precision, and gives more precise estimates for population means and totals.\n\n-   **Clustering** – Dividing a population into sub-groups, and only sampling certain groups. This gives a lower precision, however can be much more convenient and cheaper - for example if surveying school children you may only sample a subset of schools to avoid travelling to a school to interview a single child.\n\nAll of these designs need to be taken into account when calculating statistics, and when producing models. Only summary statistics are discussed in this document, and variances are calculated using Taylor series linearisation methods. For a more detailed introduction to calculating survey statistics using statistical software, see [@Lohr_2022].\n\nThe ecosystem of survey statistics packages is less mature in Python than in R or SAS, however there is a package that provides a subset of the functionality: [`samplics`](https://samplics-org.github.io/samplics/).\n\n# Complex Survey Designs\n\nFor R and SAS, we give examples of summary statistics on a simple survey design which just had a finite population correction. Unfortunately, `samplics` does not have the ability to just use an fpc with no PSU or Strata, so we will instead demonstrate just with a more complete (and realistic) survey design, using the NHANES [@NHANES_2010] dataset:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wtswhukcjm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wtswhukcjm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wtswhukcjm thead, #wtswhukcjm tbody, #wtswhukcjm tfoot, #wtswhukcjm tr, #wtswhukcjm td, #wtswhukcjm th {\n  border-style: none;\n}\n\n#wtswhukcjm p {\n  margin: 0;\n  padding: 0;\n}\n\n#wtswhukcjm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wtswhukcjm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wtswhukcjm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wtswhukcjm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wtswhukcjm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wtswhukcjm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wtswhukcjm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wtswhukcjm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wtswhukcjm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wtswhukcjm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wtswhukcjm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wtswhukcjm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wtswhukcjm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wtswhukcjm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wtswhukcjm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wtswhukcjm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wtswhukcjm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wtswhukcjm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wtswhukcjm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wtswhukcjm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wtswhukcjm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wtswhukcjm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wtswhukcjm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wtswhukcjm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wtswhukcjm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wtswhukcjm .gt_left {\n  text-align: left;\n}\n\n#wtswhukcjm .gt_center {\n  text-align: center;\n}\n\n#wtswhukcjm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wtswhukcjm .gt_font_normal {\n  font-weight: normal;\n}\n\n#wtswhukcjm .gt_font_bold {\n  font-weight: bold;\n}\n\n#wtswhukcjm .gt_font_italic {\n  font-style: italic;\n}\n\n#wtswhukcjm .gt_super {\n  font-size: 65%;\n}\n\n#wtswhukcjm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wtswhukcjm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wtswhukcjm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wtswhukcjm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wtswhukcjm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wtswhukcjm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wtswhukcjm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wtswhukcjm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wtswhukcjm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SDMVPSU\">SDMVPSU</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SDMVSTRA\">SDMVSTRA</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"WTMEC2YR\">WTMEC2YR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"HI_CHOL\">HI_CHOL</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"race\">race</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"agecat\">agecat</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"RIAGENDR\">RIAGENDR</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"SDMVPSU\" class=\"gt_row gt_right\">1</td>\n<td headers=\"SDMVSTRA\" class=\"gt_row gt_right\">83</td>\n<td headers=\"WTMEC2YR\" class=\"gt_row gt_right\">81528.77</td>\n<td headers=\"HI_CHOL\" class=\"gt_row gt_right\">0</td>\n<td headers=\"race\" class=\"gt_row gt_right\">2</td>\n<td headers=\"agecat\" class=\"gt_row gt_center\">(19,39]</td>\n<td headers=\"RIAGENDR\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SDMVPSU\" class=\"gt_row gt_right\">1</td>\n<td headers=\"SDMVSTRA\" class=\"gt_row gt_right\">84</td>\n<td headers=\"WTMEC2YR\" class=\"gt_row gt_right\">14509.28</td>\n<td headers=\"HI_CHOL\" class=\"gt_row gt_right\">0</td>\n<td headers=\"race\" class=\"gt_row gt_right\">3</td>\n<td headers=\"agecat\" class=\"gt_row gt_center\">(0,19]</td>\n<td headers=\"RIAGENDR\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SDMVPSU\" class=\"gt_row gt_right\">2</td>\n<td headers=\"SDMVSTRA\" class=\"gt_row gt_right\">86</td>\n<td headers=\"WTMEC2YR\" class=\"gt_row gt_right\">12041.64</td>\n<td headers=\"HI_CHOL\" class=\"gt_row gt_right\">0</td>\n<td headers=\"race\" class=\"gt_row gt_right\">3</td>\n<td headers=\"agecat\" class=\"gt_row gt_center\">(0,19]</td>\n<td headers=\"RIAGENDR\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SDMVPSU\" class=\"gt_row gt_right\">2</td>\n<td headers=\"SDMVSTRA\" class=\"gt_row gt_right\">75</td>\n<td headers=\"WTMEC2YR\" class=\"gt_row gt_right\">21000.34</td>\n<td headers=\"HI_CHOL\" class=\"gt_row gt_right\">0</td>\n<td headers=\"race\" class=\"gt_row gt_right\">3</td>\n<td headers=\"agecat\" class=\"gt_row gt_center\">(59,Inf]</td>\n<td headers=\"RIAGENDR\" class=\"gt_row gt_right\">2</td></tr>\n    <tr><td headers=\"SDMVPSU\" class=\"gt_row gt_right\">1</td>\n<td headers=\"SDMVSTRA\" class=\"gt_row gt_right\">88</td>\n<td headers=\"WTMEC2YR\" class=\"gt_row gt_right\">22633.58</td>\n<td headers=\"HI_CHOL\" class=\"gt_row gt_right\">0</td>\n<td headers=\"race\" class=\"gt_row gt_right\">1</td>\n<td headers=\"agecat\" class=\"gt_row gt_center\">(19,39]</td>\n<td headers=\"RIAGENDR\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><td headers=\"SDMVPSU\" class=\"gt_row gt_right\">2</td>\n<td headers=\"SDMVSTRA\" class=\"gt_row gt_right\">85</td>\n<td headers=\"WTMEC2YR\" class=\"gt_row gt_right\">74112.49</td>\n<td headers=\"HI_CHOL\" class=\"gt_row gt_right\">1</td>\n<td headers=\"race\" class=\"gt_row gt_right\">2</td>\n<td headers=\"agecat\" class=\"gt_row gt_center\">(39,59]</td>\n<td headers=\"RIAGENDR\" class=\"gt_row gt_right\">2</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n# Summary Statistics\n\n## Mean\n\nIf we want to calculate a mean of a variable in a dataset using `samplics`, we need to create an estimator object using the estimation method we will use - here Taylor Series estimation - and the parameter we are estimating. Then, we can specify the survey design by passing columns which define our strata and PSUs, and a column to estimate:\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\n\nfrom samplics import TaylorEstimator\nfrom samplics.utils.types import PopParam\n\nnhanes = pd.read_csv(\"../data/nhanes.csv\")\n\nmean_estimator = TaylorEstimator(PopParam.mean)\n\nmean_estimator.estimate(\n    y=nhanes[\"HI_CHOL\"],\n    samp_weight=nhanes[\"WTMEC2YR\"],\n    psu=nhanes[\"SDMVPSU\"],\n    stratum=nhanes[\"SDMVSTRA\"],\n    remove_nan=True,\n)\nprint(mean_estimator.to_dataframe())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          _param  _estimate  _stderror      _lci      _uci       _cv\n0  PopParam.mean   0.112143   0.005446  0.100598  0.123688  0.048562\n```\n\n\n:::\n:::\n\n\n\n## Total\n\nCalculating population totals can be done by changing the `TaylorEstimator` parameter to `PopParam.total`:\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\ntotal_estimator = TaylorEstimator(PopParam.total)\n\ntotal_estimator.estimate(\n    y=nhanes[\"HI_CHOL\"],\n    samp_weight=nhanes[\"WTMEC2YR\"],\n    psu=nhanes[\"SDMVPSU\"],\n    stratum=nhanes[\"SDMVSTRA\"],\n    remove_nan=True,\n)\nprint(total_estimator.to_dataframe())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           _param     _estimate  ...          _uci       _cv\n0  PopParam.total  2.863525e+07  ...  3.291896e+07  0.070567\n\n[1 rows x 6 columns]\n```\n\n\n:::\n:::\n\n\n\n## Ratios\n\nCalculating population ratios can be done by changing the `TaylorEstimator` parameter to `PopParam.ratio`, and additionally specifying an `x` parameter in the `estimate` method:\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nratio_estimator = TaylorEstimator(PopParam.ratio)\n\nratio_estimator.estimate(\n    y=nhanes[\"HI_CHOL\"],\n    x=nhanes[\"RIAGENDR\"],\n    samp_weight=nhanes[\"WTMEC2YR\"],\n    psu=nhanes[\"SDMVPSU\"],\n    stratum=nhanes[\"SDMVSTRA\"],\n    remove_nan=True,\n)\nprint(ratio_estimator.to_dataframe())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           _param  _estimate  _stderror      _lci      _uci       _cv\n0  PopParam.ratio   0.074222   0.003715  0.066347  0.082097  0.050049\n```\n\n\n:::\n:::\n\n\n\n## Proportions\n\nCalculating proportions can be done by changing the `TaylorEstimator` parameter to `PopParam.prop`:\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nprop_estimator = TaylorEstimator(PopParam.prop)\n\nprop_estimator.estimate(\n    y=nhanes[\"agecat\"],\n    samp_weight=nhanes[\"WTMEC2YR\"],\n    psu=nhanes[\"SDMVPSU\"],\n    stratum=nhanes[\"SDMVSTRA\"],\n    remove_nan=True,\n)\nprop_estimator.to_dataframe()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          _param    _level  _estimate  _stderror      _lci      _uci       _cv\n0  PopParam.prop    (0,19]   0.207749   0.006130  0.195054  0.221044  0.029506\n1  PopParam.prop   (19,39]   0.293408   0.009561  0.273557  0.314077  0.032585\n2  PopParam.prop   (39,59]   0.303290   0.004519  0.293795  0.312955  0.014901\n3  PopParam.prop  (59,Inf]   0.195553   0.008093  0.178965  0.213280  0.041383\n```\n\n\n:::\n:::\n\n\n\n## Quantiles\n\n`samplics` currently does not have a method to calculate quantiles.\n\n## Domain Estimations\n\nWe can perform domain estimations of different sub-populations by passing our domain column as a parameter to the `estimate` method:\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nmean_estimator = TaylorEstimator(PopParam.mean)\n\nmean_estimator.estimate(\n    y=nhanes[\"HI_CHOL\"],\n    samp_weight=nhanes[\"WTMEC2YR\"],\n    psu=nhanes[\"SDMVPSU\"],\n    stratum=nhanes[\"SDMVSTRA\"],\n    domain=nhanes[\"race\"],\n    remove_nan=True,\n)\nmean_estimator.to_dataframe()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          _param  _domain  _estimate  _stderror      _lci      _uci       _cv\n0  PopParam.mean        1   0.101492   0.006246  0.088251  0.114732  0.061540\n1  PopParam.mean        2   0.121649   0.006604  0.107649  0.135649  0.054288\n2  PopParam.mean        3   0.078640   0.010385  0.056626  0.100655  0.132053\n3  PopParam.mean        4   0.099679   0.024666  0.047389  0.151969  0.247458\n```\n\n\n:::\n:::\n\n\n\n::: {.callout-note collapse=\"true\" title=\"Session Info\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.4.3 (2025-02-28)\n os       Ubuntu 24.04.2 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       Europe/London\n date     2025-03-13\n pandoc   NA (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n ! package * version date (UTC) lib source\n P survey  * 4.4-2   2024-03-20 [?] RSPM (R 4.4.0)\n\n [1] /home/michael/source/CAMIS/renv/library/linux-ubuntu-noble/R-4.4/x86_64-pc-linux-gnu\n [2] /opt/R/4.4.3/lib/R/library\n\n P ── Loaded and on-disk path mismatch.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Python configuration ────────────────────────────────────────────────────────\n Python    3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]\n samplics  0.4.22\n```\n\n\n:::\n:::\n\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}