{
  "hash": "7617d2aae333897b0a2a92d132973902",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Linear Regression\"\noutput: html_document\n---\n\n\nTo demonstrate the use of linear regression we examine a dataset that illustrates the relationship between Height and Weight in a group of 237 teen-aged boys and girls. The dataset is available [here](https://github.com/PSIAIMS/CAMIS/blob/3dca6398dca4f242eb0f0c316d7499eaba8adb13/data/htwt.csv) and is imported to the workspace.\n\n### Descriptive Statistics\n\nThe first step is to obtain the simple descriptive statistics for the numeric variables of htwt data, and one-way frequencies for categorical variables. This is accomplished by employing summary function. There are 237 participants who are from 13.9 to 25 years old. It is a cross-sectional study, with each participant having one observation. We can use this data set to examine the relationship of participants' height to their age and sex.\n\n::: {#d6aadc80 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport statsmodels.api as sm\n\n# Importing CSV\nhtwt = pd.read_csv(\"../data/htwt.csv\")\n```\n:::\n\n\nIn order to create a regression model to demonstrate the relationship between age and height for females, we first need to create a flag variable identifying females and an interaction variable between age and female gender flag.\n\n::: {#745cd356 .cell execution_count=2}\n``` {.python .cell-code}\nhtwt['female'] = (htwt['SEX'] == 'f').astype(int)\nhtwt['fem_age'] = htwt['AGE'] * htwt['female']\nhtwt.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>ROW</th>\n      <th>SEX</th>\n      <th>AGE</th>\n      <th>HEIGHT</th>\n      <th>WEIGHT</th>\n      <th>female</th>\n      <th>fem_age</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>f</td>\n      <td>14.3</td>\n      <td>56.3</td>\n      <td>85.0</td>\n      <td>1</td>\n      <td>14.3</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>f</td>\n      <td>15.5</td>\n      <td>62.3</td>\n      <td>105.0</td>\n      <td>1</td>\n      <td>15.5</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>f</td>\n      <td>15.3</td>\n      <td>63.3</td>\n      <td>108.0</td>\n      <td>1</td>\n      <td>15.3</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>f</td>\n      <td>16.1</td>\n      <td>59.0</td>\n      <td>92.0</td>\n      <td>1</td>\n      <td>16.1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>f</td>\n      <td>19.1</td>\n      <td>62.5</td>\n      <td>112.5</td>\n      <td>1</td>\n      <td>19.1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Regression Analysis\n\nNext, we fit a regression model, representing the relationships between gender, age, height and the interaction variable created in the datastep above. We again use a where statement to restrict the analysis to those who are less than or equal to 19 years old. We use the clb option to get a 95% confidence interval for each of the parameters in the model. The model that we are fitting is ***height = b0 + b1 x female + b2 x age + b3 x fem_age + e***\n\n::: {#7030b50e .cell execution_count=3}\n``` {.python .cell-code}\nX = htwt[['female', 'AGE', 'fem_age']][htwt['AGE'] <= 19]\nX = sm.add_constant(X)\nY = htwt['HEIGHT'][htwt['AGE'] <= 19]\n\nmodel = sm.OLS(Y, X).fit()\n\nmodel.summary()\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<table class=\"simpletable\">\n<caption>OLS Regression Results</caption>\n<tr>\n  <th>Dep. Variable:</th>         <td>HEIGHT</td>      <th>  R-squared:         </th> <td>   0.460</td>\n</tr>\n<tr>\n  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.452</td>\n</tr>\n<tr>\n  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   60.93</td>\n</tr>\n<tr>\n  <th>Date:</th>             <td>Wed, 20 Aug 2025</td> <th>  Prob (F-statistic):</th> <td>1.50e-28</td>\n</tr>\n<tr>\n  <th>Time:</th>                 <td>14:01:28</td>     <th>  Log-Likelihood:    </th> <td> -534.17</td>\n</tr>\n<tr>\n  <th>No. Observations:</th>      <td>   219</td>      <th>  AIC:               </th> <td>   1076.</td>\n</tr>\n<tr>\n  <th>Df Residuals:</th>          <td>   215</td>      <th>  BIC:               </th> <td>   1090.</td>\n</tr>\n<tr>\n  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   \n</tr>\n<tr>\n  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   \n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n     <td></td>        <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  \n</tr>\n<tr>\n  <th>const</th>   <td>   28.8828</td> <td>    2.873</td> <td>   10.052</td> <td> 0.000</td> <td>   23.219</td> <td>   34.547</td>\n</tr>\n<tr>\n  <th>female</th>  <td>   13.6123</td> <td>    4.019</td> <td>    3.387</td> <td> 0.001</td> <td>    5.690</td> <td>   21.534</td>\n</tr>\n<tr>\n  <th>AGE</th>     <td>    2.0313</td> <td>    0.178</td> <td>   11.435</td> <td> 0.000</td> <td>    1.681</td> <td>    2.381</td>\n</tr>\n<tr>\n  <th>fem_age</th> <td>   -0.9294</td> <td>    0.248</td> <td>   -3.750</td> <td> 0.000</td> <td>   -1.418</td> <td>   -0.441</td>\n</tr>\n</table>\n<table class=\"simpletable\">\n<tr>\n  <th>Omnibus:</th>       <td> 1.300</td> <th>  Durbin-Watson:     </th> <td>   2.284</td>\n</tr>\n<tr>\n  <th>Prob(Omnibus):</th> <td> 0.522</td> <th>  Jarque-Bera (JB):  </th> <td>   0.981</td>\n</tr>\n<tr>\n  <th>Skew:</th>          <td>-0.133</td> <th>  Prob(JB):          </th> <td>   0.612</td>\n</tr>\n<tr>\n  <th>Kurtosis:</th>      <td> 3.191</td> <th>  Cond. No.          </th> <td>    450.</td>\n</tr>\n</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.\n```\n:::\n:::\n\n\nFrom the coefficients table b0,b1,b2,b3 are estimated as b0=28.88 b1=13.61 b2=2.03 b3=-0.92942\n\nThe resulting regression model for height, age and gender based on the available data is ***height=28.8828 + 13.6123 x female + 2.0313 x age -0.9294 x fem_age***\n\n",
    "supporting": [
      "linear_regression_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}