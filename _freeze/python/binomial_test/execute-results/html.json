{
  "hash": "c842ce058c30139f4c5029deb81db12c",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Binomial Test\"\nformat: html\neditor: visual\n---\n\n\nThe statistical test used to determine whether the proportion in a binary outcome experiment is equal to a specific value. It is appropriate when we have a small sample size and want to test the success probability $p$ against a hypothesized value $p_0$.\n\n## Creating a sample dataset\n\n-   We will generate a dataset where we record the outcomes of 1000 coin flips.\n\n-   We will use the `binom.test` function to test if the proportion of heads is significantly different from 0.5.\n\n::: {#042d3c01 .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nfrom scipy.stats import binomtest\n\n# Set seed for reproducibility\nnp.random.seed(19)\ncoin_flips = np.random.choice(['H', 'T'], size=1000, replace=True, p=[0.5, 0.5])\n```\n:::\n\n\nNow, we will count the heads and tails and summarize the data.\n\n::: {#ca08761c .cell execution_count=2}\n``` {.python .cell-code}\n# Count heads and tails\nheads_count = np.sum(coin_flips == 'H')\ntails_count = np.sum(coin_flips == 'T')\ntotal_flips = len(coin_flips)\n\nheads_count, tails_count, total_flips\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n(np.int64(523), np.int64(477), 1000)\n```\n:::\n:::\n\n\n## Conducting Binomial Test\n\n::: {#148776f0 .cell execution_count=3}\n``` {.python .cell-code}\n# Perform the binomial test\nbinom_test_result = binomtest(heads_count, total_flips, p=0.5)\nbinom_test_result\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\nBinomTestResult(k=523, n=1000, alternative='two-sided', statistic=0.523, pvalue=0.15469370647995673)\n```\n:::\n:::\n\n\n### Results:\n\nThe output has a p-value `py binom_test_result` $> 0.05$ (chosen level of significance). Hence, we fail to reject the null hypothesis and conclude that the **coin is fair**.\n\n# Example of Clinical Trial Data\n\nWe load the `lung` dataset from `survival` package. We want to test if the proportion of patients with survival status 1 (dead) is significantly different from a hypothesized proportion (e.g. 50%)\n\nWe will calculate number of deaths and total number of patients.\n\n::: {#1ffd449e .cell execution_count=4}\n``` {.python .cell-code}\nimport pandas as pd\n\n# Load the lung cancer dataset from CSV file\nlung = pd.read_csv('../data/lung_cancer.csv')\n\n# Calculate the number of deaths and total number of patients\nnum_deaths = np.sum(lung['status'] == 1)\ntotal_pat = lung.shape[0]\n\nnum_deaths, total_pat\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n(np.int64(63), 228)\n```\n:::\n:::\n\n\n## Conduct the Binomial Test\n\nWe will conduct the Binomial test and hypothesize that the proportion of death should be 19%.\n\n::: {#3ab62f62 .cell execution_count=5}\n``` {.python .cell-code}\n# Perform the binomial test\nbinom_test_clinical = binomtest(num_deaths, total_pat, p=0.19)\nbinom_test_clinical\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nBinomTestResult(k=63, n=228, alternative='two-sided', statistic=0.27631578947368424, pvalue=0.0016828878642599632)\n```\n:::\n:::\n\n\n## Results:\n\nThe output has a p-value `py binom_test_clinical` $< 0.05$ (chosen level of significance). Hence, we reject the null hypothesis and conclude that **the propotion of death is significantly different from 19%**.\n\n",
    "supporting": [
      "binomial_test_files"
    ],
    "filters": [],
    "includes": {}
  }
}