{
  "hash": "b7c4adc5877763cf0b3c7538bf3512b2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Generalized Estimating Equations (GEE) methods\"\n---\n\n\n\n# Comparison of SAS vs R\n\n# BINARY OUTCOME\n\nFor dichotomous response variables, the link functions is the probit (in case of rare events complementary log-log may be preferable). For outcomes with more than two categories, the cumulative link function is used in case of ordinal variables and generalized logit for nominal variables.\n\nIn SAS, PROC GEE or PROC GENMOD can be used to compute GEE models. In R, GEE models can be fitted using `geepack::geeglm` or `gee::gee.`\n\nEstimated probabilities and odds ratios (OR) can be obtained in SAS by adding an `LSMEANS` statement, and in R by using an additional function with results from `geepack::geeglm`. For models fitted with `gee::gee`, the `emmeans` package is not supported.\n\nThe table below summarizes options and details for each procedure/function:\n\n| **Procedure/Function** | geepack::geeglm | **gee:gee** | PROC GEE/GENMOD |\n|------------------|------------------|-------------------|------------------|\n| Outcome variable | Numeric (0, 1) | Factor | Numeric or character in `class` statement |\n| Correlation matrix (default) | Independence | Independence | Independence |\n| Correlation matrix (options) | independence, exchangeable, ar1, unstructured and user defined. | independence, fixed, stat_M_dep, non_stat_M_dep, exchangeable, AR-M and unstructured. | independence, ar, exchangeable, mdep, unstructured and user defined. |\n| Outcome variable | Numeric (0, 1) | Factor | Numeric or factor, in `class` statement |\n| Sandwich SE | By default | By default | By default |\n| Model-based (naive) SE | No | By default | `modelse` option in `repeated` statement |\n| Link functions | probit, logit | probit, logit | probit, logit, clogit and glogit |\n| Estimated probability of event | additional function `emmeans::emmeans` | `emmeans::emmeans` not supported | `LSMEANS` statement with `ilink` option |\n| Odds Ratio (OR) | additional function `emmeans::emmeans` | `emmeans::emmeans` not supported | `LSMEANS` statement with `exp` or `oddsraio`option |\n\nA comparison between SAS (using PROC GEE) and the R functions using data available in [\"Gee Model for Binary Data\"](https://documentation.sas.com/doc/en/statug/15.2/statug_code_genmex5.htm), and similar results were found across software using similar options (See R and SAS sections).\n\nNote small differences may be found in later decimal places (\\>9 decimal position) in results obtained with PROC GENMOD and PROC GEE. Similarly, differences in later decimals may be found across R functions.\n\n# OUTCOME WITH MORE THAN TWO CATEGORIES\n\nModels with cumulative logit link functions apply to ordinal data and generalized logit models are fit to nominal data.\n\nIn SAS, similar syntax used for GEE models can be applied by specifying a multinomial distribution and selecting the appropriate link function. In R, the `multgee`package provides two functions for estimating GEE models when the outcome has more than two categories: `ordLORgee` for ordinal variables and `nomLORgee` for nominal variables.\n\n| **Procedure/Function** | multgee:ordLORgee | multgee:nomLORgee | PROC GEE/PROC GENMOD | PROC GEE/GENMOD |\n|---------------|---------------|---------------|---------------|---------------|\n| Correlation matrix (default) | Exchangeable | Independence | Independence |  |\n| Correlation matrix (options) | independence, uniform, exchangeable, time.exch, fixed | independence, exchangeable, RC or fixed | Independence^(1)^ |  |\n| Link function | clogit (implicit - not user configurable) | glogit (implicit - not user configurable) | glogit, glogit^(2)^ |  |\n| Model-based (naive) SE | No | By default | `modelse` option in `repeated` statement |  |\n\n(1) For multinomial responses, SAS limits the correlation matrix type to `independent,` so other correlation matrix options are not supported.\n\n(2) Generalized logit is available in PROC GEE, but not in PROC GENMOD.\n\nThe same data analyzed in the corresponding section for SAS and R are analyzed to compare results using equivalent settings, i.e.: specifying 'independence' correlation matrix in R to match SAS.\n\nSAS results were stored in a dataset and reformatted to align with R output in terms of order and decimal precision, making visual comparison easier.\n\n### Ordinal variable - Example\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproc genmod data=resp ;\nclass trtp(ref=\"P\") avisitn(ref='1') usubjid ;  \nmodel respord=trtp avisitn trtp*avisitn / dist=multinomial link=cumlogit ; \nrepeated subject=usubjid  /corr=ind;  \nlsmeans trtp*avisitn/cl exp ilink oddsratio diff;\nods output   GEEEmpPEst=GEEEmpPEst_ord ;\nrun;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/r_sas_1_ordinal_variable.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- multgee::ordLORgee(formula = respord ~  trtp + avisitn  + trtp*avisitn,\n                   data = resp,\n                   id = usubjid,\n                   repeated = avisitn,\n                   LORstr = \"independence\")\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGEE FOR ORDINAL MULTINOMIAL RESPONSES \nversion 1.6.0 modified 2017-07-10 \n\nLink : Cumulative logit \n\nLocal Odds Ratios:\nStructure:         independence\n\ncall:\nmultgee::ordLORgee(formula = respord ~ trtp + avisitn + trtp * \n    avisitn, data = resp, id = usubjid, repeated = avisitn, LORstr = \"independence\")\n\nSummary of residuals:\n      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. \n-0.4698929 -0.3568933 -0.2853896  0.0002563  0.6339985  0.7277428 \n\nNumber of Iterations: 1 \n\nCoefficients:\n               Estimate   san.se   san.z Pr(>|san.z|)  \nbeta10         -0.55049  0.24303 -2.2652      0.02350 *\nbeta20          0.62726  0.25615  2.4488      0.01433 *\ntrtpA           0.42992  0.34205  1.2569      0.20880  \navisitn2        0.00108  0.36663  0.0030      0.99765  \navisitn3        0.11733  0.32268  0.3636      0.71616  \navisitn4       -0.15048  0.33263 -0.4524      0.65099  \ntrtpA:avisitn2 -0.27197  0.50959 -0.5337      0.59355  \ntrtpA:avisitn3 -0.58563  0.46208 -1.2674      0.20503  \ntrtpA:avisitn4 -0.31782  0.44813 -0.7092      0.47819  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nLocal Odds Ratios Estimates:\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n[1,]    0    0    1    1    1    1    1    1\n[2,]    0    0    1    1    1    1    1    1\n[3,]    1    1    0    0    1    1    1    1\n[4,]    1    1    0    0    1    1    1    1\n[5,]    1    1    1    1    0    0    1    1\n[6,]    1    1    1    1    0    0    1    1\n[7,]    1    1    1    1    1    1    0    0\n[8,]    1    1    1    1    1    1    0    0\n\np-value of Null model: 0.68672 \n```\n\n\n:::\n:::\n\n\n\n### Nominal variable - Example\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproc gee data=resp ;\nclass trtp(ref=\"P\") avisitn(ref='1') usubjid respnom(ref='Lung');  \nmodel respnom=trtp avisitn trtp*avisitn/ dist=multinomial link=glogit ; \nrepeated subject=usubjid  /corr=ind /*modelse*/;  \nlsmeans trtp*avisitn/cl exp ilink oddsratio diff;\nods output   GEEEmpPEst=GEEEmpPEst_nom ;\nrun;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/r_sas_2_nominal_variable.png){fig-align='center' width=50%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- multgee::nomLORgee(formula = respnom ~  trtp + avisitn  + trtp*avisitn,\n                   data = resp,\n                   id = usubjid,\n                   repeated = avisitn,\n                   LORstr = \"independence\")\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGEE FOR NOMINAL MULTINOMIAL RESPONSES \nversion 1.6.0 modified 2017-07-10 \n\nLink : Baseline Category Logit \n\nLocal Odds Ratios:\nStructure:         independence\nHomogenous scores: TRUE\n\ncall:\nmultgee::nomLORgee(formula = respnom ~ trtp + avisitn + trtp * \n    avisitn, data = resp, id = usubjid, repeated = avisitn, LORstr = \"independence\")\n\nSummary of residuals:\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n-0.4444 -0.3684 -0.3333  0.0000  0.6111  0.7778 \n\nNumber of Iterations: 1 \n\nCoefficients:\n                 Estimate   san.se   san.z Pr(>|san.z|)\nbeta10            0.22314  0.33541  0.6653       0.5059\ntrtpA:1          -0.62861  0.50139 -1.2537       0.2099\navisitn2:1        0.18232  0.43095  0.4231       0.6722\navisitn3:1        0.01325  0.47862  0.0277       0.9779\navisitn4:1       -0.06899  0.48140 -0.1433       0.8860\ntrtpA:avisitn2:1  0.16252  0.63421  0.2563       0.7977\ntrtpA:avisitn3:1  0.95184  0.69786  1.3639       0.1726\ntrtpA:avisitn4:1  0.64631  0.70063  0.9225       0.3563\nbeta20            0.27193  0.33184  0.8195       0.4125\ntrtpA:2           0.01575  0.45535  0.0346       0.9724\navisitn2:2        0.18005  0.42536  0.4233       0.6721\navisitn3:2        0.15551  0.46598  0.3337       0.7386\navisitn4:2       -0.27193  0.50787 -0.5354       0.5924\ntrtpA:avisitn2:2 -0.25642  0.60253 -0.4256       0.6704\ntrtpA:avisitn3:2  0.11642  0.64694  0.1800       0.8572\ntrtpA:avisitn4:2  0.15610  0.63994  0.2439       0.8073\n\nLocal Odds Ratios Estimates:\n     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n[1,]    0    0    1    1    1    1    1    1\n[2,]    0    0    1    1    1    1    1    1\n[3,]    1    1    0    0    1    1    1    1\n[4,]    1    1    0    0    1    1    1    1\n[5,]    1    1    1    1    0    0    1    1\n[6,]    1    1    1    1    0    0    1    1\n[7,]    1    1    1    1    1    1    0    0\n[8,]    1    1    1    1    1    1    0    0\n\np-value of Null model: 0.28295 \n```\n\n\n:::\n:::\n\n\n\n# REFERENCES\n\n\\[1\\] [SAS Institute Inc.. SAS Help Center. The GEE procedure.](https://documentation.sas.com/doc/en/statug/15.2/statug_gee_examples01.htm)\n\n\\[2\\] [SAS/STAT® 13.1 User's Guide The GEE Procedure.](https://support.sas.com/documentation/onlinedoc/stat/141/gee.pdf)\n\n\\[3\\] [SAS/STAT® 13.1 User's Guide The GENMOD Procedure.](https://support.sas.com/documentation/onlinedoc/stat/131/genmod.pdf)\n\n\\[4\\] [Generalized Estimating Equation Package](https://cran.r-project.org/web/packages/geepack/geepack.pdf)\n\n\\[5\\] [Generalized Estimation Equation Solver](https://cran.r-project.org/web/packages/gee/gee.pdf)\n\n\\[6\\] [Touloumis A. (2015). \"R Package multgee: A Generalized Estimating Equations Solver for Multinomial Responses.\" Journal of Statistical Software.](https://www.jstatsoft.org/article/view/v064i08)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}