{
  "hash": "7a536813401176be95d226eda2d69c85",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R vs SAS Non-parametric Analysis - Friedman test\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rstatix) \nlibrary(ggpubr)\n```\n:::\n\n\n\n## Data used\n\nFriedman's test is used when you have one within-subjects independent variable with two or more levels and a dependent variable that is not interval and normally distributed (but at least ordinal). To build such unreplicated blocked data, we'll create a data frame called  `df_bp` from random number. In  `df_bp` : dependent variable `bp` is randomly generated; Block: `subjid` ; Group: `time_point`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n\ndf_bp = data.frame(bp = runif(n = 50, 138, 200)) %>% \n  mutate(subjid = as.factor(row_number() %% 5),  \n         time_point = as.factor((row_number()-1) %/% 5 + 1))\n\nhead(df_bp)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        bp subjid time_point\n1 155.8298      1          1\n2 186.8749      2          1\n3 163.3566      3          1\n4 192.7471      4          1\n5 196.3090      0          1\n6 140.8245      1          2\n```\n\n\n:::\n:::\n\n\n\nLet's see distribution of `df_bp`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggpubr::ggboxplot(df_bp, x = \"time_point\", y = \"bp\", add = \"jitter\")\n```\n\n::: {.cell-output-display}\n![](r-sas_friedman_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n## Example Code using {rstatix}\n\nIn R, **friedman_test** can be used to compare multiple means of rank in `bp` grouped by `time_point`, stratified by `subjid`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres.fried <- df_bp %>% \n  friedman_test(bp ~ time_point | subjid)\nres.fried\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 6\n  .y.       n statistic    df     p method       \n* <chr> <int>     <dbl> <dbl> <dbl> <chr>        \n1 bp        5      10.9     9 0.284 Friedman test\n```\n\n\n:::\n:::\n\n\n\n## Example Code using {PROC FREQ}\n\nIn SAS, **CMH2** option of PROC FREQ is used to perform Friedman's test.\n\n``` sas\nproc freq data=data_bp;\n   tables patient*dos*bp / \n          cmh2 scores=rank noprint;\nrun;\n\n```\n## Comparison\n\nThe Row Mean Scores Differ statistic of SAS result is compared with statistic of R result, together with *p*-value.\n\n+---------------+----------------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------+\n| Analysis      | Supported in R                                                                   | Supported in SAS                                                          | Results Match |\n+===============+==================================================================================+===========================================================================+===============+\n| Friedman Test | Yes                                                                              | Yes![](../images/friedman/Friedman_SAS.png){fig-align=\"left\" width=\"216\"} | Yes           |\n|               |                                                                                  |                                                                           |               |\n|               | ![](../images/friedman/Friedman_R.png){fig-align=\"left\" width=\"221\" height=\"31\"} |                                                                           |               |\n+---------------+----------------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------+\n\n## Comparison Results from more data\n\nFriedman's chi-suqare approximation varies when the number of blocks or the number of groups in the randomized block design differs. Similar comparison is done when number of block `subjid` ranges from 4 to 20 and number of group `time_point` ranges from 2 to 6. All results yield exact match (Comparison criterion is set to the tenth decimal place).\n\n# Summary and Recommendation\n\nThe R friedman test is comparable to SAS. Comparison between SAS and R show identical results for the datasets tried. The **rstatix** package `friedman_test()` function is very similar to SAS in the output produced.\n\n# References\n\nR `friedman_test()` documentation: <https://search.r-project.org/CRAN/refmans/rstatix/html/friedman_test.html>\n\nSAS `PROC FREQ` documentation: <https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_freq_sect033.htm>\n\n::: {.callout-note collapse=\"true\" title=\"Session Info\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.4.2 (2024-10-31 ucrt)\n os       Windows 11 x64 (build 26100)\n system   x86_64, mingw32\n ui       RTerm\n language (EN)\n collate  English_United States.utf8\n ctype    English_United States.utf8\n tz       America/Chicago\n date     2025-08-18\n pandoc   3.4 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n ! package * version date (UTC) lib source\n P rstatix * 0.7.2   2023-02-01 [?] RSPM (R 4.4.0)\n\n [1] C:/Users/ljohn71/Documents/CAMIS/renv/library/windows/R-4.4/x86_64-w64-mingw32\n [2] C:/Users/ljohn71/AppData/Local/Programs/R/R-4.4.2/library\n\n P ── Loaded and on-disk path mismatch.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "r-sas_friedman_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}