{
  "hash": "d4895409d472d109652eb33d45bd8bf1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R vs SAS vs Python Survey Summary Statistics\"\nbibliography: survey-stats-summary.bib\n---\n\n\n\nThis document will compare the survey summary statistics functionality in SAS (available through SAS/STAT), R (available from the [`{survey}`](%5B%60%7Bsurvey%7D%60%5D(https://r-survey.r-forge.r-project.org/survey/html/api.html)) package), and Python (available from the [`samplics`](https://samplics-org.github.io/samplics/) package), highlighting differences in methods and results. Only the default Taylor series linearisation method for calculating variances is used in all languages. A more detailed comparison between R and SAS for specific methods and use-cases is available in [@2017_YRBS], [@so2020modelling], or [@adamico_2009]. For a general guide to survey statistics, which has companion guides for both R and SAS, see [@Lohr_2022].\n\n# Result Comparison\n\nThe following table shows different survey summary statistics, the capabilities of each language, and whether or not the results match. Each analysis also includes calculating the standard error and confidence intervals.\n\n| Analysis        | Supported in R                                                                               | Supported in SAS                                                                                | Supported in Python                                             | Results Match\\*  | Notes                                                                                                                                          |\n|------------|------------|------------|------------|------------|------------|\n| Mean            | [Yes](../R/survey-stats-summary.html#Mean)                                                   | [Yes](../SAS/survey-stats-summary.html#Mean)                                                    | [Yes](../Python/survey-stats-summary.html#Mean)                 | Yes              | Must specify degrees of freedom in R for confidence limits                                                                                     |\n| Total           | [Yes](../R/survey-stats-summary.html#Total)                                                  | [Yes](../SAS/survey-stats-summary.html#Total)                                                   | [Yes](../Python/survey-stats-summary.html#Total)                | Yes              | Must specify degrees of freedom in R for confidence limits                                                                                     |\n| Ratios          | [Yes](../R/survey-stats-summary.html#Ratios)                                                 | [Yes](../SAS/survey-stats-summary.html#Ratios)                                                  | [Yes](../Python/survey-stats-summary.html#Ratios)               | Yes              | Must specify degrees of freedom in R for confidence limits                                                                                     |\n| Proportions     | [Yes](../R/survey-stats-summary.html#Proportions)                                            | [Yes](../SAS/survey-stats-summary.html##Proportions)                                            | [Yes](../Python/survey-stats-summary.html#Proportions)          | Yes\\*\\*          | In Python, the confidence limits of proportions only match to 1 or 2 s.f. This is due to a different method being used, which is undocumented. |\n| Quantiles       | [Yes](../R/survey-stats-summary.html#Quantiles)                                              | [Yes](../SAS/survey-stats-summary.html#Quantiles)                                               | No                                                              | [No](#Quantiles) | Different methods for calculating quantiles                                                                                                    |\n| Domain Analysis | [Yes](../R/survey-stats-summary.html#Summary%20Statistics%20on%20Complex%20Survey%20Designs) | [Yes](../SAS/survey-stats-summary.html##Summary%20Statistics%20on%20Complex%20Survey%20Designs) | [Yes](../Python/survey-stats-summary.html#Domain%20Estimations) | Yes              |                                                                                                                                                |\n| Design Effect   | [Yes](../R/survey-stats-summary.html#Summary%20Statistics%20on%20Complex%20Survey%20Designs) | [Yes](../SAS/survey-stats-summary.html##Summary%20Statistics%20on%20Complex%20Survey%20Designs) | No                                                              | Yes              | Set `deff=\"replace\"` in R to match SAS exactly                                                                                                 |\n\n*\\*Results match where feature is available*\n\n*\\*\\*For confidence limits of proportions near 0 and 1, `survey::svyciprop` can be more accurate than `confint` in R, but does not match other software.*\n\nFor the full R, SAS, and Python code and results used for this comparison, see below:\n\n::: {.callout-note collapse=\"true\" appearance=\"minimal\" title=\"Show Code\"}\n## R\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survey)\n\ndata(\"nhanes\")\n\nnhanes_design <- svydesign(\n  data = nhanes,\n  id = ~SDMVPSU, # Specify the PSU/cluster column\n  strata = ~SDMVSTRA,  # The stratification column\n  weights = ~WTMEC2YR,  # The weighting column\n  nest = TRUE  # Allows for PSUs with the same name nested within different strata\n)\n\n# Mean of HI_CHOL\nhi_chol_mean <- svymean(~HI_CHOL, nhanes_design, na.rm=TRUE)\n\n# Sum of HI_CHOL\nhi_chol_sum <- svytotal(~HI_CHOL, nhanes_design, na.rm=TRUE)\n\n# Ratio of HI_CHOL / RIAGENDR\nhi_chol_ratio <- svyratio(\n  numerator = ~HI_CHOL,\n  denominator = ~RIAGENDR,\n  nhanes_design,\n  na.rm=TRUE,\n  ci=TRUE,\n  se=TRUE,\n  separate=FALSE\n)\n\n# Proportion of different AGECAT values\nagecat_props <- svymean(~agecat, nhanes_design, na.rm=TRUE)\n\n# Quantiles of HI_CHOL\nhi_chol_quart <- svyquantile(\n  ~HI_CHOL,\n  nhanes_design,\n  quantiles=c(0.025, 0.5, 0.975),\n  na.rm=TRUE,\n  ci=TRUE\n)\n\n# Domain analysis of mean of HI_CHOL by race, with design effect\nhi_chol_mean_by_race <- svyby(~HI_CHOL, ~race, nhanes_design, svymean, na.rm=TRUE, deff=\"replace\")\n\nprint(list(\n  \"Mean of HI_CHOL\" = coef(hi_chol_mean),\n  \"SE of Mean HI_CHOL\" = SE(hi_chol_mean),\n  \"CL of Mean HI_CHOL\" = confint(hi_chol_mean, df=degf(nhanes_design)),\n  \"Sum of HI_CHOL\" = coef(hi_chol_sum),\n  \"SE of Sum HI_CHOL\" = SE(hi_chol_sum),\n  \"CL of Sum HI_CHOL\" = confint(hi_chol_sum, df=degf(nhanes_design)),\n  \"Ratio of HI_CHOL / RIAGENDR\" = coef(hi_chol_ratio),\n  \"SE of Ratio HI_CHOL / RIAGENDR\" = SE(hi_chol_ratio),\n  \"CL of Ratio HI_CHOL / RIAGENDR\" = confint(hi_chol_ratio, df=degf(nhanes_design)),\n  \"Proportion of AGECAT\" = coef(agecat_props),\n  \"SE of Proportion AGECAT\" = SE(agecat_props),\n  \"CL of Proportion AGECAT\" = confint(agecat_props, df=degf(nhanes_design)),\n  \"Quantiles of HI_CHOL\" = coef(hi_chol_quart),\n  \"SE of Quantiles HI_CHOL\" = SE(hi_chol_quart),\n  \"CL of Quantiles HI_CHOL\" = confint(hi_chol_quart, df=degf(nhanes_design)),\n  \"Mean of HI_CHOL by race\" = coef(hi_chol_mean_by_race),\n  \"SE of HI_CHOL by race\" = SE(hi_chol_mean_by_race),\n  \"CL of HI_CHOL by race\" = confint(hi_chol_mean_by_race, df=degf(nhanes_design)),\n  \"Design Effect of HI_CHOL by race\" = hi_chol_mean_by_race$DEff.HI_CHOL\n))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`Mean of HI_CHOL`\n HI_CHOL \n0.112143 \n\n$`SE of Mean HI_CHOL`\n           HI_CHOL\nHI_CHOL 0.00544584\n\n$`CL of Mean HI_CHOL`\n            2.5 %    97.5 %\nHI_CHOL 0.1005983 0.1236876\n\n$`Sum of HI_CHOL`\n HI_CHOL \n28635245 \n\n$`SE of Sum HI_CHOL`\n        HI_CHOL\nHI_CHOL 2020711\n\n$`CL of Sum HI_CHOL`\n           2.5 %   97.5 %\nHI_CHOL 24351530 32918961\n\n$`Ratio of HI_CHOL / RIAGENDR`\nHI_CHOL/RIAGENDR \n      0.07422209 \n\n$`SE of Ratio HI_CHOL / RIAGENDR`\nHI_CHOL/RIAGENDR \n     0.003714728 \n\n$`CL of Ratio HI_CHOL / RIAGENDR`\n                      2.5 %     97.5 %\nHI_CHOL/RIAGENDR 0.06634722 0.08209696\n\n$`Proportion of AGECAT`\n  agecat(0,19]  agecat(19,39]  agecat(39,59] agecat(59,Inf] \n     0.2077495      0.2934079      0.3032896      0.1955530 \n\n$`SE of Proportion AGECAT`\n  agecat(0,19]  agecat(19,39]  agecat(39,59] agecat(59,Inf] \n   0.006129950    0.009560692    0.004519463    0.008092578 \n\n$`CL of Proportion AGECAT`\n                   2.5 %    97.5 %\nagecat(0,19]   0.1947546 0.2207444\nagecat(19,39]  0.2731401 0.3136756\nagecat(39,59]  0.2937088 0.3128704\nagecat(59,Inf] 0.1783975 0.2127085\n\n$`Quantiles of HI_CHOL`\nHI_CHOL.0.025   HI_CHOL.0.5 HI_CHOL.0.975 \n            0             0             1 \n\n$`SE of Quantiles HI_CHOL`\nHI_CHOL.0.025   HI_CHOL.0.5 HI_CHOL.0.975 \n    0.2358596     0.2358596     0.0000000 \n\n$`CL of Quantiles HI_CHOL`\n              l u\nHI_CHOL.0.025 0 1\nHI_CHOL.0.5   0 1\nHI_CHOL.0.975 1 1\n\n$`Mean of HI_CHOL by race`\n         1          2          3          4 \n0.10149167 0.12164921 0.07864006 0.09967861 \n\n$`SE of HI_CHOL by race`\n[1] 0.006245843 0.006604134 0.010384645 0.024666227\n\n$`CL of HI_CHOL by race`\n       2.5 %    97.5 %\n1 0.08825107 0.1147323\n2 0.10764907 0.1356493\n3 0.05662560 0.1006545\n4 0.04738854 0.1519687\n\n$`Design Effect of HI_CHOL by race`\n[1] 1.082734 1.407822 2.091156 3.098290\n```\n\n\n:::\n:::\n\n\n\n## SAS\n\n``` default\n* Mean, sum quantile of HI_CHOL;\nproc surveymeans data=nhanes mean sum clm quantile=(0.025 0.5 0.975);\n    cluster SDMVPSU;\n    strata SDMVSTRA;\n    weight WTMEC2YR;\n    var HI_CHOL;\nrun;\n\n* Ratio of HI_CHOL / RIAGENDR;\nproc surveymeans data=nhanes;\n    cluster SDMVPSU;\n    strata SDMVSTRA;\n    weight WTMEC2YR;\n    ratio HI_CHOL / RIAGENDR;\nrun;\n\n* Proportions of agecat;\nproc surveyfreq data=nhanes;\n    cluster SDMVPSU;\n    strata SDMVSTRA;\n    weight WTMEC2YR;\n    table agecat / cl;\nrun;\n\n* Mean and DEFF of HI_CHOL by race;\nproc surveymeans data=nhanes mean deff;\n    cluster SDMVPSU;\n    strata SDMVSTRA;\n    weight WTMEC2YR;\n    domain race;\n    var HI_CHOL;\nrun;\n```\n\n```         \n\n                                                 The SURVEYMEANS Procedure\n\n                                                        Data Summary\n\n                                            Number of Strata                  15\n                                            Number of Clusters                31\n                                            Number of Observations          8591\n                                            Sum of Weights             276536446\n\n\n                                                         Statistics\n\n                                Std Error                                                Std Error\n Variable            Mean         of Mean       95% CL for Mean                Sum          of Sum        95% CL for Sum\n --------------------------------------------------------------------------------------------------------------------------\n HI_CHOL         0.112143        0.005446    0.10059829 0.12368762        28635245         2020711    24351529.8 32918960.7\n --------------------------------------------------------------------------------------------------------------------------\n\n\n                                                         Quantiles\n\n                                                                          Std\n                     Variable       Percentile       Estimate           Error    95% Confidence Limits\n                     ---------------------------------------------------------------------------------\n                     HI_CHOL          2.5                   0        0.024281    -0.0514730 0.05147298\n                                       50 Median            0        0.024281    -0.0514730 0.05147298\n                                     97.5            0.777070        0.024281     0.7255973 0.82854324\n                     ---------------------------------------------------------------------------------\n\n                                                 The SURVEYMEANS Procedure\n\n                                                        Data Summary\n\n                                            Number of Strata                  15\n                                            Number of Clusters                31\n                                            Number of Observations          8591\n                                            Sum of Weights             276536446\n\n\n                                                        Statistics\n\n                                                                    Std Error\n                     Variable               N            Mean         of Mean       95% CL for Mean\n                     ---------------------------------------------------------------------------------\n                     HI_CHOL             7846        0.112143        0.005446    0.10059829 0.12368762\n                     RIAGENDR            8591        1.512019        0.005302    1.50077977 1.52325807\n                     ---------------------------------------------------------------------------------\n\n\n                                                       Ratio Analysis\n\n                                                                              Std\n               Numerator Denominator            N           Ratio           Error        95% CL for Ratio\n               ----------------------------------------------------------------------------------------------\n               HI_CHOL   RIAGENDR            7846        0.074222        0.003715    0.06634722    0.08209696\n               ----------------------------------------------------------------------------------------------\n\n                                                  The SURVEYFREQ Procedure\n\n                                                        Data Summary\n\n                                            Number of Strata                  15\n                                            Number of Clusters                31\n                                            Number of Observations          8591\n                                            Sum of Weights             276536446\n\n\n                                                      Table of agecat\n\n                                        Weighted    Std Err of                Std Err of    95% Confidence Limits\n          agecat         Frequency     Frequency      Wgt Freq     Percent       Percent         for Percent\n          -------------------------------------------------------------------------------------------------------\n          (0,19]              2532      57450307       3043819     20.7749        0.6130     19.4755      22.0744\n          (19,39]             2033      81137975       3692818     29.3408        0.9561     27.3140      31.3676\n          (39,59]             2021      83870623       4853936     30.3290        0.4519     29.3709      31.2870\n          (59,Inf]            2005      54077541       4284296     19.5553        0.8093     17.8398      21.2709\n\n          Total               8591     276536446      13935730    100.0000                                       \n          -------------------------------------------------------------------------------------------------------\n\n                                                 The SURVEYMEANS Procedure\n\n                                                        Data Summary\n\n                                            Number of Strata                  15\n                                            Number of Clusters                31\n                                            Number of Observations          8591\n                                            Sum of Weights             276536446\n\n\n                                                         Statistics\n\n                                                                 Std Error          Design\n                                  Variable            Mean         of Mean          Effect\n                                  --------------------------------------------------------\n                                  HI_CHOL         0.112143        0.005446        2.336725\n                                  --------------------------------------------------------\n\n                                                 The SURVEYMEANS Procedure\n\n                                                 Statistics for race Domains\n\n                                                                         Std Error          Design\n                                  race    Variable            Mean         of Mean          Effect\n                          ------------------------------------------------------------------------\n                                     1    HI_CHOL         0.101492        0.006246        1.082734\n                                     2    HI_CHOL         0.121649        0.006604        1.407822\n                                     3    HI_CHOL         0.078640        0.010385        2.091156\n                                     4    HI_CHOL         0.099679        0.024666        3.098290\n                          ------------------------------------------------------------------------\n```\n\n## Python\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nfrom samplics import TaylorEstimator\nfrom samplics.utils.types import PopParam\n\nnhanes = pd.read_csv(\"../data/nhanes.csv\")\n\nnhanes_design_kwargs = dict(\n    psu=nhanes[\"SDMVPSU\"],\n    stratum=nhanes[\"SDMVSTRA\"],\n    samp_weight=nhanes[\"WTMEC2YR\"],\n    remove_nan=True,\n)\n\n# Mean of HI_CHOL\nmean_estimator = TaylorEstimator(PopParam.mean)\nmean_estimator.estimate(nhanes[\"HI_CHOL\"], **nhanes_design_kwargs)\nhi_chol_means = mean_estimator.to_dataframe()\n\n# Sum of HI_CHOL\ntotal_estimator = TaylorEstimator(PopParam.total)\ntotal_estimator.estimate(nhanes[\"HI_CHOL\"], **nhanes_design_kwargs)\nhi_chol_totals = total_estimator.to_dataframe()\n\n# Ratio of HI_CHOL / RIAGENDR\nratio_estimator = TaylorEstimator(PopParam.ratio)\nratio_estimator.estimate(\n    y=nhanes[\"HI_CHOL\"], x=nhanes[\"RIAGENDR\"], **nhanes_design_kwargs\n)\nhi_chol_ratio = ratio_estimator.to_dataframe()\n\n# Proportion of different AGECAT values\nprop_estimator = TaylorEstimator(PopParam.prop)\nprop_estimator.estimate(nhanes[\"agecat\"], **nhanes_design_kwargs)\nagecat_prop = prop_estimator.to_dataframe()\n\n# Quantiles of HI_CHOL\n# NA\n\n# Domain analysis of mean of HI_CHOL by race, with design effect\nmean_estimator = TaylorEstimator(PopParam.mean)\nmean_estimator.estimate(\n    nhanes[\"HI_CHOL\"],\n    **nhanes_design_kwargs,\n    domain=nhanes[\"race\"],\n    deff=True,  # Design effect param currently has no effect\n)\nhi_chol_domain_means = mean_estimator.to_dataframe()\n\n\nag_dict = agecat_prop.set_index(\"_level\").to_dict()\nhc_dict = hi_chol_domain_means.set_index(\"_domain\").to_dict()\n\nprint(\n    f\"\"\"\n    Mean of HI_CHOL: {hi_chol_means[\"_estimate\"][0]}\n    SE of Mean HI_CHOL: {hi_chol_means[\"_stderror\"][0]}\n    CL of Mean HI_CHOL: {(hi_chol_means[\"_lci\"][0], hi_chol_means[\"_uci\"][0])}\n    Sum of HI_CHOL: {hi_chol_totals[\"_estimate\"][0]}\n    SE of Sum HI_CHOL: {hi_chol_totals[\"_stderror\"][0]}\n    CL of Sum HI_CHOL: {(hi_chol_totals[\"_lci\"][0], hi_chol_totals[\"_uci\"][0])}\n    Ratio of HI_CHOL / RIAGENDR: {hi_chol_ratio[\"_estimate\"][0]}\n    SE of Ratio HI_CHOL / RIAGENDR: {hi_chol_ratio[\"_stderror\"][0]}\n    CL of Ratio HI_CHOL / RIAGENDR: {(hi_chol_ratio[\"_lci\"][0], hi_chol_ratio[\"_uci\"][0])}\n    Proportion of AGECAT: {ag_dict[\"_estimate\"]}\n    SE of Proportion AGECAT: {ag_dict[\"_stderror\"]}\n    LCL of Proportion AGECAT: {ag_dict[\"_lci\"]}\n    UCL of Proportion AGECAT: {ag_dict[\"_uci\"]}\n    Quantiles of HI_CHOL: Not available\n    Mean of HI_CHOL by race: {hc_dict[\"_estimate\"]}\n    SE of HI_CHL by race: {hc_dict[\"_stderror\"]}\n    LCL of HI_CHOL by race: {hc_dict[\"_lci\"]}\n    UCL of HI_CHOL by race: {hc_dict[\"_uci\"]}\n    Design Effect of HI_CHOL by race: Not available\n    \"\"\"\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n    Mean of HI_CHOL: 0.11214295634969222\n    SE of Mean HI_CHOL: 0.005445839698954557\n    CL of Mean HI_CHOL: (np.float64(0.1005982919131703), np.float64(0.12368762078621415))\n    Sum of HI_CHOL: 28635245.254672\n    SE of Sum HI_CHOL: 2020710.7436996205\n    CL of Sum HI_CHOL: (np.float64(24351529.84091034), np.float64(32918960.668433655))\n    Ratio of HI_CHOL / RIAGENDR: 0.07422209323594066\n    SE of Ratio HI_CHOL / RIAGENDR: 0.0037147278931070065\n    CL of Ratio HI_CHOL / RIAGENDR: (np.float64(0.06634722189017901), np.float64(0.0820969645817023))\n    Proportion of AGECAT: {'(0,19]': 0.2077494937870972, '(19,39]': 0.29340788818591346, '(39,59]': 0.30328958320385285, '(59,Inf]': 0.19555303482313666}\n    SE of Proportion AGECAT: {'(0,19]': 0.006129950336419631, '(19,39]': 0.009560691634608896, '(39,59]': 0.004519462827363183, '(59,Inf]': 0.008092578243976422}\n    LCL of Proportion AGECAT: {'(0,19]': 0.19505410930097866, '(19,39]': 0.27355685874096586, '(39,59]': 0.2937950591158628, '(59,Inf]': 0.1789647230500222}\n    UCL of Proportion AGECAT: {'(0,19]': 0.2210442684297426, '(19,39]': 0.3140766293472951, '(39,59]': 0.31295496708023285, '(59,Inf]': 0.21327950895208636}\n    Quantiles of HI_CHOL: Not available\n    Mean of HI_CHOL by race: {1: 0.10149166545397208, 2: 0.12164920535593333, 3: 0.07864006039908408, 4: 0.09967860947712034}\n    SE of HI_CHL by race: {1: 0.006245843308749599, 2: 0.006604133623532979, 3: 0.010384645000548863, 4: 0.024666226871851268}\n    LCL of HI_CHOL by race: {1: 0.0882510691256497, 2: 0.10764906749064211, 3: 0.056625596431891564, 4: 0.04738854441969514}\n    UCL of HI_CHOL by race: {1: 0.11473226178229445, 2: 0.13564934322122454, 3: 0.1006545243662766, 4: 0.15196867453454554}\n    Design Effect of HI_CHOL by race: Not available\n    \n```\n\n\n:::\n:::\n\n\n:::\n\n# Differences\n\n## Quantiles {#quantiles}\n\n`samplics` in Python does not have a method for calculating quantiles, and in R and SAS the available methods lead to different results. To demonstrate the differences in calculating quantiles, we will use the `apisrs` dataset from the `survey` package in R [@API_2000].\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survey)\n\ndata(\"api\")\n\nhead(apisrs) |> gt::gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"qirhhujrfm\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#qirhhujrfm table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#qirhhujrfm thead, #qirhhujrfm tbody, #qirhhujrfm tfoot, #qirhhujrfm tr, #qirhhujrfm td, #qirhhujrfm th {\n  border-style: none;\n}\n\n#qirhhujrfm p {\n  margin: 0;\n  padding: 0;\n}\n\n#qirhhujrfm .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#qirhhujrfm .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#qirhhujrfm .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#qirhhujrfm .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#qirhhujrfm .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#qirhhujrfm .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#qirhhujrfm .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#qirhhujrfm .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#qirhhujrfm .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#qirhhujrfm .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#qirhhujrfm .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#qirhhujrfm .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#qirhhujrfm .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#qirhhujrfm .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#qirhhujrfm .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qirhhujrfm .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#qirhhujrfm .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#qirhhujrfm .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#qirhhujrfm .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qirhhujrfm .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#qirhhujrfm .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qirhhujrfm .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#qirhhujrfm .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qirhhujrfm .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#qirhhujrfm .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#qirhhujrfm .gt_left {\n  text-align: left;\n}\n\n#qirhhujrfm .gt_center {\n  text-align: center;\n}\n\n#qirhhujrfm .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#qirhhujrfm .gt_font_normal {\n  font-weight: normal;\n}\n\n#qirhhujrfm .gt_font_bold {\n  font-weight: bold;\n}\n\n#qirhhujrfm .gt_font_italic {\n  font-style: italic;\n}\n\n#qirhhujrfm .gt_super {\n  font-size: 65%;\n}\n\n#qirhhujrfm .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#qirhhujrfm .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#qirhhujrfm .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#qirhhujrfm .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#qirhhujrfm .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#qirhhujrfm .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#qirhhujrfm .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#qirhhujrfm .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#qirhhujrfm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cds\">cds</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stype\">stype</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"name\">name</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sname\">sname</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"snum\">snum</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dname\">dname</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"dnum\">dnum</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cname\">cname</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"cnum\">cnum</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"flag\">flag</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pcttest\">pcttest</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"api00\">api00</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"api99\">api99</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"target\">target</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"growth\">growth</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sch.wide\">sch.wide</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"comp.imp\">comp.imp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"both\">both</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"awards\">awards</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"meals\">meals</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ell\">ell</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"yr.rnd\">yr.rnd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"mobility\">mobility</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"acs.k3\">acs.k3</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"acs.46\">acs.46</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"acs.core\">acs.core</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pct.resp\">pct.resp</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"not.hsg\">not.hsg</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"hsg\">hsg</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"some.col\">some.col</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"col.grad\">col.grad</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"grad.sch\">grad.sch</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"avg.ed\">avg.ed</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"full\">full</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"emer\">emer</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"enroll\">enroll</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"api.stu\">api.stu</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"pw\">pw</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"fpc\">fpc</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"cds\" class=\"gt_row gt_right\">15739081534155</td>\n<td headers=\"stype\" class=\"gt_row gt_center\">H</td>\n<td headers=\"name\" class=\"gt_row gt_left\">McFarland High</td>\n<td headers=\"sname\" class=\"gt_row gt_left\">McFarland High</td>\n<td headers=\"snum\" class=\"gt_row gt_right\">1039</td>\n<td headers=\"dname\" class=\"gt_row gt_left\">McFarland Unified</td>\n<td headers=\"dnum\" class=\"gt_row gt_right\">432</td>\n<td headers=\"cname\" class=\"gt_row gt_left\">Kern</td>\n<td headers=\"cnum\" class=\"gt_row gt_right\">14</td>\n<td headers=\"flag\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pcttest\" class=\"gt_row gt_right\">98</td>\n<td headers=\"api00\" class=\"gt_row gt_right\">462</td>\n<td headers=\"api99\" class=\"gt_row gt_right\">448</td>\n<td headers=\"target\" class=\"gt_row gt_right\">18</td>\n<td headers=\"growth\" class=\"gt_row gt_right\">14</td>\n<td headers=\"sch.wide\" class=\"gt_row gt_center\">No</td>\n<td headers=\"comp.imp\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"both\" class=\"gt_row gt_center\">No</td>\n<td headers=\"awards\" class=\"gt_row gt_center\">No</td>\n<td headers=\"meals\" class=\"gt_row gt_right\">44</td>\n<td headers=\"ell\" class=\"gt_row gt_right\">31</td>\n<td headers=\"yr.rnd\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"mobility\" class=\"gt_row gt_right\">6</td>\n<td headers=\"acs.k3\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"acs.46\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"acs.core\" class=\"gt_row gt_right\">24</td>\n<td headers=\"pct.resp\" class=\"gt_row gt_right\">82</td>\n<td headers=\"not.hsg\" class=\"gt_row gt_right\">44</td>\n<td headers=\"hsg\" class=\"gt_row gt_right\">34</td>\n<td headers=\"some.col\" class=\"gt_row gt_right\">12</td>\n<td headers=\"col.grad\" class=\"gt_row gt_right\">7</td>\n<td headers=\"grad.sch\" class=\"gt_row gt_right\">3</td>\n<td headers=\"avg.ed\" class=\"gt_row gt_right\">1.91</td>\n<td headers=\"full\" class=\"gt_row gt_right\">71</td>\n<td headers=\"emer\" class=\"gt_row gt_right\">35</td>\n<td headers=\"enroll\" class=\"gt_row gt_right\">477</td>\n<td headers=\"api.stu\" class=\"gt_row gt_right\">429</td>\n<td headers=\"pw\" class=\"gt_row gt_right\">30.97</td>\n<td headers=\"fpc\" class=\"gt_row gt_right\">6194</td></tr>\n    <tr><td headers=\"cds\" class=\"gt_row gt_right\">19642126066716</td>\n<td headers=\"stype\" class=\"gt_row gt_center\">E</td>\n<td headers=\"name\" class=\"gt_row gt_left\">Stowers (Cecil </td>\n<td headers=\"sname\" class=\"gt_row gt_left\">Stowers (Cecil B.) Elementary</td>\n<td headers=\"snum\" class=\"gt_row gt_right\">1124</td>\n<td headers=\"dname\" class=\"gt_row gt_left\">ABC Unified</td>\n<td headers=\"dnum\" class=\"gt_row gt_right\">1</td>\n<td headers=\"cname\" class=\"gt_row gt_left\">Los Angeles</td>\n<td headers=\"cnum\" class=\"gt_row gt_right\">18</td>\n<td headers=\"flag\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pcttest\" class=\"gt_row gt_right\">100</td>\n<td headers=\"api00\" class=\"gt_row gt_right\">878</td>\n<td headers=\"api99\" class=\"gt_row gt_right\">831</td>\n<td headers=\"target\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"growth\" class=\"gt_row gt_right\">47</td>\n<td headers=\"sch.wide\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"comp.imp\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"both\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"awards\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"meals\" class=\"gt_row gt_right\">8</td>\n<td headers=\"ell\" class=\"gt_row gt_right\">25</td>\n<td headers=\"yr.rnd\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"mobility\" class=\"gt_row gt_right\">15</td>\n<td headers=\"acs.k3\" class=\"gt_row gt_right\">19</td>\n<td headers=\"acs.46\" class=\"gt_row gt_right\">30</td>\n<td headers=\"acs.core\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pct.resp\" class=\"gt_row gt_right\">97</td>\n<td headers=\"not.hsg\" class=\"gt_row gt_right\">4</td>\n<td headers=\"hsg\" class=\"gt_row gt_right\">10</td>\n<td headers=\"some.col\" class=\"gt_row gt_right\">23</td>\n<td headers=\"col.grad\" class=\"gt_row gt_right\">43</td>\n<td headers=\"grad.sch\" class=\"gt_row gt_right\">21</td>\n<td headers=\"avg.ed\" class=\"gt_row gt_right\">3.66</td>\n<td headers=\"full\" class=\"gt_row gt_right\">90</td>\n<td headers=\"emer\" class=\"gt_row gt_right\">10</td>\n<td headers=\"enroll\" class=\"gt_row gt_right\">478</td>\n<td headers=\"api.stu\" class=\"gt_row gt_right\">420</td>\n<td headers=\"pw\" class=\"gt_row gt_right\">30.97</td>\n<td headers=\"fpc\" class=\"gt_row gt_right\">6194</td></tr>\n    <tr><td headers=\"cds\" class=\"gt_row gt_right\">30664493030640</td>\n<td headers=\"stype\" class=\"gt_row gt_center\">H</td>\n<td headers=\"name\" class=\"gt_row gt_left\">Brea-Olinda Hig</td>\n<td headers=\"sname\" class=\"gt_row gt_left\">Brea-Olinda High</td>\n<td headers=\"snum\" class=\"gt_row gt_right\">2868</td>\n<td headers=\"dname\" class=\"gt_row gt_left\">Brea-Olinda Unified</td>\n<td headers=\"dnum\" class=\"gt_row gt_right\">79</td>\n<td headers=\"cname\" class=\"gt_row gt_left\">Orange</td>\n<td headers=\"cnum\" class=\"gt_row gt_right\">29</td>\n<td headers=\"flag\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pcttest\" class=\"gt_row gt_right\">98</td>\n<td headers=\"api00\" class=\"gt_row gt_right\">734</td>\n<td headers=\"api99\" class=\"gt_row gt_right\">742</td>\n<td headers=\"target\" class=\"gt_row gt_right\">3</td>\n<td headers=\"growth\" class=\"gt_row gt_right\">-8</td>\n<td headers=\"sch.wide\" class=\"gt_row gt_center\">No</td>\n<td headers=\"comp.imp\" class=\"gt_row gt_center\">No</td>\n<td headers=\"both\" class=\"gt_row gt_center\">No</td>\n<td headers=\"awards\" class=\"gt_row gt_center\">No</td>\n<td headers=\"meals\" class=\"gt_row gt_right\">10</td>\n<td headers=\"ell\" class=\"gt_row gt_right\">10</td>\n<td headers=\"yr.rnd\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"mobility\" class=\"gt_row gt_right\">7</td>\n<td headers=\"acs.k3\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"acs.46\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"acs.core\" class=\"gt_row gt_right\">28</td>\n<td headers=\"pct.resp\" class=\"gt_row gt_right\">95</td>\n<td headers=\"not.hsg\" class=\"gt_row gt_right\">5</td>\n<td headers=\"hsg\" class=\"gt_row gt_right\">9</td>\n<td headers=\"some.col\" class=\"gt_row gt_right\">21</td>\n<td headers=\"col.grad\" class=\"gt_row gt_right\">41</td>\n<td headers=\"grad.sch\" class=\"gt_row gt_right\">24</td>\n<td headers=\"avg.ed\" class=\"gt_row gt_right\">3.71</td>\n<td headers=\"full\" class=\"gt_row gt_right\">83</td>\n<td headers=\"emer\" class=\"gt_row gt_right\">18</td>\n<td headers=\"enroll\" class=\"gt_row gt_right\">1410</td>\n<td headers=\"api.stu\" class=\"gt_row gt_right\">1287</td>\n<td headers=\"pw\" class=\"gt_row gt_right\">30.97</td>\n<td headers=\"fpc\" class=\"gt_row gt_right\">6194</td></tr>\n    <tr><td headers=\"cds\" class=\"gt_row gt_right\">19644516012744</td>\n<td headers=\"stype\" class=\"gt_row gt_center\">E</td>\n<td headers=\"name\" class=\"gt_row gt_left\">Alameda Element</td>\n<td headers=\"sname\" class=\"gt_row gt_left\">Alameda Elementary</td>\n<td headers=\"snum\" class=\"gt_row gt_right\">1273</td>\n<td headers=\"dname\" class=\"gt_row gt_left\">Downey Unified</td>\n<td headers=\"dnum\" class=\"gt_row gt_right\">187</td>\n<td headers=\"cname\" class=\"gt_row gt_left\">Los Angeles</td>\n<td headers=\"cnum\" class=\"gt_row gt_right\">18</td>\n<td headers=\"flag\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pcttest\" class=\"gt_row gt_right\">99</td>\n<td headers=\"api00\" class=\"gt_row gt_right\">772</td>\n<td headers=\"api99\" class=\"gt_row gt_right\">657</td>\n<td headers=\"target\" class=\"gt_row gt_right\">7</td>\n<td headers=\"growth\" class=\"gt_row gt_right\">115</td>\n<td headers=\"sch.wide\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"comp.imp\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"both\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"awards\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"meals\" class=\"gt_row gt_right\">70</td>\n<td headers=\"ell\" class=\"gt_row gt_right\">25</td>\n<td headers=\"yr.rnd\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"mobility\" class=\"gt_row gt_right\">23</td>\n<td headers=\"acs.k3\" class=\"gt_row gt_right\">23</td>\n<td headers=\"acs.46\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"acs.core\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pct.resp\" class=\"gt_row gt_right\">100</td>\n<td headers=\"not.hsg\" class=\"gt_row gt_right\">37</td>\n<td headers=\"hsg\" class=\"gt_row gt_right\">40</td>\n<td headers=\"some.col\" class=\"gt_row gt_right\">14</td>\n<td headers=\"col.grad\" class=\"gt_row gt_right\">8</td>\n<td headers=\"grad.sch\" class=\"gt_row gt_right\">1</td>\n<td headers=\"avg.ed\" class=\"gt_row gt_right\">1.96</td>\n<td headers=\"full\" class=\"gt_row gt_right\">85</td>\n<td headers=\"emer\" class=\"gt_row gt_right\">18</td>\n<td headers=\"enroll\" class=\"gt_row gt_right\">342</td>\n<td headers=\"api.stu\" class=\"gt_row gt_right\">291</td>\n<td headers=\"pw\" class=\"gt_row gt_right\">30.97</td>\n<td headers=\"fpc\" class=\"gt_row gt_right\">6194</td></tr>\n    <tr><td headers=\"cds\" class=\"gt_row gt_right\">40688096043293</td>\n<td headers=\"stype\" class=\"gt_row gt_center\">E</td>\n<td headers=\"name\" class=\"gt_row gt_left\">Sunnyside Eleme</td>\n<td headers=\"sname\" class=\"gt_row gt_left\">Sunnyside Elementary</td>\n<td headers=\"snum\" class=\"gt_row gt_right\">4926</td>\n<td headers=\"dname\" class=\"gt_row gt_left\">San Luis Coastal Unified</td>\n<td headers=\"dnum\" class=\"gt_row gt_right\">640</td>\n<td headers=\"cname\" class=\"gt_row gt_left\">San Luis Obispo</td>\n<td headers=\"cnum\" class=\"gt_row gt_right\">39</td>\n<td headers=\"flag\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pcttest\" class=\"gt_row gt_right\">99</td>\n<td headers=\"api00\" class=\"gt_row gt_right\">739</td>\n<td headers=\"api99\" class=\"gt_row gt_right\">719</td>\n<td headers=\"target\" class=\"gt_row gt_right\">4</td>\n<td headers=\"growth\" class=\"gt_row gt_right\">20</td>\n<td headers=\"sch.wide\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"comp.imp\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"both\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"awards\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"meals\" class=\"gt_row gt_right\">43</td>\n<td headers=\"ell\" class=\"gt_row gt_right\">12</td>\n<td headers=\"yr.rnd\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"mobility\" class=\"gt_row gt_right\">12</td>\n<td headers=\"acs.k3\" class=\"gt_row gt_right\">20</td>\n<td headers=\"acs.46\" class=\"gt_row gt_right\">29</td>\n<td headers=\"acs.core\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pct.resp\" class=\"gt_row gt_right\">91</td>\n<td headers=\"not.hsg\" class=\"gt_row gt_right\">8</td>\n<td headers=\"hsg\" class=\"gt_row gt_right\">21</td>\n<td headers=\"some.col\" class=\"gt_row gt_right\">27</td>\n<td headers=\"col.grad\" class=\"gt_row gt_right\">34</td>\n<td headers=\"grad.sch\" class=\"gt_row gt_right\">10</td>\n<td headers=\"avg.ed\" class=\"gt_row gt_right\">3.17</td>\n<td headers=\"full\" class=\"gt_row gt_right\">100</td>\n<td headers=\"emer\" class=\"gt_row gt_right\">0</td>\n<td headers=\"enroll\" class=\"gt_row gt_right\">217</td>\n<td headers=\"api.stu\" class=\"gt_row gt_right\">189</td>\n<td headers=\"pw\" class=\"gt_row gt_right\">30.97</td>\n<td headers=\"fpc\" class=\"gt_row gt_right\">6194</td></tr>\n    <tr><td headers=\"cds\" class=\"gt_row gt_right\">19734456014278</td>\n<td headers=\"stype\" class=\"gt_row gt_center\">E</td>\n<td headers=\"name\" class=\"gt_row gt_left\">Los Molinos Ele</td>\n<td headers=\"sname\" class=\"gt_row gt_left\">Los Molinos Elementary</td>\n<td headers=\"snum\" class=\"gt_row gt_right\">2463</td>\n<td headers=\"dname\" class=\"gt_row gt_left\">Hacienda la Puente Unif</td>\n<td headers=\"dnum\" class=\"gt_row gt_right\">284</td>\n<td headers=\"cname\" class=\"gt_row gt_left\">Los Angeles</td>\n<td headers=\"cnum\" class=\"gt_row gt_right\">18</td>\n<td headers=\"flag\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pcttest\" class=\"gt_row gt_right\">93</td>\n<td headers=\"api00\" class=\"gt_row gt_right\">835</td>\n<td headers=\"api99\" class=\"gt_row gt_right\">822</td>\n<td headers=\"target\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"growth\" class=\"gt_row gt_right\">13</td>\n<td headers=\"sch.wide\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"comp.imp\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"both\" class=\"gt_row gt_center\">Yes</td>\n<td headers=\"awards\" class=\"gt_row gt_center\">No</td>\n<td headers=\"meals\" class=\"gt_row gt_right\">16</td>\n<td headers=\"ell\" class=\"gt_row gt_right\">19</td>\n<td headers=\"yr.rnd\" class=\"gt_row gt_center\">NA</td>\n<td headers=\"mobility\" class=\"gt_row gt_right\">13</td>\n<td headers=\"acs.k3\" class=\"gt_row gt_right\">19</td>\n<td headers=\"acs.46\" class=\"gt_row gt_right\">29</td>\n<td headers=\"acs.core\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"pct.resp\" class=\"gt_row gt_right\">71</td>\n<td headers=\"not.hsg\" class=\"gt_row gt_right\">1</td>\n<td headers=\"hsg\" class=\"gt_row gt_right\">8</td>\n<td headers=\"some.col\" class=\"gt_row gt_right\">20</td>\n<td headers=\"col.grad\" class=\"gt_row gt_right\">38</td>\n<td headers=\"grad.sch\" class=\"gt_row gt_right\">34</td>\n<td headers=\"avg.ed\" class=\"gt_row gt_right\">3.96</td>\n<td headers=\"full\" class=\"gt_row gt_right\">75</td>\n<td headers=\"emer\" class=\"gt_row gt_right\">20</td>\n<td headers=\"enroll\" class=\"gt_row gt_right\">258</td>\n<td headers=\"api.stu\" class=\"gt_row gt_right\">211</td>\n<td headers=\"pw\" class=\"gt_row gt_right\">30.97</td>\n<td headers=\"fpc\" class=\"gt_row gt_right\">6194</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nIn SAS, PROC SURVEYMEANS will calculate quantiles of specific probabilities as you request them, using Woodruff's method for intervals and a custom quantile method [@SAS_2018, pp. 9834]. The quantile method does not match any of the available `qrules` in R, and although the default `interval.types` in the R `survey::svyquantile` function also uses Woodruff's method, it is a different implementation.\n\nThe method and results from SAS are as follows:\n\n``` default\nproc surveymeans data=apisrs total=6194 quantile=(0.025 0.5 0.975);\n    var growth;\nrun;\n```\n\n```         \n                             The SURVEYMEANS Procedure\n\n                                    Data Summary\n\n                        Number of Observations           200\n\n\n\n\n                                     Quantiles\n\n                                                      Std\n Variable       Percentile       Estimate           Error    95% Confidence Limits\n ---------------------------------------------------------------------------------\n growth           2.5          -16.500000        1.755916    -19.962591 -13.037409\n                   50 Median    26.500000        1.924351     22.705263  30.294737\n                 97.5           99.000000       16.133827     67.184794 130.815206\n ---------------------------------------------------------------------------------\n```\n\nIf in R we use the default `qrule=\"math\"` (equivalent to `qrule=\"hf1\"` and matches `type=1` in the `quantile` function for unweighted data) along with the default `interval.type=\"mean\"`, we get the following results:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsrs_design <- svydesign(data = apisrs,id = ~1,fpc = ~fpc,)\n\nsvyquantile(\n  ~growth,\n  srs_design,\n  quantiles = c(0.025, 0.5, 0.975),\n  ci=TRUE,\n  se=TRUE\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$growth\n      quantile ci.2.5 ci.97.5        se\n0.025      -16    -21     -12  2.281998\n0.5         27     24      31  1.774887\n0.975       99     84     189 26.623305\n\nattr(,\"hasci\")\n[1] TRUE\nattr(,\"class\")\n[1] \"newsvyquantile\"\n```\n\n\n:::\n:::\n\n\n\nHere we can see that the quantiles, confidence intervals, and standard errors do not match SAS. From testing, none of the available `qrule` methods match SAS for the quantile values, so it is recommended to use the default values unless you have need of some of the other properties of different quantile definitions - see [`vignette(\"qrule\", package=\"survey\")`](https://cran.r-project.org/web/packages/survey/vignettes/qrule.pdf) for more detail. If an exact match to SAS is required, then the `svyquantile` function allows for passing a custom function to the `qrule` argument to define your own method for calculating quantiles. Below is an example that will match SAS:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsas_qrule <- function(x, w, p) {\n  # Custom qrule to match SAS, based on survey::oldsvyquantile's internal method\n  if (any(is.na(x))) \n    return(NA * p)\n  w <- rowsum(w, x, reorder = TRUE)\n  x <- sort(unique(x))\n  cum.w <- cumsum(w)/sum(w)\n  cdf <- approxfun(cum.w, x, method = \"linear\", f = 1, \n    yleft = min(x), yright = max(x), ties = min)\n  cdf(p)\n}\n\n\nsas_quants <- svyquantile(\n  ~growth,\n  srs_design,\n  quantiles = c(0.025, 0.5, 0.975),\n  qrule=sas_qrule,\n  ci=TRUE,\n  se=TRUE\n)\n\nsas_quants\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$growth\n      quantile    ci.2.5   ci.97.5        se\n0.025    -16.5 -22.00000 -15.07482  1.755916\n0.5       26.5  23.03563  30.62510  1.924351\n0.975     99.0  83.70616 147.33657 16.133827\n\nattr(,\"hasci\")\n[1] TRUE\nattr(,\"class\")\n[1] \"newsvyquantile\"\n```\n\n\n:::\n:::\n\n\n\nNote that although the quantiles and standard errors match, the confidence intervals still do not match SAS. For this another custom calculation is required, based on the formula used in SAS:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsas_quantile_confint <- function(newsvyquantile, level=0.05, df=Inf) {\n  q <- coef(newsvyquantile)\n  se <- SE(newsvyquantile)\n  ci <- cbind(\n    q,\n    q + se * qt(level/2, df),\n    q - se * qt(1 - level/2, df),\n    se\n  )\n  colnames(ci) <- c(\"quantile\", paste0(\"ci.\", c(100 * level / 2, 100 * (1 - level / 2))), \"se\")\n\n  ci\n}\n\nsas_quantile_confint(sas_quants, df=degf(srs_design))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             quantile    ci.2.5   ci.97.5        se\ngrowth.0.025    -16.5 -19.96259 -19.96259  1.755916\ngrowth.0.5       26.5  22.70526  22.70526  1.924351\ngrowth.0.975     99.0  67.18479  67.18479 16.133827\n```\n\n\n:::\n:::\n\n\n\n## Other considerations\n\n### Degrees of Freedom\n\nSome of the functions in R require the degrees of freedom to be specified when calculating confidence intervals, otherwise it assumes a normal distribution. This can be done easily by using the `survey::degf` function, which calculates the degrees of freedom for a survey design object.\n\n### Single PSU Strata\n\nAlthough it was not apparent with the examples used here, if there is only one PSU from a stratum then R will by default error, whereas SAS will remove that stratum from the variance calculation. This can be changed in R by setting the `options(survey.lonely.psu=\"certainty\")` to match SAS and have it make no contribution to the variance. In `samplics`, this behaviour can be configured using the `single_psu` argument to the `estimate` method, and can be set to to match SAS using `SinglePSUEst.certainty`. This should be considered carefully however, in R and Python there are additional methods of handling single PSUs that may be more appropriate for your use-case.\n\n### Documentation Differences\n\nOne key consideration when choosing a statistical package is the documentation available. In this case, both the `survey` package in R and the survey procedures in SAS have a much more comprehensive set of documentation and examples than `samplics` in Python. This includes both detailed examples, as well as the underlying theory and methods used in the calculations including references to the literature.\n\n# Summary and Recommendations\n\nThe `{survey}` package in R and the survey procedures in SAS/STAT both provide similar functionality for calculating survey summary statistics. In most cases in both our tests and others, the results are identical ([@2017_YRBS], [@so2020modelling], [@adamico_2009]). Where differences do occur, primarily in calculating quantiles, the methods in R are more varied and well-documented.\n\nIn contrast, the `samplics` package in Python is still early in development, and although it does provide some functionality there are still major limitations in both basic statistics (i.e. quantiles) and in more complex methods that were beyond the scope of this document, and the methods are much less well-documented.\n\n::: {.callout-note collapse=\"true\" title=\"Session Info\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n Session info \n setting  value\n version  R version 4.4.3 (2025-02-28)\n os       Ubuntu 24.04.2 LTS\n system   x86_64, linux-gnu\n ui       X11\n language (EN)\n collate  C.UTF-8\n ctype    C.UTF-8\n tz       Europe/London\n date     2025-03-13\n pandoc   NA (via rmarkdown)\n\n Packages \n ! package * version date (UTC) lib source\n P survey  * 4.4-2   2024-03-20 [?] RSPM (R 4.4.0)\n\n [1] /home/michael/source/CAMIS/renv/library/linux-ubuntu-noble/R-4.4/x86_64-pc-linux-gnu\n [2] /opt/R/4.4.3/lib/R/library\n\n P  Loaded and on-disk path mismatch.\n\n External software \n setting value\n SAS     9.04.01M7P080520\n\n\n```\n\n\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n Python configuration \n Python    3.12.3 (main, Feb  4 2025, 14:48:35) [GCC 13.3.0]\n samplics  0.4.22\n```\n\n\n:::\n:::\n\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}