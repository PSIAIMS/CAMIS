{
  "hash": "489491d1ddc63f1071afcd570eb16457",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R/SAS Chi-Squared and Fisher's Exact Comparision\"\n---\n\n\n\n# Chi-Squared Test\n\nChi-Squared test is a hypothesis test for independent contingency tables, dependent on rows and column totals. The test assumes:\n\n-   observations are independent of each other\n\n-   all values are 1 or more and at least 80% of the cells are greater than 5.\n\n-   data should be categorical\n\nThe Chi-Squared statistic is found by:\n\n$$\n\\chi^2=\\frac{\\sum(O-E)^2}{E}\n$$\n\nWhere O is the observed and E is the expected.\\\nFor an r x c table (where r is the number of rows and c the number of columns), the Chi-squared distribution's degrees of freedom is (r-1)\\*(c-1). The resultant statistic with correct degrees of freedom follows this distribution when its expected values are aligned with the assumptions of the test, under the null hypothesis. The resultant p value informs the magnitude of disagreement with the null hypothesis and not the magnitude of association\n\nFor this example we will use data about cough symptoms and history of bronchitis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbronch <- matrix(c(26, 247, 44, 1002), ncol = 2)\nrow.names(bronch) <- c(\"cough\", \"no cough\")\ncolnames(bronch) <- c(\"bronchitis\", \"no bronchitis\")\n```\n:::\n\n\n\nTo a chi-squared test in R you will use the following code.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(bronch)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  bronch\nX-squared = 11.145, df = 1, p-value = 0.0008424\n```\n\n\n:::\n:::\n\n\n\nTo run a chi-squared test in SAS you used the following code.\n\n\n\n::: {.cell}\n\n```{.sas .cell-code}\nproc freq data=proj1.bronchitis;\ntables Cough*Bronchitis / chisq;\nrun;\n```\n:::\n\n\n\nThe result in the \"Chi-Square\" section of the results table in SAS will not match R, in this case it will be 12.1804 with a p-value of 0.0005. This is because by default R does a Yate's continuity adjustment. To change this set `correct` to false.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(bronch, correct = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  bronch\nX-squared = 12.18, df = 1, p-value = 0.0004829\n```\n\n\n:::\n:::\n\n\n\nAlternatively, SAS also produces the correct chi-square value by default. It is the \"Continuity Adj. Chi-Square\" value in the results table.\n\n# Fisher's Exact Test\n\nComparison between the Fisher's Exact Test in both R and SAS shows that the two\nsoftware match on the p-value and confidence intervals.  The odd ratio does not match.\nThe reason the odds ratio does not match is because R uses an \"exact\" odds ratio based \non the hypergeomtric distribution, while SAS uses a standard AD/BC odds ratio.  Note\nthat R always uses an \"exact\" Fisher test.  Therefore, when trying to match SAS, you\nmust use the \"exact\" statement on the PROC FREQ.\n",
    "supporting": [
      "r-sas_chi-sq_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}