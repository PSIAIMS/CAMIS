{
  "hash": "398cccc35065f396e7a987ccf3819c49",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Generalized Estimating Equations (GEE) methods in SAS\"\n---\n\n\n\n# INTRODUCTION\n\nGeneralized Estimating Equations (GEE) methods extend the Generalized Linear Model (GLM) framework using link functions that relate the predictors to transformed outcome variable. For dichotomous response variables, the link functions is the probit (in case of rare events complementary log-log may be preferable). For outcomes with more than two categories, the cumulative link function is used in case of ordinal variables and generalized logit for nominal variables.\n\nGEE are marginal models and therefore estimate population-averaged effects and within-subject correlation is analysed by specifying a working correlation structure (as in MMRM). Estimators are obtained via quasi-likelihood via iterative solving of estimating equations.\n\n# EXAMPLE DATA\n\nA SAS data of clinical trial data comparing two treatments for a respiratory disorder available in [\"Gee Model for Binary Data\"](https://documentation.sas.com/doc/en/statug/15.2/statug_code_genmex5.htm) in the SAS/STAT Sample Program Library \\[1\\] is used to create these examples.\n\nTo uniquely identify subjects, a new variable USUBJID was created by concatenating SITE and ID. Variables TREATMENT and VISIT were renamed to TRTP and AVISITN.\n\nAdditionally, two variables were created using randomly generated values to simulate variables with more than two categories. One was an ordinal variable with values 1, 2, and 3; the other was a nominal variable with categories 'liver', 'lung', and 'bone'. The resulting dataset is saved here: /data/resp.xlsx The following SAS code was used:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproc format; \n  value respmulti \n  1='Liver' \n  2='Lung' \n  3='Bone'; \nrun; \n \ndata resp; \n  set resp1; \n    call streaminit(1234);   \n    respord = rand(\"integer\", 1, 3);     *Ordinal; \n    respnom = put(respord, respmulti.);  *Nominal;\nrun;\n```\n:::\n\n\n\n# BINARY OUTCOME\n\n### CODE\n\nThis example shows syntax with `PROC GEE` using the example data. The probability of the event ( specified as `event='1')` is analyzed including treatment, visit and the treatment by visit interaction as fixed effects. The independent correlation matrix (which is the option by default), is used to account for intra-subjects correlation.\n\nThe binomial distribution and the link function (in this case is the logit function) are specified in the `model` statement as /`dist=bin link=logit`). The unique subject and the correlation structure are defined as `repeated subject=<SUBJECT>/corr=<CORRELATION MATRIX TYPE>` .\n\nThe U.S. Food and Drug Administration (FDA) advises \"*sponsors to consider using of robust standard error method such as the Huber-White \"sandwich\" standard error, particularly when the model does not include treatment by covariate interactions*\" \\[2\\]. This robust \"sandwich\" SE is computed by default in `PROC GEE`. Nominal SE (also called model-based SE) can be easily obtained by adding the `modelse` option in the `repeated` statement. This option is commented out in the code below, but included to indicate its availability.\n\nPredicted probabilities and Odds Ratios (OR) can be obtained in SAS using the `lsmeans` statement:\n\n-   The `ilink` option provides back-transformed predicted probabilities.\n\n-   The `diff` option, combined with either `exp` or `oddsratio`, computes ORs.\n\n-   `cl` computes confidence intervals.\n\n\n\n::: {.cell}\n\n```{.sas .cell-code}\nproc gee data=resp; \n   class trtp(ref=\"P\") avisitn(ref='1') usubjid; \n   model outcome(event='1') = trtp avisitn trtp*avisitn/ dist=bin link=logit; \n   lsmeans trtp*avisitn/cl exp ilink oddsratio diff; \n   repeated subject=usubjid/corr=ind /*modelse*/;  \nrun;\n\n```\n:::\n\n\n\nSimilar syntax can be used in `PROC GENMOD`. While the syntax is equivalent, very slight differences in the results may occur, typically beyond the tenth decimal place.\n\n### RESULTS\n\nResults were extracted into a SAS dataset using the `ODS OUTPUT` statement and subsequently refined by selecting key rows to facilitate clearer presentation. For instance, it only displays the probabilities for the treatment by visit interaction, and the OR comparing the active treatment versus placebo.\n\n[Estimated Parameters:]{.underline}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/1_estimated_parameters.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n[Probability of event:]{.underline}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/2_probability_of_event.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n[ODDS RATIO (OR):]{.underline}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/3_odds_ratio.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n# OUTCOME WITH MORE THAN 2 CATEGORIES\n\nSimilar syntax as for binary variables can be applied by specifying a multinomial distribution and selecting the appropriate link function. Models with cumulative link functions apply to ordinal data and generalized logit models are fit to nominal data \\[3\\]). Note the link function generalized logit is available in `PROC GEE`, but not in `PROC GENMOD.`\n\nFor multinomial responses, SAS limits the correlation matrix type to `independent,` so other correlation maxtrix options are not supported.\n\nThe estimated parameters for each model are detailed below. ORs can be obtained using the `LSMEANS` statement, following the same approach used for binary outcomes.\n\n### CODE\n\n[Ordinal variable:]{.underline}\n\n\n\n::: {.cell}\n\n```{.sas .cell-code}\nproc gee data=resp; \nclass trtp(ref=\"A\") avisitn(ref='1') usubjid;   \nmodel respord=trtp avisitn trtp*avisitn/ dist=multinomial link=cumlogit;  \nlsmeans trtp*avisitn/cl exp ilink oddsratio diff;\nrepeated subject=usubjid/corr=ind; \nrun;\n```\n:::\n\n\n\n[Nominal variable:]{.underline}\n\n\n\n::: {.cell}\n\n```{.sas .cell-code}\nproc gee data=resp ; \nclass trtp(ref=\"A\") avisitn(ref='1') usubjid;   \nmodel respnom(event='Liver')=trtp avisitn trtp*avisitn/ dist=multinomial link=glogit; \nlsmeans trtp*avisitn/cl exp ilink oddsratio diff;\nrepeated subject=usubjid/corr=ind;\nrun;\n```\n:::\n\n\n\n### RESULTS\n\n[Ordinal variable:]{.underline}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/4_ordinal_variable.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n[Nominal variable:]{.underline}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/gee/5_nominal_variable.png){fig-align='center' width=50%}\n:::\n:::\n\n\n\n## RERERENCES\n\n1.  [SAS Institute Inc. SAS Help Center. The GEE procedure.](https://documentation.sas.com/doc/en/statug/15.2/statug_gee_examples01.htm)\n\n2.  [SAS/STAT® 13.1 User's Guide The GEE Procedure.](https://support.sas.com/documentation/onlinedoc/stat/141/gee.pdf)\n\n3.  [SAS/STAT® 13.1 User's Guide The GENMOD Procedure.](https://support.sas.com/documentation/onlinedoc/stat/131/genmod.pdf)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}