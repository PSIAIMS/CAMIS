{
  "hash": "6db21600b6ee0345e4e10fadcea22a6e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"<SAS> <Tobit Regression>\"\n---\n\n\n\n# Tobit regression\n\n## Tobit model\n\nCensoring occurs when data on the dependent variable is only partially known. For example, in virology, sample results could be below the lower limit of detection (eg, 100 copies/mL) and in such a case we only know that the sample result is <100 copies/mL, but we don't know the exact value.\n\nLet $y^{*}$ be the the true underlying latent variable, and $y$ the observed variable. We discuss here censoring on the left:\n\n$$\ny =\n\\begin{cases}\n y^{*}, & y^{*} > \\tau  \\\\\n \\tau, & y^{*} \\leq \\tau\n \\end{cases}       \n$$\nWe consider tobit regression with a censored normal distribution. The model equation is\n$$\ny_{i}^{*} = X_{i}\\beta + \\epsilon_{i} \n$$\nwith $\\epsilon_{i} \\sim N(0,\\sigma^2)$. But we only observe $y = max(\\tau, y^{*})$.\nThe tobit model uses maximum likelihood estimation (for details see for example Breen, 1996). It is important to note that $\\beta$ estimates the effect of $x$ on the latent variable $y^{*}$, and not on the observed value $y$.\n\n\n## Data used\n\nWe assume two equally sized groups (n=10 in each group). The data is censored on the left at a value of $\\tau=8.0$.\nIn group A 4/10 records are censored, and 1/10 in group B.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata dat_used;\n\tinput ID$ ARM$ Y CENS;\n\tcards;\n  001 A 8.0 1 \n  002 A 8.0 1\n  003 A 8.0 1\n  004 A 8.0 1\n  005 A 8.9 0\n  006 A 9.5 0\n  007 A 9.9 0\n  008 A 10.3 0\n  009 A 11.0 0\n  010 A 11.2 0\n  011 B 8.0 1 \n  012 B 9.2 0\n  013 B 9.9 0\n  014 B 10.0 0\n  015 B 10.6 0\n  016 B 10.6 0\n  017 B 11.3 0\n  018 B 11.8 0\n  019 B 12.9 0\n  020 B 13.0 0\n\t;\nrun;\n```\n:::\n\n\n\n\n## Example Code using SAS\n\nThe analysis will be based on a Tobit analysis of variance with $Y$, rounded to 1 decimal places, as dependent variable and study group as a fixed covariate. A normally distributed error term will be used. Values will be left censored at the value 8.0.\n\nFirst a data manipulation step needs to be performed in which the censored values are set to missing for a new variable called *lower*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata dat_used;\n\tset dat_used;\n\tif Y <= 8.0 then lower=.; else lower=Y;\nrun;\n```\n:::\n\n\n\n\nThe data are sorted to make sure the intercept will correspond to the mean of ARM A.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproc sort data=dat_used;\n\tby descending ARM;\nrun;\n```\n:::\n\n\n\n\nThe **LIFEREG** procedure is used for tobit regression. The following model syntax is used:\n<br>\n  MODEL (lower,upper)= effects / options ;\n<br>\nHere, if the *lower* value is missing, then the *upper* value is used as a left-censored value.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproc lifereg data=dat_used order=data;\n\tclass ARM;\n\tmodel (lower, Y) = ARM / d=normal;\n\tlsmeans ARM /cl alpha=0.05;\n\testimate 'Contrast B-A' ARM 1 -1 / alpha=0.05;\nrun;\n```\n:::\n\n\n\n\nThe fit statistics, type 3 analysis of effects and parameter estimated are shown here. The output provides an estimate of difference between groups A and B (B-A), namely 1.8225 (se=0.8061). The presented p-value is a two-sided p-value based on the Z-test. The scale parameter is an estimate for $\\sigma$.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/tobit/SAS_tobit_1.PNG){fig-align='center' width=100%}\n:::\n:::\n\n\n\nThe p-value and confidence intervals of the contrast B-A are shown here. The p-value is the same as above.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/tobit/SAS_tobit_2.PNG){fig-align='center' width=80%}\n:::\n:::\n\n\n\n\n## Reference\n\nBreen, R. (1996). Regression models. SAGE Publications, Inc., https://doi.org/10.4135/9781412985611\n\nTobin, James (1958). \"Estimation of Relationships for Limited Dependent Variables\". Econometrica. 26 (1): 24-36. doi:10.2307/1907382\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}