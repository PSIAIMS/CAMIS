{
  "hash": "12aa44f47adb59f2a7e940e5802a727c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Wilcoxon signed-rank test in SAS & StatXact®\"\n---\n\n\n\n\n### **Introduction**\n\nSimilarily to what has been presented in R, we will explore the options of Wilcoxon Signed-Rank test that are avialable in SAS & StatXact.We will consider case with N\\>=20 or N\\<20 and without or with ties. For more information how to perform this analysis in R go [here](../R/wilcoxonsr_hodges_lehman.qmd)\n\n### Data {.unnumbered}\n\nAnalysis was be conducted on the same example dataset as in R.\n\nAgain, wilcoxon signed rank test was applied to analyse the time to return to baseline FEV1 post-mannitol challenge 2. \n\n## Analysis in SAS {.unnumbered}\n\n### Dataset without ties and N > 20 {.unnumbered}\n\nLet's consider a case where the dataset has no ties and N (number of observations) = 240.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata TTR;\n  set TTR;\n  diff = TRT_B - TRT_A;\nrun;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/wilcoxonsr/wsr_data.PNG){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\nIn SAS Wilcoxon Signed-Rank test is available using PROC UNIVARIATE.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproc univariate data=TTR\n\talpha=0.1;\n\tvar diff;\nrun;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/wilcoxonsr/wsr_240.PNG){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n### Dataset without ties and N≤20 {.unnumbered}\n\nNow let's consider a smaller dataset, created by selecting first 19 observations from our main data.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata TTR_19;\n    set TTR;\n    if _N_ <= 19;\nrun;\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nproc univariate data=TTR_19\n\talpha=0.1;\n\tvar diff;\nrun;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/wilcoxonsr/wsr_19.PNG){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n### Important notes on SAS {.unnumbered}\n\n-   Only PROC UNIVARIATE can be used in SAS to perform Wilcoxon Signed-Rank test. SAS documentation details are [here](https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.5/procstat/procstat_univariate_syntax01.htm).\n-   In regards to Wilcoxon S-R test, SAS provides only p value \n-   Hodges-Lehmann estimator or CI are not available and have to be implemented manually\n-   Provided p value is based on Signed Rank (S) statistic (modification of a common T+). Details are [here](https://blogs.sas.com/content/iml/2023/07/19/wilcoxon-signed-rank.html)\n-   SAS computes exact p values only for N ≤ 20. For larger samples uses an asymptotic t-Student distribution of the test statistic. For more information how the p value is calculated go [here](https://support.sas.com/documentation/cdl/en/procstat/63104/HTML/default/viewer.htm#procstat_univariate_sect029.htm)\n-   PROC UNIVARIATE apart from performing Wilcoxon S-R test presents as well basic statistical measures of variability and location, e.g median. The given median is not a \"pseudo-median\" (median of the Walsh averages), it is a \"normal\" median of the considered variable.\n-   Using CIQUANTNORMAL option we can get confidence limits for quantiles based on normal distribution. There are 5 different definitions for calculation quantiles  available. See details from the SAS documentation [here](https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.5/procstat/procstat_univariate_details14.htm). It is important to note, those are not confidence intervals of estimator.\n\n### Approach to 0s and ties in SAS {.unnumbered}\n-   In SAS all the 0 differences are disregarded (Hollander and Wolfe, 1973). The sample size N is reduced to reflect the number of discarded zeros. \n-   Tied differences are given an average of the ranks. Statistic S is updated accordingly following Sprent algorythm (Sprent, 1993).\n\n## Analysis in StatXact® {.unnumbered}\nStatXact® PROCs for SAS users is a clinical trial analysis software from Cytel for exact statistics. Package includes more than 150 procedures for exact inference statistical data and power analysis.\n \n \n### Dataset without ties and N > 20 {.unnumbered}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n/* Wilxocon S-R test - p values */\nPROC PAIRED DATA=WilcoxonSignedRank_TTR\nALPHA=0.9;\nWI/EX;\nPOPS TRT_B - TRT_A;\nRUN;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/wilcoxonsr/wsrSX_240a.PNG){fig-align='center' width=75%}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n/* Wilcoxon S-R - H-L estimator and CI */\nPROC PAIRED DATA=WilcoxonSignedRank_TTR \nALPHA=0.9;\nHL/EX;\nPOPS TRT_B - TRT_A;\nRUN;\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](../images/wilcoxonsr/wsrSX_240b.PNG){fig-align='center' width=75%}\n:::\n:::\n\n\n\n\n### Important notes on StatXact® {.unnumbered}\n-   Only PROC PAIRED can be used in StatXact to perform Wilcoxon Signed-Rank test\n-   Follows Sprent (1993) approach for Wilcoxon Signed-Rank test and Lehmann (1975) for H-L estimate and CI\n-   Provides exact/non-exact p values, (exact) H-L estimator and exact/non-exact CIs\n-   p value is based on a common T+ statistic (sum of ranks of the positive differences)\n\n\n### Approach to 0s and ties in StatXact® {.unnumbered}\n-   Using ZEROS option we can compute H-L estimate including all differences, but by default 0s are excluded.\n-   Tied differences are given an average of the ranks. Statistic S is updated accordingly following Sprent algorythm (Sprent, 1993).\n",
    "supporting": [
      "wilcoxonsr_HL_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}