{
  "hash": "6af219c958c61ecae9cfbb005fb0b2c9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"CMH Test\"\n---\n\n\n\n# Cochran-Mantel-Haenszel Test\n\nThe CMH procedure tests for conditional independence in partial contingency tables for a 2 x 2 x K design. However, it can be generalized to tables of X x Y x K dimensions.\n\n## Available R packages\n\nWe did not find any R package that delivers all the same measures as SAS at once. Therefore, we tried out multiple packages:\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"lajsdndwjo\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#lajsdndwjo table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#lajsdndwjo thead, #lajsdndwjo tbody, #lajsdndwjo tfoot, #lajsdndwjo tr, #lajsdndwjo td, #lajsdndwjo th {\n  border-style: none;\n}\n\n#lajsdndwjo p {\n  margin: 0;\n  padding: 0;\n}\n\n#lajsdndwjo .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#lajsdndwjo .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#lajsdndwjo .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#lajsdndwjo .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#lajsdndwjo .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#lajsdndwjo .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#lajsdndwjo .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#lajsdndwjo .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#lajsdndwjo .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#lajsdndwjo .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#lajsdndwjo .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#lajsdndwjo .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#lajsdndwjo .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#lajsdndwjo .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#lajsdndwjo .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lajsdndwjo .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#lajsdndwjo .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#lajsdndwjo .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#lajsdndwjo .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lajsdndwjo .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#lajsdndwjo .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lajsdndwjo .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#lajsdndwjo .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lajsdndwjo .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#lajsdndwjo .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#lajsdndwjo .gt_left {\n  text-align: left;\n}\n\n#lajsdndwjo .gt_center {\n  text-align: center;\n}\n\n#lajsdndwjo .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#lajsdndwjo .gt_font_normal {\n  font-weight: normal;\n}\n\n#lajsdndwjo .gt_font_bold {\n  font-weight: bold;\n}\n\n#lajsdndwjo .gt_font_italic {\n  font-style: italic;\n}\n\n#lajsdndwjo .gt_super {\n  font-size: 65%;\n}\n\n#lajsdndwjo .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#lajsdndwjo .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#lajsdndwjo .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#lajsdndwjo .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#lajsdndwjo .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#lajsdndwjo .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#lajsdndwjo .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#lajsdndwjo .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#lajsdndwjo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Package\">Package</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"General-Association\">General Association</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Row-Means-Differ\">Row Means Differ</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Nonzero-Correlation\">Nonzero Correlation</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"M-H-Odds-Ratio\">M-H Odds Ratio</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Homogeneity-Test\">Homogeneity Test</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Note\">Note</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Package\" class=\"gt_row gt_left\">stats::mantelhaen.test()</td>\n<td headers=\"General Association\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"Row Means Differ\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"Nonzero Correlation\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"M-H Odds Ratio\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"Homogeneity Test\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"Note\" class=\"gt_row gt_left\">Works well for 2x2xK</td></tr>\n    <tr><td headers=\"Package\" class=\"gt_row gt_left\">vcdExtra::CMHtest()</td>\n<td headers=\"General Association\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"Row Means Differ\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"Nonzero Correlation\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"M-H Odds Ratio\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"Homogeneity Test\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"Note\" class=\"gt_row gt_left\">Problems with sparsity, potential bug</td></tr>\n    <tr><td headers=\"Package\" class=\"gt_row gt_left\">epiDisplay::mhor()</td>\n<td headers=\"General Association\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"Row Means Differ\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"Nonzero Correlation\" class=\"gt_row gt_left\">❌</td>\n<td headers=\"M-H Odds Ratio\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"Homogeneity Test\" class=\"gt_row gt_left\">✅</td>\n<td headers=\"Note\" class=\"gt_row gt_left\">OR are limited to 2x2xK design</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Data used\n\nWe will use the CDISC Pilot data set, which is publicly available on the PHUSE Test Data Factory repository. This data set served as the basis of the examples to follow.\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n  X      STUDYID SITEID SITEGR1     USUBJID     TRTSDT     TRTEDT\n1 1 CDISCPILOT01    701     701 01-701-1015 2014-01-02 2014-07-02\n2 2 CDISCPILOT01    701     701 01-701-1023 2012-08-05 2012-09-01\n3 3 CDISCPILOT01    701     701 01-701-1028 2013-07-19 2014-01-14\n4 4 CDISCPILOT01    701     701 01-701-1033 2014-03-18 2014-03-31\n5 5 CDISCPILOT01    701     701 01-701-1034 2014-07-01 2014-12-30\n6 6 CDISCPILOT01    701     701 01-701-1047 2013-02-12 2013-03-09\n                  TRTP TRTPN AGE AGEGR1 AGEGR1N  RACE RACEN SEX ITTFL EFFFL\n1              Placebo     0  63    <65       1 WHITE     1   F     Y     Y\n2              Placebo     0  64    <65       1 WHITE     1   M     Y     Y\n3 Xanomeline High Dose    81  71  65-80       2 WHITE     1   M     Y     Y\n4  Xanomeline Low Dose    54  74  65-80       2 WHITE     1   M     Y     Y\n5 Xanomeline High Dose    81  77  65-80       2 WHITE     1   F     Y     Y\n6              Placebo     0  85    >80       3 WHITE     1   F     Y     Y\n  COMP24FL AVISIT AVISITN             VISIT VISITNUM ADY        ADT  PARAMCD\n1        Y Week 8       8            WEEK 8        8  63 2014-03-05 CIBICVAL\n2        N Week 8       8            WEEK 4        5  29 2012-09-02 CIBICVAL\n3        Y Week 8       8            WEEK 8        8  54 2013-09-10 CIBICVAL\n4        N Week 8       8            WEEK 4        5  28 2014-04-14 CIBICVAL\n5        Y Week 8       8            WEEK 8        8  57 2014-08-26 CIBICVAL\n6        N Week 8       8 AMBUL ECG REMOVAL        6  46 2013-03-29 CIBICVAL\n        PARAM PARAMN AVAL ANL01FL DTYPE AWRANGE AWTARGET AWTDIFF AWLO AWHI  AWU\n1 CIBIC Score      1    4       Y    NA    2-84       56       7    2   84 DAYS\n2 CIBIC Score      1    3       Y    NA    2-84       56      27    2   84 DAYS\n3 CIBIC Score      1    4       Y    NA    2-84       56       2    2   84 DAYS\n4 CIBIC Score      1    4       Y    NA    2-84       56      28    2   84 DAYS\n5 CIBIC Score      1    4       Y    NA    2-84       56       1    2   84 DAYS\n6 CIBIC Score      1    4       Y    NA    2-84       56      10    2   84 DAYS\n  QSSEQ\n1  6001\n2  6001\n3  6001\n4  6001\n5  6001\n6  6001\n```\n\n\n:::\n:::\n\n\n\n## Example Code\n\n### Base R \n\nThis is included in a base installation of R, as part of the stats package. Requires inputting data as a *table* or as *vectors*. Two examples 2x2x2 examples: X=2 treatments, Y=Sex (M/F), controlling for 2 age groups and 3x2x3 example X=3 treatments, Y=Sex (M/F), controlling for 3 age groups.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#2x2x2 example\ndata2 <- data %>% \n         filter(TRTPN !=\"54\" & AGEGR1 !=\">80\")\nmantelhaen.test(x = data2$TRTP, y = data2$SEX, z = data2$AGEGR1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tMantel-Haenszel chi-squared test with continuity correction\n\ndata:  data2$TRTP and data2$SEX and data2$AGEGR1\nMantel-Haenszel X-squared = 0.076264, df = 1, p-value = 0.7824\nalternative hypothesis: true common odds ratio is not equal to 1\n95 percent confidence interval:\n 0.5671347 2.5129874\nsample estimates:\ncommon odds ratio \n         1.193818 \n```\n\n\n:::\n\n```{.r .cell-code}\n#3x2x3 example\nmantelhaen.test(x = data$TRTP, y = data$SEX, z = data$AGEGR1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tCochran-Mantel-Haenszel test\n\ndata:  data$TRTP and data$SEX and data$AGEGR1\nCochran-Mantel-Haenszel M^2 = 2.482, df = 2, p-value = 0.2891\n```\n\n\n:::\n:::\n\n\n\n### vcdExtra\n\nThe vcdExtra package provides results for the generalized CMH test, for each of the three model it outputs the Chi-square value and the respective p-values. Flexible data input methods available: *table* or *formula* (aggregated level data in a data frame).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vcdExtra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: vcd\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: grid\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: gnm\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'vcdExtra'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    summarise\n```\n\n\n:::\n\n```{.r .cell-code}\n# Formula: Freq ~ X + Y | K\nCMHtest(Freq ~ TRTP + SEX | AGEGR1 , data=data, overall=TRUE) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`AGEGR1:<65`\nCochran-Mantel-Haenszel Statistics for TRTP by SEX \n\tin stratum AGEGR1:<65 \n\n                 AltHypothesis   Chisq Df    Prob\ncor        Nonzero correlation 0.33168  1 0.56467\nrmeans  Row mean scores differ 1.52821  2 0.46575\ncmeans  Col mean scores differ 0.33168  1 0.56467\ngeneral    General association 1.52821  2 0.46575\n\n\n$`AGEGR1:>80`\nCochran-Mantel-Haenszel Statistics for TRTP by SEX \n\tin stratum AGEGR1:>80 \n\n                 AltHypothesis   Chisq Df    Prob\ncor        Nonzero correlation 0.39433  1 0.53003\nrmeans  Row mean scores differ 3.80104  2 0.14949\ncmeans  Col mean scores differ 0.39433  1 0.53003\ngeneral    General association 3.80104  2 0.14949\n\n\n$`AGEGR1:65-80`\nCochran-Mantel-Haenszel Statistics for TRTP by SEX \n\tin stratum AGEGR1:65-80 \n\n                 AltHypothesis   Chisq Df    Prob\ncor        Nonzero correlation 0.52744  1 0.46768\nrmeans  Row mean scores differ 0.62921  2 0.73008\ncmeans  Col mean scores differ 0.52744  1 0.46768\ngeneral    General association 0.62921  2 0.73008\n\n\n$ALL\nCochran-Mantel-Haenszel Statistics for TRTP by SEX \n\tOverall tests, controlling for all strata \n\n                 AltHypothesis      Chisq Df    Prob\ncor        Nonzero correlation 0.00086897  1 0.97648\nrmeans  Row mean scores differ      2.482  2 0.28909\ncmeans  Col mean scores differ 0.00086897  1 0.97648\ngeneral    General association      2.482  2 0.28909\n```\n\n\n:::\n:::\n\n\n\n### epiDisplay\n\nTo get the M-H common odds ratio and the homogeneity test, the epiDisplay package can be used.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(epiDisplay) \nmhor(x,y,k, graph = FALSE)\n```\n:::\n\n\n\n#### Forked Version - Solution for sparse data\n\nTo tackle the [issue with sparse data](https://github.com/friendly/vcdExtra/issues/3) it is recommended that a use of `solve()` is replaced with `MASS::ginv`. This was implemented in the forked version of vcdExtra which can be installed from here:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github(\"mstackhouse/vcdExtra\")\n```\n:::\n\n\n\nHowever, also the forked version for the vcdExtra package works only until a certain level of sparsity. In case of our data, it still works if the data are stratified by the pooled Site ID (SITEGR1 - 11 unique values) whereas using the unpooled Site ID (SITEID - 17 unique values) also throws an error. Note: this version is not up to date and sometimes calculates degrees of freedom incorrectly.\n\n# References\n\nAccessible Summary: https://online.stat.psu.edu/stat504/lesson/4/4.4\n\nAn Introduction to Categorical Data Analysis 2nd Edition (Agresti): http://users.stat.ufl.edu/\\~aa/\n\nOriginal Paper 1: https://doi.org/10.2307%2F3001616\n\nOriginal Paper 2: https://doi.org/10.1093/jnci/22.4.719\n",
    "supporting": [
      "cmh_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}