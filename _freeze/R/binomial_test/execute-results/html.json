{
  "hash": "c15218026519e565af5b7801d75e55ca",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Binomial Test\"\n---\n\n\n\nThe statistical test used to determine whether the proportion in a binary outcome experiment is equal to a specific value. It is appropriate when we have a small sample size and want to test the success probability $p$ against a hypothesized value $p_0$.\n\n## Creating a sample dataset\n\n-   We will generate a dataset where we record the outcomes of 1000 coin flips.\n\n-   We will use the `binom.test` function to test if the proportion of heads is significantly different from 0.5.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(19)\ncoin_flips <- sample(c(\"H\", \"T\"), size = 1000, replace = T, prob = c(0.5, 0.5))\n```\n:::\n\n\n\nNow, we will count the heads and tails and summarize the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# heads\nheads_count <- sum(coin_flips == \"H\")\nheads_count\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 513\n```\n\n\n:::\n\n```{.r .cell-code}\n# tails\ntails_count <- sum(coin_flips == \"T\")\ntails_count\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 487\n```\n\n\n:::\n\n```{.r .cell-code}\n# total\ntotal_flips <- length(coin_flips)\ntotal_flips\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1000\n```\n\n\n:::\n:::\n\n\n\n## Conducting Binomial Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom_test_result <- stats::binom.test(heads_count, total_flips, p = 0.5)\nbinom_test_result\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  heads_count and total_flips\nnumber of successes = 513, number of trials = 1000, p-value = 0.4292\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.4815213 0.5444020\nsample estimates:\nprobability of success \n                 0.513 \n```\n\n\n:::\n:::\n\n\n\n### Results:\n\nThe output has a p-value 0.4292098 $> 0.05$ (chosen level of significance). Hence, we fail to reject the null hypothesis and conclude that the **coin is fair**.\n\n# Example of Clinical Trial Data\n\nWe load the `lung` dataset from `survival` package. We want to test if the proportion of patients with survival status 1 (dead) is significantly different from a hypothesized proportion (e.g. 50%)\n\nWe will calculate number of deaths and total number of patients.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival)\nattach(lung)\n\n# deaths\nnum_deaths <- sum(lung$status == 1)\nnum_deaths\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 63\n```\n\n\n:::\n\n```{.r .cell-code}\n# total patients\ntotal_pat <- nrow(lung)\ntotal_pat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 228\n```\n\n\n:::\n:::\n\n\n\n## Conduct the Binomial Test\n\nWe will conduct the Binomial test and hypothesize that the proportin of death should be 19%.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom_test <- stats::binom.test(num_deaths, total_pat, p = 0.19)\nbinom_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  num_deaths and total_pat\nnumber of successes = 63, number of trials = 228, p-value = 0.001683\nalternative hypothesis: true probability of success is not equal to 0.19\n95 percent confidence interval:\n 0.2193322 0.3392187\nsample estimates:\nprobability of success \n             0.2763158 \n```\n\n\n:::\n:::\n\n\n\n## Results:\n\nThe output has a p-value 0.0016829 $< 0.05$ (chosen level of significance). Hence, we reject the null hypothesis and conclude that **the propotion of death is significantly different from 19%**.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}