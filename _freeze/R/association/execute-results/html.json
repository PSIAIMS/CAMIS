{
  "hash": "079b2c4f423a3e5808dc1e95ae0f8a4a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Association Analysis for Count Data Using R\"\n---\n\n\n\n\n\nThe most commonly used association analysis methods for count data/contingency tables compare observed frequencies with those expected under the assumption of independence:\n\n$$\nX^2 = \\sum_{i=1}^k \\frac{(x_i-e_i)^2}{e_i}, \n$$ where $k$ is the number of contingency table cells.\n\n-   Chi-Squared test: test statistic is approximately equal to the theoretical chi-squared distribution. Chi-squared approximation is suitable when the expected values in all cells of the contingency table are above 5.\n\n-   Fisher exact test: test of independence if cell frequencies are small. Although in practice it is employed for small sample sizes, the test is valid for all sample sizes.\n\nOther measures for the correlation of two continuous variables are:\n\n-   Pearson correlation coefficient\n\n-   Spearman correlation coefficient\n\n-   Kendall's rank correlation\n\n# Example: Lung Cancer Data\n\n*Data source:* *Loprinzi CL. Laurie JA. Wieand HS. Krook JE. Novotny PJ. Kugler JW. Bartel J. Law M. Bateman M. Klatt NE. et al. Prospective evaluation of prognostic variables from patient-completed questionnaires. North Central Cancer Treatment Group. Journal of Clinical Oncology. 12(3):601-7, 1994.*\n\nSurvival in patients with advanced lung cancer from the North Central Cancer Treatment Group. Performance scores rate how well the patient can perform usual daily activities.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival) \nglimpse(lung)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 228\nColumns: 10\n$ inst      <dbl> 3, 3, 3, 5, 1, 12, 7, 11, 1, 7, 6, 16, 11, 21, 12, 1, 22, 16…\n$ time      <dbl> 306, 455, 1010, 210, 883, 1022, 310, 361, 218, 166, 170, 654…\n$ status    <dbl> 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ age       <dbl> 74, 68, 56, 57, 60, 74, 68, 71, 53, 61, 57, 68, 68, 60, 57, …\n$ sex       <dbl> 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, …\n$ ph.ecog   <dbl> 1, 0, 0, 1, 0, 1, 2, 2, 1, 2, 1, 2, 1, NA, 1, 1, 1, 2, 2, 1,…\n$ ph.karno  <dbl> 90, 90, 90, 90, 100, 50, 70, 60, 70, 70, 80, 70, 90, 60, 80,…\n$ pat.karno <dbl> 100, 90, 90, 60, 90, 80, 60, 80, 80, 70, 80, 70, 90, 70, 70,…\n$ meal.cal  <dbl> 1175, 1225, NA, 1150, NA, 513, 384, 538, 825, 271, 1025, NA,…\n$ wt.loss   <dbl> NA, 15, 15, 11, 0, 0, 10, 1, 16, 34, 27, 23, 5, 32, 60, 15, …\n```\n\n\n:::\n:::\n\n\n\n# $2\\times 2$ Contingency Table\n\nWe analyze the association between ECOG performance score (fully active vs any symptomatic patient) as rated by physician and weight loss (see `?lung` for details).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlung2 <- survival::lung %>% \n  mutate(\n    ecog_grp = factor(ph.ecog > 0, labels = c(\"fully active\", \"symptomatic\")), \n    wt_grp = factor(wt.loss > 0, labels = c(\"weight loss\", \"weight gain\"))\n  ) \n\n(tab <- table(x = lung2$ecog_grp, y = lung2$wt_grp))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              y\nx              weight loss weight gain\n  fully active          22          39\n  symptomatic           39         113\n```\n\n\n:::\n:::\n\n\n\n## Chi-Squared test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  tab\nX-squared = 1.8261, df = 1, p-value = 0.1766\n```\n\n\n:::\n:::\n\n\n\n## Fisher Exact Test\n\nFor $2 \\times 2$ contingency tables, p-values are obtained directly using the hypergeometric distribution.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher.test(tab)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  tab\np-value = 0.135\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n 0.8158882 3.2251299\nsample estimates:\nodds ratio \n  1.630576 \n```\n\n\n:::\n:::\n\n\n\n# Large Contingency Tables\n\nIn a second example, we analyze the association between ECOG and Karnofky performance scores, both rated by physician (see `?lung` for details).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(tab2 <- table(x = lung2$ph.ecog, y = lung2$ph.karno))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   y\nx   50 60 70 80 90 100\n  0  0  0  0  3 32  28\n  1  1  2  7 60 42   1\n  2  5 15 25  4  0   0\n  3  0  1  0  0  0   0\n```\n\n\n:::\n:::\n\n\n\n## Chi-Squared Test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tab2)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(tab2): Chi-squared approximation may be incorrect\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tab2\nX-squared = 260.76, df = 15, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\nThe warning means that the smallest expected frequencies is lower than 5. It is recommended to use the Fisher's exact test in this case.\n\n## Fisher Exact Test\n\nFor contingency tables larger than $2 \\times 2$, p-values are based on simulations, which might require a lot of time (see `?fisher.test` for details).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfisher.test(tab2, simulate.p.value=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data with simulated p-value (based on\n\t2000 replicates)\n\ndata:  tab2\np-value = 0.0004998\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}