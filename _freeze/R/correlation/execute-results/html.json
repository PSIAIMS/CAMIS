{
  "hash": "13356c51b533d09eecb5d92d4d269066",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Correlation Analysis Using R\"\n---\n\n\n\n\n\nThe most commonly used correlation analysis methods in clinical trials include:\n\n-   Pearson correlation coefficient: product moment coefficient between two continuous variables, measuring linear associations.\n\n    \\\n    $$\n    r = \\frac{\\sum_{i=1}^n (x_i - m_x)(y_i - m_y)}{\\sqrt{\\sum_{i=1}^n (x_i - m_x)^2\\sum_{i=1}^n (y_i - m_y)^2}},$$\n\n    where $x$ and $y$ are observations from two continuous variables of length $n$ and $m_x$ and $m_y$ are their respective means.\n\n-   Spearman correlation coefficient: rank correlation defined through the scaled sum of the squared values of the difference between ranks of two continuous variables.\n\n    $$\n    \\rho = \\frac{\\sum_{i=1}^n (x'_i - m_{x'})(y'_i - m_{y'})}{\\sqrt{\\sum_{i=1}^n (x'_i - m_{x'})^2\\sum_{i=1}^n(y'_i - m_{y'})^2}},\n    $$\n\n    where $x'$ and $y'$ are the ranks of $x$ and $y$ and $m_{x'}$ and $m_{y'}$ are the mean ranks of $x$ and $y$, respectively.\n\n-   Kendall's rank correlation: rank correlation based on the number of inversions in one ranking as compared with another.\n\n    $$\n    \\tau = \\frac{n_c - n_d}{\\frac{1}{2}\\,n\\,(n-1)},\n    $$\n\n    where $n_c$ is the total number of concordant pairs, $n_d$ is the total number of disconcordant pairs and $n$ the total size of observations in $x$ and $y$.\n\nOther association measures are available for count data/contingency tables comparing observed frequencies with those expected under the assumption of independence\n\n-   Fisher exact test\n\n-   Chi-Square statistic\n\n# Example: Lung Cancer Data\n\n*Data source:* *Loprinzi CL. Laurie JA. Wieand HS. Krook JE. Novotny PJ. Kugler JW. Bartel J. Law M. Bateman M. Klatt NE. et al. Prospective evaluation of prognostic variables from patient-completed questionnaires. North Central Cancer Treatment Group. Journal of Clinical Oncology. 12(3):601-7, 1994.*\n\nSurvival in patients with advanced lung cancer from the North Central Cancer Treatment Group. Performance scores rate how well the patient can perform usual daily activities.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival)\n\nglimpse(lung)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 228\nColumns: 10\n$ inst      <dbl> 3, 3, 3, 5, 1, 12, 7, 11, 1, 7, 6, 16, 11, 21, 12, 1, 22, 16…\n$ time      <dbl> 306, 455, 1010, 210, 883, 1022, 310, 361, 218, 166, 170, 654…\n$ status    <dbl> 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ age       <dbl> 74, 68, 56, 57, 60, 74, 68, 71, 53, 61, 57, 68, 68, 60, 57, …\n$ sex       <dbl> 1, 1, 1, 1, 1, 1, 2, 2, 1, 1, 1, 2, 2, 1, 1, 1, 1, 1, 2, 1, …\n$ ph.ecog   <dbl> 1, 0, 0, 1, 0, 1, 2, 2, 1, 2, 1, 2, 1, NA, 1, 1, 1, 2, 2, 1,…\n$ ph.karno  <dbl> 90, 90, 90, 90, 100, 50, 70, 60, 70, 70, 80, 70, 90, 60, 80,…\n$ pat.karno <dbl> 100, 90, 90, 60, 90, 80, 60, 80, 80, 70, 80, 70, 90, 70, 70,…\n$ meal.cal  <dbl> 1175, 1225, NA, 1150, NA, 513, 384, 538, 825, 271, 1025, NA,…\n$ wt.loss   <dbl> NA, 15, 15, 11, 0, 0, 10, 1, 16, 34, 27, 23, 5, 32, 60, 15, …\n```\n\n\n:::\n:::\n\n\n\n# Overview\n\n`cor()` computes the correlation coefficient between continuous variables `x` and `y`, where `method` chooses which correlation coefficient is to be computed (default: `\"pearson\"`, `\"kendall\"`, or `\"spearman\"`).\n\n`cor.test()` calulates the test for association between paired samples, using one of Pearson's product moment correlation coefficient, Kendall's $\\tau$ or Spearman's $\\rho$. Besides the correlation coefficient itself, it provides additional information.\n\nMissing values are assumed to be missing completely at random (MCAR). Different strategies are available, see `?cor` for details.\n\n# Pearson Correlation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats::cor.test(x = lung$age, y = lung$meal.cal, method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  lung$age and lung$meal.cal\nt = -3.1824, df = 179, p-value = 0.001722\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.3649503 -0.0885415\nsample estimates:\n       cor \n-0.2314107 \n```\n\n\n:::\n:::\n\n\n\n# Spearman Correlation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats::cor.test(x = lung$age, y = lung$meal.cal, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in cor.test.default(x = lung$age, y = lung$meal.cal, method =\n\"spearman\"): Cannot compute exact p-value with ties\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tSpearman's rank correlation rho\n\ndata:  lung$age and lung$meal.cal\nS = 1193189, p-value = 0.005095\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.2073639 \n```\n\n\n:::\n:::\n\n\n\nNote: Exact p-values require unanimous ranks.\n\n# Kendall's rank correlation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats::cor.test(x = lung$age, y = lung$meal.cal, method = \"kendall\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKendall's rank correlation tau\n\ndata:  lung$age and lung$meal.cal\nz = -2.7919, p-value = 0.00524\nalternative hypothesis: true tau is not equal to 0\nsample estimates:\n       tau \n-0.1443877 \n```\n\n\n:::\n:::\n\n\n\n# Interpretation of correlation coefficients\n\nCorrelation coefficient is comprised between -1 and 1:\n\n-   $-1$ indicates a strong negative correlation\n\n-   $0$ means that there is no association between the two variables\n\n-   $1$ indicates a strong positive correlation\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}