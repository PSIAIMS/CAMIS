{
  "hash": "95381b7b1b29c8f4dfbee846e4825255",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Marginal Homogeneity Tests\"\n---\n\n\n\nThis page is solely based on **coin** package documentation including data samples which are generated inline.\n\n`coin::mh_test()` provides the McNemar test, the Cochran Q test, the Stuart(-Maxwell) test and the Madansky test of interchangeability. A general description of these methods is given by Agresti (2002).\n\nThe null hypothesis of marginal homogeneity is tested. If formula interface is used, the response variable and the measurement conditions are given by `y` and `x`, respectively, and `block` is a factor where each level corresponds to exactly one subject with repeated measurements: `coin::mh_test(y ~ x | block, data, subset = NULL, ...)`. We can also directly pass an object of class `\"table\"`.\n\n`coin::mh_test()` computes different tests depending on `x` and `y`:\n\n-   McNemar test (McNemar, 1947) when both `y` and `x` are binary factors;\n\n-   Cochran Q test (Cochran, 1950) when `y` is a binary factor and `x` is a factor with an arbitrary number of levels;\n\n-   Stuart-Maxwell test (Stuart, 1955; Maxwell, 1970) when `y` is a factor with an arbitrary number of levels and `x` is a binary factor;\n\n-   Madansky test of interchangeability (Madansky, 1963), which implies marginal homogeneity, when both `y` and `x` are factors with an arbitrary number of levels.\n\nThe conditional null distribution of the test statistic is used to obtain p-values and an asymptotic approximation of the exact distribution is used by default (`distribution = \"asymptotic\"`). Alternatively, the distribution can be approximated via Monte Carlo resampling or computed exactly for univariate two-sample problems (McNemar test) by setting distribution to `\"approximate\"` or `\"exact\"`, respectively.\n\n## McNemar test\n\nFor more information on the McNemar see the [McNemarâ€™s test](https://psiaims.github.io/CAMIS/R/r_mcnemar.html) page.\n\n\n## Cochran Q test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Effectiveness of different media for the growth of diphtheria\n## Cochran (1950, Tab. 2)\ncases <- c(4, 2, 3, 1, 59)\nn <- sum(cases)\ncochran <- data.frame(\n  diphtheria = factor(\n    unlist(rep(\n      list(\n        c(1, 1, 1, 1),\n        c(1, 1, 0, 1),\n        c(0, 1, 1, 1),\n        c(0, 1, 0, 1),\n        c(0, 0, 0, 0)\n      ),\n      cases\n    ))\n  ),\n  media = factor(rep(LETTERS[1:4], n)),\n  case = factor(rep(seq_len(n), each = 4))\n)\n\nhead(cochran)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  diphtheria media case\n1          1     A    1\n2          1     B    1\n3          1     C    1\n4          1     D    1\n5          1     A    2\n6          1     B    2\n```\n\n\n:::\n\n```{.r .cell-code}\n## Asymptotic Cochran Q test (Cochran, 1950, p. 260)\ncoin::mh_test(\n  diphtheria ~ media | case,\n  data = cochran\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic Marginal Homogeneity Test\n\ndata:  diphtheria by media (A, B, C, D) \n\t stratified by case\nchi-squared = 8.0526, df = 3, p-value = 0.04494\n```\n\n\n:::\n\n```{.r .cell-code}\n## Approximative Cochran Q test\nmt <- coin::mh_test(\n  diphtheria ~ media | case,\n  data = cochran,\n  distribution = coin::approximate(nresample = 10000)\n)\ncoin::pvalue(mt) # standard p-value\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0548\n99 percent confidence interval:\n 0.04910088 0.06092753 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoin::midpvalue(mt) # mid-p-value\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0455\n99 percent confidence interval:\n 0.04034520 0.05108709 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoin::pvalue_interval(mt) # p-value interval\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   p_0    p_1 \n0.0362 0.0548 \n```\n\n\n:::\n\n```{.r .cell-code}\ncoin::size(mt, alpha = 0.05) # test size at alpha = 0.05 using the p-value\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0362\n```\n\n\n:::\n:::\n\n\n\n## Stuart-Maxwell test\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Opinions on Pre- and Extramarital Sex\n## Agresti (2002, p. 421)\nopinions <- c(\n  \"Always wrong\",\n  \"Almost always wrong\",\n  \"Wrong only sometimes\",\n  \"Not wrong at all\"\n)\n# fmt: skip\nPreExSex <- matrix(\n  c(144, 33, 84, 126,\n    2,  4, 14,  29,\n    0,  2,  6,  25,\n    0,  0,  1,   5),\n  nrow = 4,\n  dimnames = list(\n    \"Premarital Sex\" = opinions,\n    \"Extramarital Sex\" = opinions\n  )\n)\nPreExSex <- as.table(PreExSex)\n\nPreExSex\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                      Extramarital Sex\nPremarital Sex         Always wrong Almost always wrong Wrong only sometimes\n  Always wrong                  144                   2                    0\n  Almost always wrong            33                   4                    2\n  Wrong only sometimes           84                  14                    6\n  Not wrong at all              126                  29                   25\n                      Extramarital Sex\nPremarital Sex         Not wrong at all\n  Always wrong                        0\n  Almost always wrong                 0\n  Wrong only sometimes                1\n  Not wrong at all                    5\n```\n\n\n:::\n\n```{.r .cell-code}\n## Asymptotic Stuart test\ncoin::mh_test(PreExSex)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic Marginal Homogeneity Test\n\ndata:  response by\n\t conditions (Premarital.Sex, Extramarital.Sex) \n\t stratified by block\nchi-squared = 271.92, df = 3, p-value < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n## Asymptotic Stuart-Birch test\n## Note: response as ordinal\ncoin::mh_test(\n  PreExSex,\n  scores = list(response = 1:length(opinions))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic Marginal Homogeneity Test for Ordered Data\n\ndata:  response (ordered) by\n\t conditions (Premarital.Sex, Extramarital.Sex) \n\t stratified by block\nZ = 16.454, p-value < 2.2e-16\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n\n## Madansky test of interchangeability\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Vote intention\n## Madansky (1963, pp. 107-108)\n# fmt: skip\nvote <- array(\n    c(120, 1,  8, 2,   2,  1, 2, 1,  7,\n        6, 2,  1, 1, 103,  5, 1, 4,  8,\n       20, 3, 31, 1,   6, 30, 2, 1, 81),\n    dim = c(3, 3, 3),\n    dimnames = list(\n          \"July\" = c(\"Republican\", \"Democratic\", \"Uncertain\"),\n        \"August\" = c(\"Republican\", \"Democratic\", \"Uncertain\"),\n          \"June\" = c(\"Republican\", \"Democratic\", \"Uncertain\")\n    )\n)\nvote <- as.table(vote)\n\nvote\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n, , June = Republican\n\n            August\nJuly         Republican Democratic Uncertain\n  Republican        120          2         2\n  Democratic          1          2         1\n  Uncertain           8          1         7\n\n, , June = Democratic\n\n            August\nJuly         Republican Democratic Uncertain\n  Republican          6          1         1\n  Democratic          2        103         4\n  Uncertain           1          5         8\n\n, , June = Uncertain\n\n            August\nJuly         Republican Democratic Uncertain\n  Republican         20          1         2\n  Democratic          3          6         1\n  Uncertain          31         30        81\n```\n\n\n:::\n\n```{.r .cell-code}\n## Asymptotic Madansky test (Q = 70.77)\ncoin::mh_test(vote)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic Marginal Homogeneity Test\n\ndata:  response by\n\t conditions (July, August, June) \n\t stratified by block\nchi-squared = 70.763, df = 4, p-value = 1.565e-14\n```\n\n\n:::\n\n```{.r .cell-code}\n## Cross-over study\n## http://www.nesug.org/proceedings/nesug00/st/st9005.pdf (link is dead now)\n# fmt: skip\ndysmenorrhea <- array(\n  c(6, 2, 1,  3, 1, 0,  1, 2, 1,\n    4, 3, 0, 13, 3, 0,  8, 1, 1,\n    5, 2, 2, 10, 1, 0, 14, 2, 0),\n  dim = c(3, 3, 3),\n  dimnames =  list(\n    \"Placebo\" = c(\"None\", \"Moderate\", \"Complete\"),\n    \"Low dose\" = c(\"None\", \"Moderate\", \"Complete\"),\n    \"High dose\" = c(\"None\", \"Moderate\", \"Complete\")\n  )\n)\ndysmenorrhea <- as.table(dysmenorrhea)\n\ndysmenorrhea\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n, , High dose = None\n\n          Low dose\nPlacebo    None Moderate Complete\n  None        6        3        1\n  Moderate    2        1        2\n  Complete    1        0        1\n\n, , High dose = Moderate\n\n          Low dose\nPlacebo    None Moderate Complete\n  None        4       13        8\n  Moderate    3        3        1\n  Complete    0        0        1\n\n, , High dose = Complete\n\n          Low dose\nPlacebo    None Moderate Complete\n  None        5       10       14\n  Moderate    2        1        2\n  Complete    2        0        0\n```\n\n\n:::\n\n```{.r .cell-code}\n## Asymptotic Madansky-Birch test (Q = 53.76)\n## Note: response as ordinal\ncoin::mh_test(\n  dysmenorrhea,\n  scores = list(response = 1:3)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic Marginal Homogeneity Test for Ordered Data\n\ndata:  response (ordered) by\n\t conditions (Placebo, Low.dose, High.dose) \n\t stratified by block\nchi-squared = 53.762, df = 2, p-value = 2.117e-12\n```\n\n\n:::\n\n```{.r .cell-code}\n## Asymptotic Madansky-Birch test (Q = 47.29)\n## Note: response and measurement conditions as ordinal\ncoin::mh_test(\n  dysmenorrhea,\n  scores = list(response = 1:3, conditions = 1:3)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tAsymptotic Marginal Homogeneity Test for Ordered Data\n\ndata:  response (ordered) by\n\t conditions (Placebo < Low.dose < High.dose) \n\t stratified by block\nZ = 6.8764, p-value = 6.138e-12\nalternative hypothesis: two.sided\n```\n\n\n:::\n:::\n\n\n\n## Reference\n\nHothorn T, Hornik K, van de Wiel MA, Zeileis A (2006). A Lego system for conditional inference. The American Statistician, 60 (3), 257-263. doi:10.1198/000313006X118430 <https://doi.org/10.1198/000313006X118430>\n\nAgresti, A. (2002). Categorical Data Analysis, Second Edition. Hoboken, New Jersey: John Wiley & Sons.\n\nBirch, M. W. (1965). The detection of partial association, II: The general case. Journal of the Royal Statistical Society B 27(1), 111â€“124. doi:10.1111/j.2517-6161.1965.tb00593.x\n\nCochran, W. G. (1950). The comparison of percentages in matched samples. Biometrika 37(3/4), 256â€“266. doi:10.1093/biomet/37.3-4.256\n\nMadansky, A. (1963). Tests of homogeneity for correlated samples. Journal of the American Statistical Association 58(301), 97â€“119. doi:10.1080/01621459.1963.10500835\n\nMaxwell, A. E. (1970). Comparing the classification of subjects by two independent judges. British Journal of Psychiatry 116(535), 651â€“655. doi:10.1192/bjp.116.535.651\n\nMcNemar, Q. (1947). Note on the sampling error of the difference between correlated proportions or percentages. Psychometrika 12(2), 153â€“157. doi:10.1007/BF02295996\n\nStuart, A. (1955). A test for homogeneity of the marginal distributions in a two-way classification. Biometrika 42(3/4), 412â€“416. doi:10.1093/biomet/42.3-4.412\n\nWhite, A. A., Landis, J. R. and Cooper, M. M. (1982). A note on the equivalence of several marginal homogeneity test criteria for categorical data. International Statistical Review 50(1), 27â€“34. doi:10.2307/1402457\n\n::: {.callout-note collapse=\"true\" title=\"Session Info\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nâ”€ Session info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n setting  value\n version  R version 4.4.2 (2024-10-31)\n os       macOS Sequoia 15.6.1\n system   aarch64, darwin20\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/London\n date     2025-08-29\n pandoc   3.4 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)\n\nâ”€ Packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n ! package     * version date (UTC) lib source\n   codetools     0.2-20  2024-03-31 [2] CRAN (R 4.4.2)\n P coin          1.4-3   2023-09-27 [?] CRAN (R 4.4.0)\n   lattice       0.22-6  2024-03-20 [2] CRAN (R 4.4.2)\n P libcoin       1.0-10  2023-09-27 [?] CRAN (R 4.4.0)\n   MASS          7.3-61  2024-06-13 [2] CRAN (R 4.4.2)\n   Matrix        1.7-1   2024-10-18 [2] CRAN (R 4.4.2)\n P matrixStats   1.4.1   2024-09-08 [?] CRAN (R 4.4.1)\n P modeltools    0.2-23  2020-03-05 [?] CRAN (R 4.4.0)\n P multcomp      1.4-26  2024-07-18 [?] CRAN (R 4.4.0)\n P mvtnorm       1.3-1   2024-09-03 [?] CRAN (R 4.4.1)\n P sandwich      3.1-1   2024-09-15 [?] CRAN (R 4.4.1)\n P survival      3.7-0   2024-06-05 [?] CRAN (R 4.4.0)\n P TH.data       1.1-2   2023-04-17 [?] CRAN (R 4.4.0)\n P zoo           1.8-12  2023-04-13 [?] CRAN (R 4.4.0)\n\n [1] /Users/christinafillmore/Documents/GitHub/CAMIS/renv/library/macos/R-4.4/aarch64-apple-darwin20\n [2] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library\n\n P â”€â”€ Loaded and on-disk path mismatch.\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n```\n\n\n:::\n:::\n\n\n\n:::\n",
    "supporting": [
      "marginal_homogeneity_tests_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}