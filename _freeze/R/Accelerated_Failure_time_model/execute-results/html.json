{
  "hash": "d5613da481640e16d5cceac1597a236f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Accelerated Failure Time Model\"\nformat: html\neditor: visual\n---\n\n\n\nThe accelerated failure time model is a parametric survival analysis technique used to model the relationship between the time to event of interest (e.g., time to failure) and a set of predictor variables. It assumes that the covariates have a multiplicative effect on the time to the event. In other words, the time to event is accelerated or decelerated by a factor that depends on the values of the covariates.This differs from the Cox proportional hazards model, which assumes that covariates have a multiplicative effect on the hazard rate, not the time to the event.\n\n## Mathematical Expression\n\nMathematically, the AFT model can be expressed as:\n\n$\\log(T) = X\\beta + \\sigma\\varepsilon$\n\nWhere:\n\n-   T is the survival time\n\n-   log(T) is the logarithm of the survival time\n\n-   X is a matrix of predictor variables\n\n-   β is a vector of coefficients representing the effects of the predictor variables on the logarithm of the survival time\n\n-   σ is a scaler quantity representing the scale parameter, which influences the variability of the error term ε in the model.\n\n-   ε is the error term assumed to follow a specific distribution (e.g., normal distribution for log-normal, extreme value distribution for Weibull) that corresponds to the chosen parametric form of the model.\n\n## Example of AFT model using \"Log-Normal Distribution\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survival)\nattach(lung)\n# Fit an AFT model using lognormal distribution\nmodel_aft <- survreg(Surv(time, status) ~ age + sex + ph.ecog, data = lung, dist = \"lognormal\")\n# Model summary\nsummary(model_aft)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nsurvreg(formula = Surv(time, status) ~ age + sex + ph.ecog, data = lung, \n    dist = \"lognormal\")\n               Value Std. Error     z       p\n(Intercept)  6.49479    0.58276 11.14 < 2e-16\nage         -0.01918    0.00833 -2.30 0.02126\nsex          0.52195    0.15278  3.42 0.00063\nph.ecog     -0.35557    0.10331 -3.44 0.00058\nLog(scale)   0.02823    0.05596  0.50 0.61391\n\nScale= 1.03 \n\nLog Normal distribution\nLoglik(model)= -1146.9   Loglik(intercept only)= -1163.2\n\tChisq= 32.59 on 3 degrees of freedom, p= 3.9e-07 \nNumber of Newton-Raphson Iterations: 3 \nn=227 (1 observation deleted due to missingness)\n```\n\n\n:::\n:::\n\n\n\nThe summary output will provide the estimated coefficients, standard errors, and p-values for each predictor variable.\n\n## Acceleration Factor Calculation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute acceleration factor (exponentiated coefficients)\nacceleration_factor <- exp(coef(model_aft))\nacceleration_factor\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)         age         sex     ph.ecog \n661.6830913   0.9810009   1.6853157   0.7007762 \n```\n\n\n:::\n:::\n\n\n\n## Interpretation\n\n-   For age,acceleration factor $< 1$ indicates that for each one-unit increase in age, the survival time is slowed down by a factor of 0.98 (or a 2% decreasein survival time).\n-   For sex, acceleration factor $> 1$ indicates that males have 68% accelerated survival time.\n-   An acceleration factor of ph.ecog $< 1$ suggests a 30% decelerated survival time associated with ph.ecog.\n\n## Plotting AFT Model Graphically\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages({\nlibrary(survival)\nlibrary(survminer)\nlibrary(ggplot2)\n})\n\n# Fit the AFT model on the lung dataset\naft_model <- survreg(Surv(time, status) ~ age + sex + ph.ecog, data = lung, dist = \"lognormal\")\n\n# Create a new data frame with predicted survival times\ndf <- data.frame(time = lung$time, age = lung$age, sex = lung$sex, ph.ecog = lung$ph.ecog, status=lung$status)\ndf$surv_times <- predict(aft_model, newdata = df)\n\n# Plot the survival curves based on the AFT model\nggsurvplot(survfit(Surv(surv_times, status) ~ 1, data = df),\n           data = df, xlab = \"Time\", ylab = \"Survival Probability\")\n```\n\n::: {.cell-output-display}\n![](Accelerated_Failure_time_model_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nThe survival curve plotted based on the AFT model for the lung dataset illustrates how the probability of survival changes as time progresses, showing the impact of different covariate levels on survival probabilities.\n\n## Example of AFT model using \"Weibull Distribution\"\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit an AFT model using weibull distribution\nmodel_aft_wb <- survreg(Surv(futime, fustat) ~ age + resid.ds + rx, data = ovarian, dist = \"weibull\")\n# Model summary\nsummary(model_aft_wb)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nsurvreg(formula = Surv(futime, fustat) ~ age + resid.ds + rx, \n    data = ovarian, dist = \"weibull\")\n              Value Std. Error     z      p\n(Intercept) 10.5634     1.3810  7.65  2e-14\nage         -0.0661     0.0190 -3.48 0.0005\nresid.ds    -0.5002     0.3799 -1.32 0.1879\nrx           0.5152     0.3236  1.59 0.1114\nLog(scale)  -0.6577     0.2384 -2.76 0.0058\n\nScale= 0.518 \n\nWeibull distribution\nLoglik(model)= -87.9   Loglik(intercept only)= -98\n\tChisq= 20.17 on 3 degrees of freedom, p= 0.00016 \nNumber of Newton-Raphson Iterations: 6 \nn= 26 \n```\n\n\n:::\n:::\n\n\n\n## Acceleration Factor Calculation\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute acceleration factor (exponentiated coefficients)\nacceleration_factor_wb <- exp(coef(model_aft_wb))\nacceleration_factor_wb\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n (Intercept)          age     resid.ds           rx \n3.869157e+04 9.360366e-01 6.063911e-01 1.673914e+00 \n```\n\n\n:::\n:::\n\n\n\n## Interpretation\n\n-   For age, an acceleration factor of 0.93 indicates that for each one-unit increase in age, the survival time is decelerated by a factor of 0.93(or a 7% decrease in the survival time)\n\n-   For residual disease status, an acceleration factor of 0.60 suggests that a decrease in residual disease status is associated with a 40% decelerated survival time.\n\n-   an acceleration factor of 1.67 suggests a 67% accelerated survival time for patients receiving a different type of radiation therapy (rx = 2) compared to the reference group (rx = 1).\n\n## Survival Curve Plotting on 'Ovarian' Dataset\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit the AFT model (weibull distribution) on your data\nmodel_aft <- survreg(Surv(futime, fustat) ~ age + resid.ds + rx, data = ovarian, dist = \"weibull\")\n\n# Create survival curves for different levels of predictor variables\nplot_data <- with(ovarian, data.frame(age = seq(min(age), max(age), length.out = 100),\n                                      resid.ds = mean(resid.ds),\n                                      rx = mean(rx)))\n\n# Predict survival times based on the AFT model\nplot_data$survival <- predict(model_aft, newdata = plot_data)\n\n# Plot the survival curves\nggplot(plot_data, aes(x = age, y = survival, color = factor(rx), linetype = factor(rx))) +\n  geom_line() +\n  labs(x = \"Age\", y = \"Survival Probability\", color = \"Radiation Therapy\", linetype = \"Radiation Therapy\") +\n  scale_linetype_manual(values = c(\"solid\", \"dashed\", \"dotted\")) +\n  scale_color_manual(values = c(\"blue\", \"red\", \"green\"))\n```\n\n::: {.cell-output-display}\n![](Accelerated_Failure_time_model_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\nThe survival curve plotted based on the AFT model for the ovarian dataset how the probability of survival changes as age increases.\n\n## Conclusion\n\nIn AFT models, unlike Cox proportional hazards models, survival times follow an assumed parametric distribution (e.g., Weibull, log-logistic, log-normal), directly modelling the effect of covariates on the time scale.\n",
    "supporting": [
      "Accelerated_Failure_time_model_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}