{
  "hash": "12aa9ebc5477a2f4d94627a02ccc822c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Wilcoxon signed-rank test\"\n---\n\n\n\n### **Introduction**\n\nWilcoxon signed-rank test is a non-parametric test which is sometimes used instead of the paired Student's t-test when assumptions regarding a normal distribution are not valid. It is a rank test, designed for analyzing repeated measures or paired observations by a paired comparison (a type of location test) to assess whether their population means differ. Whilst it does not 'compare' means or medians for a set of paired data, it ranks the results on A and ranks the results on B, then compares if Prob(A\\>B) \\> Prob(B\\>A).\n\n*Ties* are when you have two observations with the same result. For example, in a 2-period cross-over study, you take the difference between result on Treatment A minus result on Treatment B and find that two or more subjects have the same difference.\n\nAdditionally, *\"0s\"* can cause some trouble as well. For example when the difference between result on Treatment A minus result on Treatment B equals 0.\n\n\n\n\n\n\n\n### Data {.unnumbered}\n\nAnalysis will be conducted on the example of anonymized data from 2-period, cross-over study comparing treatments A and B in patients with asthma and acute airway obstruction induced by repeated mannitol challenges.\n\nWilcoxon signed rank test was applied to analyse the time to return to baseline FEV1 post-mannitol challenge 2. Median difference, p value and 95% CI were provided using the Hodges-Lehmann estimate.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(blood_p)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  patient  sex agegrp bp_before bp_after\n1       1 Male  30-45   143.670  153.316\n2       2 Male  30-45   163.082  170.576\n3       3 Male  30-45   153.393  168.599\n4       4 Male  30-45   153.082  142.358\n5       5 Male  30-45   146.720  141.193\n6       6 Male  30-45   150.668  147.204\n```\n\n\n:::\n:::\n\n\n\n### Dataset without ties {.unnumbered}\n\nLet's consider a case where the dataset has no ties.\n\n### Available packages {.unnumbered}\n\nIn R Wilcoxon signed rank test can be performed using for example **DOS (version 0.5.2)** or **stats (version 3.6.2)** package.\n\n#### stats {.unnumbered}\n\nFunction *wilcox.test* used for Wilcoxon Rank Sum and Signed Rank Tests will be applied. For more information about that function go [here](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/wilcox.test)\n\nWe will focus on the below arguments: - alternative - paired - exact - correct - conf.int.\n\n### Examples {.unnumbered}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exact \nstats::wilcox.test(x = blood_p$bp_after, y = blood_p$bp_before, \n                                   paired = TRUE, \n                                   conf.int = TRUE, \n                                   conf.level = 0.9, \n                                   alterative = \"two.sided\", \n                                   exact = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  blood_p$bp_after and blood_p$bp_before\nV = 17251, p-value = 0.009379\nalternative hypothesis: true location shift is not equal to 0\n90 percent confidence interval:\n 1.5045 5.9945\nsample estimates:\n(pseudo)median \n       3.68875 \n```\n\n\n:::\n\n```{.r .cell-code}\n# No exact & continuity correction\nstats::wilcox.test(x = blood_p$bp_after, y = blood_p$bp_before, \n                                   paired = TRUE, \n                                   conf.int = TRUE, \n                                   conf.level = 0.9, \n                                   alterative = \"two.sided\", \n                                   exact = FALSE, \n                                   correct = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  blood_p$bp_after and blood_p$bp_before\nV = 17251, p-value = 0.009548\nalternative hypothesis: true location shift is not equal to 0\n90 percent confidence interval:\n 1.504565 5.994467\nsample estimates:\n(pseudo)median \n      3.688796 \n```\n\n\n:::\n\n```{.r .cell-code}\n# No exact & No continuity correction\nstats::wilcox.test(x = blood_p$bp_after, y = blood_p$bp_before, \n                                     paired = TRUE, \n                                     conf.int = TRUE, \n                                     conf.level = 0.9, \n                                     alterative = \"two.sided\" , \n                                     exact = FALSE, \n                                     correct = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test\n\ndata:  blood_p$bp_after and blood_p$bp_before\nV = 17251, p-value = 0.009535\nalternative hypothesis: true location shift is not equal to 0\n90 percent confidence interval:\n 1.504991 5.993011\nsample estimates:\n(pseudo)median \n      3.688796 \n```\n\n\n:::\n:::\n\n\n\n### Important notes on stats:wilcox.test {.unnumbered}\n\n-   By default an exact p-value is computed if the samples size is less than 50 and there are no ties. Otherwise, a normal approximation is used.\n-   If exact p-values are available, an exact confidence interval is obtained by the algorithm described in Bauer (1972), and the Hodges-Lehmann estimator is employed. Otherwise, the returned confidence interval and point estimate are based on normal approximations.\n-   If non-exact p-value is calculated, continuity correction in the normal approximation for the p-value can be applied with *correct* argument.\n-   Statistic V is provided, which is a test statistic based on Sprent (1993) algorithm\n\n#### DOS2 {.unnumbered}\n\nFunction *senWilcox* used for Sensitivity Analysis for Wilcoxon's Signed-rank Statistic will be applied. For more information about that function go [here](https://www.rdocumentation.org/packages/DOS/versions/1.0.0/topics/senWilcox)\n\n### Examples {.unnumbered}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDOS2::senWilcox(blood_p$bp_after - blood_p$bp_before, \n                   gamma = 1, \n                   conf.int = TRUE, \n                   alpha = 0.1, \n                   alternative = \"twosided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$pval\n[1] 0.009534732\n\n$estimate\n     low     high \n3.688796 3.688796 \n\n$ci\n    low    high \n1.50494 5.99305 \n```\n\n\n:::\n:::\n\n\n\n### Important notes on DOS2:senWilcox {.unnumbered}\n\n-   Gamma \\>= 1 is the value of the sensitivity parameter. If gamma=1, then you are assuming ignorable treatment assignment or equivalently no unmeasured confounding - that is the considered scenario in our example, sensitivity analysis is not performed.\n-   Only p value, estimate and CI are provided\n\n### Coin package - coming soon! {.unnumbered}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}