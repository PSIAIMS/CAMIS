{
  "hash": "9b6d91bc1f92c58d074c4c45563e79b1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Jonckheere-Terpstra test\"\n---\n\n\n\n## Available R packages\n\nAs far as I know, the following packages are available:\n\n-   DescTools\n-   clinfun\n-   PMCMRplus\n-   fastJT\n\nDue to availability in the company, DescTools version 0.99.55 is used to compare the results with SAS. Of these packages DescTools is the most common. \n\n## Data used\n\nThe data for testing is a sample dataset on a dose-response study.\n\n![](/images/jonckheere/jonck_bp.png)\n\nThe Group indicates a dose of a drug. The scores for Group represent ordering of dose arms. Then the boxplot implies a declining dose-response relationship.\n\n## Example Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DescTools)\nlibrary(ggplot2)\nlibrary(readr)\n\n#\n# Constants\nk_n_samp <- 10000\n\nset.seed(4989)\n#\n# The input dataset is imported.\n#\ninds <- read_csv(\"../data/jonck.csv\", col_select = c(DOSE, value)) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 40 Columns: 2\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" dbl\n(2): DOSE, value\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n```\n\n\n:::\n\n```{.r .cell-code}\n#\n# Analysis\n#\njt_norm <- DescTools::JonckheereTerpstraTest(\n  value ~ DOSE,\n  alternative = \"decreasing\",\n  data = inds\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in JonckheereTerpstraTest.default(alternative = alternative, c(153, : Sample size > 100 or data with ties \n p-value based on normal approximation. Specify nperm for permutation p-value\n```\n\n\n:::\n\n```{.r .cell-code}\njt_resamp <- DescTools::JonckheereTerpstraTest(\n  value ~ DOSE,\n  alternative = \"decreasing\",\n  data = inds,\n  nperm = k_n_samp\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in JonckheereTerpstraTest.default(alternative = alternative, nperm = nperm, : Sample size > 100 or data with ties \n p-value based on normal approximation. Specify nperm for permutation p-value\n```\n\n\n:::\n\n```{.r .cell-code}\njt_norm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tJonckheere-Terpstra test\n\ndata:  value by DOSE\nJT = 184.5, p-value = 0.002655\nalternative hypothesis: decreasing\n```\n\n\n:::\n\n```{.r .cell-code}\njt_resamp\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tJonckheere-Terpstra test\n\ndata:  value by DOSE\nJT = 184.5, p-value = 0.0023\nalternative hypothesis: decreasing\n```\n\n\n:::\n:::\n\n\n\n\n\n## Reference\n\nSignorell A (2024). DescTools: Tools for Descriptive Statistics. R package version 0.99.55, https://github.com/AndriSignorell/DescTools/, https://andrisignorell.github.io/DescTools/.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}