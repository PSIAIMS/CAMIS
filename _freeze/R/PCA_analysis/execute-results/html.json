{
  "hash": "24e13179cc4cb2fe24a434f7301eb2f0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Principle Component Analysis\"\n---\n\n\n\n## Introduction\n\nPrincipal Component Analysis (PCA) is a dimensionality reduction technique used to reduce the number of features in a dataset while retaining most of the information.\n\n### Steps to Perform PCA in R\n\n-   We will load the `iris` data.\n-   Standardize the data and then compute PCA.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: ggplot2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'plotly'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n\n\n:::\n\n```{.r .cell-code}\ndata <- iris\npca_result <- stats::prcomp(data[, 1:4], scale = T)\npca_result\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviations (1, .., p=4):\n[1] 1.7083611 0.9560494 0.3830886 0.1439265\n\nRotation (n x k) = (4 x 4):\n                    PC1         PC2        PC3        PC4\nSepal.Length  0.5210659 -0.37741762  0.7195664  0.2612863\nSepal.Width  -0.2693474 -0.92329566 -0.2443818 -0.1235096\nPetal.Length  0.5804131 -0.02449161 -0.1421264 -0.8014492\nPetal.Width   0.5648565 -0.06694199 -0.6342727  0.5235971\n```\n\n\n:::\n:::\n\n\n\nWe print the summary of the PCA result, which includes the standard deviation of each principal component and the proportion of variance explained.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pca_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nImportance of components:\n                          PC1    PC2     PC3     PC4\nStandard deviation     1.7084 0.9560 0.38309 0.14393\nProportion of Variance 0.7296 0.2285 0.03669 0.00518\nCumulative Proportion  0.7296 0.9581 0.99482 1.00000\n```\n\n\n:::\n:::\n\n\n\n## Visualize PCA Results\n\n### Scree Plot\n\nA scree plot shows the proportion of variance explained by each principal component.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfactoextra::fviz_eig(pca_result)\n```\n\n::: {.cell-output-display}\n![](PCA_analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n### Biplot\n\nA biplot shows the scores of the samples and the loadings of the variables on the first two principal components.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplt <- factoextra::fviz_pca_biplot(\n  pca_result,\n  geom.ind = \"point\",\n  pointshape = 21,\n  pointsize = 2,\n  fill.ind = iris$Species,\n  col.var = \"black\",\n  repel = TRUE\n)\nplt\n```\n\n::: {.cell-output-display}\n![](PCA_analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n## Interpretation\n\n-   The **Scree Plot** suggests to decide the number of principle components to retain by looking an *elbow* point where the explained variance starts to level off.\n\n-   The **biplot** visualizes both the samples (points) and the variables (arrows). Points that are close to each other represent samples with similar characteristics, while the direction and length of the arrows indicate the contribution of each variable to the principal components.\n\n## Visualization of PCA in 3d Scatter Plot\n\nA 3d scatter plot allows us to see the relationships between three principle components simultaneously and also gives us a better understanding of how much variance is explained by these components.\n\nIt also allows for interactive exploration where we can rotate the plot and view it from a different angles.\n\nWe will plot this using `plotly` package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca_result2 <- stats::prcomp(data[, 1:4], scale = T, rank. = 3)\npca_result2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviations (1, .., p=4):\n[1] 1.7083611 0.9560494 0.3830886 0.1439265\n\nRotation (n x k) = (4 x 3):\n                    PC1         PC2        PC3\nSepal.Length  0.5210659 -0.37741762  0.7195664\nSepal.Width  -0.2693474 -0.92329566 -0.2443818\nPetal.Length  0.5804131 -0.02449161 -0.1421264\nPetal.Width   0.5648565 -0.06694199 -0.6342727\n```\n\n\n:::\n:::\n\n\n\nNext, we will create a dataframe of the 3 principle components and negate PC2 and PC3 for visual preference to make the plot look more organised and symmetric in 3d space.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomponents <- as.data.frame(pca_result2$x)\ncomponents$PC2 <- components$PC2\ncomponents$PC3 <- components$PC3\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfig <- plotly::plot_ly(\n  components,\n  x = ~PC1,\n  y = ~PC2,\n  z = ~PC3,\n  color = ~ data$Species,\n  colors = c('darkgreen', 'darkblue', 'darkred')\n) |>\n  add_markers(size = 12)\n\nfig <- fig |>\n  layout(title = \"3d Visualization of PCA\", scene = list(bgcolor = \"lightgray\"))\nfig\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-f71cf5fc0b7fb73eeec6\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f71cf5fc0b7fb73eeec6\">{\"x\":{\"visdat\":{\"17778715cbde0\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"17778715cbde0\",\"attrs\":{\"17778715cbde0\":{\"x\":{},\"y\":{},\"z\":{},\"color\":{},\"colors\":[\"darkgreen\",\"darkblue\",\"darkred\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter3d\",\"mode\":\"markers\",\"size\":12,\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"3d Visualization of PCA\",\"scene\":{\"bgcolor\":\"lightgray\",\"xaxis\":{\"title\":\"PC1\"},\"yaxis\":{\"title\":\"PC2\"},\"zaxis\":{\"title\":\"PC3\"}},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[-2.2571411756481203,-2.0740130151996223,-2.3563351118061795,-2.291706785869696,-2.3818627044169398,-2.0687006084676947,-2.4358684489631401,-2.2253918887805546,-2.3268453293413174,-2.1770349052411131,-2.1590769916914128,-2.3183641306818084,-2.2110436965113833,-2.6243090161435649,-2.1913992118090246,-2.2546612065689424,-2.2002167647433657,-2.1830361348214451,-1.8922328395553785,-2.335544760603729,-1.9079312487023756,-2.1996438314933204,-2.7650814226329539,-1.8125971593938741,-2.2197270134750551,-1.9453292965767013,-2.0443027680582864,-2.1613364960941168,-2.1324196468793004,-2.2576979945994262,-2.1329764658306067,-1.8254792451868609,-2.606216866623194,-2.4380098316939143,-2.1029298644144383,-2.20043722941984,-2.0383176527766951,-2.5188933857287004,-2.4215202566939689,-2.1624662482954689,-2.2788408143754486,-1.8519183573960714,-2.5451120332614368,-1.9578885746886701,-2.1299235635013827,-2.0628336148580333,-2.3767707623614864,-2.3863817132223479,-2.222002632176499,-2.1964750395657382],\"y\":[-0.47842383212489836,0.67188268702736287,0.34076642462457185,0.59539986268154654,-0.6446756594005365,-1.4842052973421591,-0.047485118061932147,-0.22240300191943904,1.1116036995379202,0.46744756851167762,-1.0402058665204255,-0.13263399898961756,0.7262431830141074,0.95829634715532819,-1.8538465546759559,-2.6773152297366045,-1.4786557287482189,-0.48720613057248935,-1.4003275666972363,-1.1240835971653471,-0.40749057637302188,-0.92103587079814786,-0.45681330064998371,-0.085272854283543836,-0.13679617543507255,0.62352970519123996,-0.24135499096310603,-0.52538942181253678,-0.3121720048492605,0.33660424817911683,0.50285607545475519,-0.42228038897123388,-1.787587272253691,-2.1435467959850492,0.45866527006408664,0.20541922415559744,-0.65934923013302627,-0.59031516341379253,0.90116106687161368,-0.26798119945859211,-0.44024054088485137,2.3296107445884071,0.47750101724203131,-0.47074961267307924,-1.138415464206878,0.70867858611892531,-1.116688690866241,0.38495723001524029,-0.99462766898127219,-0.0091855849561628209],\"z\":[0.12727962370642407,0.23382551672596838,-0.044053900170170648,-0.090985297101388155,-0.015685647296915812,-0.026878249799620845,-0.33435029650976511,0.088399351885749308,-0.14459246541111218,0.25291826754793123,0.26778400087288623,-0.093446190938266463,0.23014024594833926,-0.1801924230037194,0.47132202519164829,-0.03042468374134456,0.005326250642546426,0.044067685627315584,0.37309337699630118,-0.13218762592303643,0.41988593709161315,-0.15933150185554157,-0.33106998228169604,-0.03437344156931952,-0.11759956626989189,0.30462047536162118,-0.086075649383009392,0.20612570745261946,0.27024489470976487,-0.068207275501796186,0.074757995501543814,0.26956431115447993,-0.047070727347892756,0.082392024107147396,0.169706329468823,0.22468885151058135,0.48291958424391346,-0.01937091807454417,-0.19260940244717387,0.17529656074248576,-0.034778398118879034,0.20355230335667809,-0.30474552674038069,-0.30856758768782955,-0.24760406444431204,0.063716369790122546,-0.057026812954469777,-0.13900223413744975,0.18088679201614896,0.15251853914289457],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"setosa\",\"marker\":{\"color\":\"rgba(0,100,0,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(0,100,0,1)\"}},\"textfont\":{\"color\":\"rgba(0,100,0,1)\",\"size\":55},\"error_y\":{\"color\":\"rgba(0,100,0,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(0,100,0,1)\",\"width\":55},\"line\":{\"color\":\"rgba(0,100,0,1)\",\"width\":55},\"frame\":null},{\"x\":[1.0981024376140958,0.72889555739242129,1.2368358043772549,0.4061225105823153,1.0718837900813598,0.38738954547840643,0.74403714758811224,-0.48569561657438209,0.92480346062936147,0.011388037749879973,-0.10982834481652597,0.43922201432770724,0.56023147881145241,0.7171593380995257,-0.033243334910673029,0.87248428723581961,0.3490822100792027,0.15827979549152929,1.2210031592595878,0.1643672537776652,0.73521959465377107,0.47469691207416043,1.2300572911691432,0.63074514472990939,0.70031506245243724,0.87135453503446736,1.2523137488477774,1.3538695324130849,0.66258066030327978,-0.040124191123328601,0.1303584625073958,0.023374382611803041,0.24073179900704403,1.0575517121109286,0.22323092910903169,0.42770625971128584,1.0452264452692477,1.041043790738672,0.069355972150181591,0.28253073401484757,0.27814596118010959,0.62248441074687388,0.33540672635969571,-0.36097408780556284,0.28762267607030084,0.091055610877510448,0.22695653998791943,0.57446378148226573,-0.44617230026802301,0.25587338920273545],\"y\":[-0.86009103319553293,-0.59262936211123496,-0.61423989358614961,1.7485461967118705,0.20772514746029191,0.59130271681718416,-0.7704382721314329,1.8462439975141662,-0.032118477998470417,1.0305657837710593,2.6452111149372075,0.063083851659568313,1.7588321291736679,0.18560281910121951,0.43753741887791137,-0.50736423931782726,0.19565626783157317,0.78945100802953438,1.6168272811149818,1.2982599385868023,-0.39524744620369717,0.41592688740299677,0.93020944053751609,0.41499744081119277,0.063200093525290602,-0.24995601696388262,0.076998068993453447,-0.33020546273671902,0.22517350248975151,1.0551835832743885,1.5570555530892314,1.5672252436853074,0.77466119543132239,0.63172690078083205,0.28681266290987922,-0.84275892003179464,-0.52030871421087321,1.3783710478047053,0.21877043332069515,1.3248861470822881,1.116288852121148,-0.024839813565086705,0.98510382809762875,2.0124958247898048,0.85287311561658297,0.18058714208064772,0.38363486844784794,0.15435648860359705,1.5386374556189331,0.59685228541112412],\"z\":[0.68230039282705357,0.093807451828608196,0.55215705781672841,0.023024633148333608,0.39692578416121693,-0.1237768854239189,-0.14847200747492437,-0.24843299212757242,0.5941788070295666,-0.53710005497685709,0.046634215094494079,-0.2043890928302434,0.76321455381594605,0.06842969955623239,-0.19428203043238335,0.50183020373507214,-0.48923409473207985,0.30102870025891326,0.48069365558116883,0.17226071898062165,-0.61446778202402641,0.2640675755557369,0.36718217755592786,0.29092163786105268,0.44453776464771894,0.47100105702493844,0.72472709858945183,0.25995570098109966,-0.08557719715852885,0.31850630421203113,0.14948269738103048,0.2407457605706807,0.15070707432178018,-0.10495976160768143,-0.66302851244555283,-0.44912944597065452,0.39446489032433829,0.68599780356006068,-0.29060571813169589,-0.089111491144873378,-0.094172115654535704,0.020412762520170786,0.19872401135784185,-0.10546772112423247,-0.13045265680242751,-0.12854769630639201,-0.15569157223889699,0.27074334693424523,-0.18976519930818597,-0.091572384981751617],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"versicolor\",\"marker\":{\"color\":\"rgba(0,0,139,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(0,0,139,1)\"}},\"textfont\":{\"color\":\"rgba(0,0,139,1)\",\"size\":55},\"error_y\":{\"color\":\"rgba(0,0,139,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(0,0,139,1)\",\"width\":55},\"line\":{\"color\":\"rgba(0,0,139,1)\",\"width\":55},\"frame\":null},{\"x\":[1.8384100229241183,1.1540155536207821,2.1979036092803876,1.435342133996657,1.8615757681276306,2.7426850851882403,0.3657922497556223,2.2947518123299386,1.9999863272097709,2.2522321615076062,1.3596206364243884,1.5973274746691324,1.8776105315494596,1.2559076914609217,1.4627448694704237,1.5847681965571634,1.466518487614177,2.4182276992990488,3.2996414776683647,1.2595470736340049,2.0309125552582632,0.97471534705571683,2.8879765004830364,1.3287806370817006,1.6950553043510082,1.9478013897868984,1.1711800692439636,1.0175416912603277,1.7823787852455022,1.8574250065631803,2.4278203037875978,2.297231781409117,1.8564838260721772,1.1104277044557769,1.1984583545709862,2.7894256119820877,1.570992937538038,1.3417969588453575,0.92173701170632427,1.8458612446818941,2.0080831643295824,1.8954342091284906,1.1540155536207821,2.0337449929110125,1.9914754676577082,1.8642578555109706,1.559356493544761,1.516091452060774,1.3682041780884424,0.95744848842799191],\"y\":[-0.86751505609005686,0.69653640051636556,-0.56013397602006032,0.046830700896184102,-0.29405969708424751,-0.79773670875522129,1.5562891777844181,-0.41866301953474272,0.70906322570176505,-1.9145963005352942,-0.69044340477925292,0.42029243098447622,-0.41784981480866096,1.1583797413859951,0.44079488346362039,-0.67398688687984298,-0.25476832684842854,-2.5481247954087785,-0.017721580375847732,1.7010467154508633,-0.90742744316954893,0.56985525662926073,-0.41225995036568625,0.48020249556516059,-1.0105364760108506,-1.0044127199945083,0.31533806043800833,-0.064131183800905697,0.18673563282904893,-0.56041328917277389,-0.25841870640972581,-2.6175544171464478,0.17795333438145791,0.29194458179617333,0.80860636420922727,-0.85394254244713175,-1.065013213863317,-0.42102015412406679,-0.017165594113267665,-0.67387064501412064,-0.6118359295755571,-0.68727306546384759,0.69653640051636556,-0.86462402992736542,-1.0456656698012146,-0.38567403771923492,0.8936928545986671,-0.26817074729815549,-1.0078779335796029,0.024250426980430353],\"z\":[-1.0020440766239433,-0.52838999355848015,0.20223665809673635,-0.16308376104160369,-0.39430740801225062,0.58036482660662769,-0.98359812215443643,0.64953045175197166,0.39267507275067393,-0.39622450846366386,-0.28366178037344797,-0.023108990639142568,-0.026250468031306533,-0.57831189109057624,-1.0005177461006252,-0.63629705368859324,-0.037306280364191563,0.12745447510088714,0.70095703255993658,0.26664361231498601,-0.2340155098470765,-0.82536216127658202,0.8545589727251387,0.0054102390253957487,-0.29745411354893692,0.41858243178705024,-0.12950390686740218,-0.33658836512788837,-0.26975430427558811,0.71324468245955752,0.72538603489728781,0.49182614430420346,-0.35296624235469659,0.18287574089503403,0.16417376000116637,0.54109378485785742,-0.94269570024927096,-0.18027155136753167,-0.41543444887408293,0.012629803789369128,-0.42690267838251317,-0.129640697037222,-0.52838999355848015,-0.33701496892489746,-0.63030186586537029,-0.25541817771463415,0.026283300128952691,-0.17957678119078277,-0.93027872080581553,-0.52648503306244487],\"type\":\"scatter3d\",\"mode\":\"markers\",\"name\":\"virginica\",\"marker\":{\"color\":\"rgba(139,0,0,1)\",\"size\":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],\"sizemode\":\"area\",\"line\":{\"color\":\"rgba(139,0,0,1)\"}},\"textfont\":{\"color\":\"rgba(139,0,0,1)\",\"size\":55},\"error_y\":{\"color\":\"rgba(139,0,0,1)\",\"width\":55},\"error_x\":{\"color\":\"rgba(139,0,0,1)\",\"width\":55},\"line\":{\"color\":\"rgba(139,0,0,1)\",\"width\":55},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "PCA_analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}