{
  "hash": "235f6779c40096dbcf1affeee9d48105",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Regression for Count Data\"\n---\n\n\n\n\n\nThe most commonly used models for count data in clinical trials include:\n\n-   Poisson regression: assumes the response variable $Y$ has a Poisson distribution, which is linked using the logarithm with explanatory variables $\\bf{x}$.\n\n$$\n\\text{log}(E(Y|x))= \\beta_0 + \\beta' x, \\; i = 1,\\ldots,n \n$$\n\n-   Quasi-Poisson regression: Poisson model that allows overdispersion, i.e. dispersion parameter is not fixed at one.\n-   Negative-Binomial regression: popular generalization which loosens the assumption that the variance is equal to the mean made by the Poisson model.\n\nOther models include hurdle or zero-inflated models, if data have more zero observations than expected.\n\n# Example: Familial Andenomatous Polyposis Data\n\n*Data source: F. M. Giardiello, S. R. Hamilton, A. J. Krush, S. Piantadosi, L. M. Hylind, P. Celano, S. V. Booker, C. R. Robinson and G. J. A. Offerhaus (1993), Treatment of colonic and rectal adenomas with sulindac in familial adenomatous polyposis. New England Journal of Medicine, 328(18), 1313--1316.*\n\nData from a placebo-controlled trial of a non-steroidal anti-inflammatory drug in the treatment of familial andenomatous polyposis (FAP). (see `?polyps` for details).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npolyps <- HSAUR2::polyps\nglimpse(polyps)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 20\nColumns: 3\n$ number <dbl> 63, 2, 28, 17, 61, 1, 7, 15, 44, 25, 3, 28, 10, 40, 33, 46, 50,…\n$ treat  <fct> placebo, drug, placebo, drug, placebo, drug, placebo, placebo, …\n$ age    <dbl> 20, 16, 18, 22, 13, 23, 34, 50, 19, 17, 23, 22, 30, 27, 23, 22,…\n```\n\n\n:::\n:::\n\n\n\nWe analyze the number of colonic polyps at 12 months in dependency of treatment and age of the patient.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npolyps |>\n  ggplot(aes(y = number, x = age, color = treat)) +\n  geom_point() +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](count_data_regression_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n# Model Fit\n\nWe fit a generalized linear model for `number` using the Poisson distribution with default log link.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Poisson\nm1 <- stats::glm(number ~ treat + age, data = polyps, family = poisson)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nstats::glm(formula = number ~ treat + age, family = poisson, \n    data = polyps)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.529024   0.146872   30.84  < 2e-16 ***\ntreatdrug   -1.359083   0.117643  -11.55  < 2e-16 ***\nage         -0.038830   0.005955   -6.52 7.02e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 378.66  on 19  degrees of freedom\nResidual deviance: 179.54  on 17  degrees of freedom\nAIC: 273.88\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n\n\nThe parameter estimates are on log-scale. For better interpretation, we can exponentiate these estimates, to obtain estimates and provide $95$% confidence intervals:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# OR and CI\nexp(coef(m1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)   treatdrug         age \n 92.6681047   0.2568961   0.9619140 \n```\n\n\n:::\n\n```{.r .cell-code}\nexp(confint(m1))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWaiting for profiling to be done...\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 2.5 %      97.5 %\n(Intercept) 69.5361752 123.6802476\ntreatdrug    0.2028078   0.3218208\nage          0.9505226   0.9729788\n```\n\n\n:::\n:::\n\n\n\nPredictions for number of colonic polyps given a new 25-year-old patient on either treatment using `predict()`:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# new 25 year old patient\nnew_pt <- data.frame(treat = c(\"drug\", \"placebo\"), age = 25)\npredict(m1, new_pt, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1         2 \n 9.017654 35.102332 \n```\n\n\n:::\n:::\n\n\n\n# Modelling Overdispersion\n\nPoisson model assumes that mean and variance are equal, which can be a very restrictive assumption. One option to relax the assumption is adding a overdispersion constant to the relationship, i.e. $\\text{Var}(\\text{response}) = \\phi\\cdot \\mu$, which results in a quasipoisson model:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Quasi poisson\nm2 <- stats::glm(number ~ treat + age, data = polyps, family = quasipoisson)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nstats::glm(formula = number ~ treat + age, family = quasipoisson, \n    data = polyps)\n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  4.52902    0.48106   9.415 3.72e-08 ***\ntreatdrug   -1.35908    0.38533  -3.527  0.00259 ** \nage         -0.03883    0.01951  -1.991  0.06284 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for quasipoisson family taken to be 10.72805)\n\n    Null deviance: 378.66  on 19  degrees of freedom\nResidual deviance: 179.54  on 17  degrees of freedom\nAIC: NA\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n\n\nAlternatively, we can explicitly model the count data with overdispersion using the negative Binomial model. In this case, the overdispersion is a function of both $\\mu$ and $\\mu^2$:\n\n$$\n\\text{Var}(\\text{response}) = \\mu + \\kappa\\,\\mu^2.\n$$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Negative Binomial\nm3 <- MASS::glm.nb(number ~ treat + age, data = polyps)\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nMASS::glm.nb(formula = number ~ treat + age, data = polyps, init.theta = 1.719491, \n    link = log)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  4.52603    0.59466   7.611 2.72e-14 ***\ntreatdrug   -1.36812    0.36903  -3.707 0.000209 ***\nage         -0.03856    0.02095  -1.840 0.065751 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(1.7195) family taken to be 1)\n\n    Null deviance: 36.734  on 19  degrees of freedom\nResidual deviance: 22.002  on 17  degrees of freedom\nAIC: 164.88\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  1.719 \n          Std. Err.:  0.607 \n\n 2 x log-likelihood:  -156.880 \n```\n\n\n:::\n:::\n\n\n\nBoth model result very similar parameter estimates, but vary in estimates for their respective standard deviation.\n",
    "supporting": [
      "count_data_regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}