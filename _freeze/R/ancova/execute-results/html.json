{
  "hash": "ad6ead4389c7b9923a31c04bd64c4aa7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Ancova\"\noutput: html_document\ndate: \"2023-06-01\"\n---\n\n\n\n\n\n## Introduction\n\nANOVA is a statistical method used to compare the means of three or more groups to determine if at least one group mean is significantly different from the others. Please see the [ANOVA document](anova.qmd) for more information. ANCOVA is an extension to ANOVA.\n\nANCOVA (Analysis of Covariance) is a statistical method that compares the means of two or more groups while controlling for one or more continuous covariates. By adjusting for these covariates, ANCOVA helps to reduce potential confounding effects, allowing for a clearer assessment of the main treatment effects. It assumes linear relationships between covariates and the dependent variable, along with normality and homogeneity of variances.\n\nWe follow the example from link [Analysis of Covariance](https://documentation.sas.com/doc/en/pgmsascdc/9.4_3.4/statug/statug_glm_examples04.htm)\n\n## Data Summary\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_sas |> glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30\nColumns: 3\n$ drug <fct> A, A, A, A, A, A, A, A, A, A, D, D, D, D, D, D, D, D, D, D, F, F,…\n$ pre  <dbl> 11, 8, 5, 14, 19, 6, 10, 6, 11, 3, 6, 6, 7, 8, 18, 8, 19, 8, 5, 1…\n$ post <dbl> 6, 0, 2, 8, 11, 4, 13, 1, 8, 0, 0, 2, 3, 1, 18, 4, 14, 9, 1, 9, 1…\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_sas |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n drug        pre             post      \n A:10   Min.   : 3.00   Min.   : 0.00  \n D:10   1st Qu.: 7.00   1st Qu.: 2.00  \n F:10   Median :10.50   Median : 7.00  \n        Mean   :10.73   Mean   : 7.90  \n        3rd Qu.:13.75   3rd Qu.:12.75  \n        Max.   :21.00   Max.   :23.00  \n```\n\n\n:::\n:::\n\n\n\n## The Model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_ancova <- lm(post ~ drug + pre, data = df_sas)\n\nmodel_glance <- model_ancova |>\n  glance()\nmodel_tidy <- model_ancova |>\n  tidy()\nmodel_glance |>\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"zwidbackaf\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#zwidbackaf table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#zwidbackaf thead, #zwidbackaf tbody, #zwidbackaf tfoot, #zwidbackaf tr, #zwidbackaf td, #zwidbackaf th {\n  border-style: none;\n}\n\n#zwidbackaf p {\n  margin: 0;\n  padding: 0;\n}\n\n#zwidbackaf .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#zwidbackaf .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#zwidbackaf .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#zwidbackaf .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#zwidbackaf .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#zwidbackaf .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#zwidbackaf .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#zwidbackaf .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#zwidbackaf .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#zwidbackaf .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#zwidbackaf .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#zwidbackaf .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#zwidbackaf .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#zwidbackaf .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#zwidbackaf .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwidbackaf .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#zwidbackaf .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#zwidbackaf .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#zwidbackaf .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwidbackaf .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#zwidbackaf .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwidbackaf .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#zwidbackaf .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwidbackaf .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#zwidbackaf .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#zwidbackaf .gt_left {\n  text-align: left;\n}\n\n#zwidbackaf .gt_center {\n  text-align: center;\n}\n\n#zwidbackaf .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#zwidbackaf .gt_font_normal {\n  font-weight: normal;\n}\n\n#zwidbackaf .gt_font_bold {\n  font-weight: bold;\n}\n\n#zwidbackaf .gt_font_italic {\n  font-style: italic;\n}\n\n#zwidbackaf .gt_super {\n  font-size: 65%;\n}\n\n#zwidbackaf .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#zwidbackaf .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#zwidbackaf .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#zwidbackaf .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#zwidbackaf .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#zwidbackaf .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#zwidbackaf .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#zwidbackaf .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#zwidbackaf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"r.squared\">r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"adj.r.squared\">adj.r.squared</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sigma\">sigma</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"logLik\">logLik</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"AIC\">AIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BIC\">BIC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"deviance\">deviance</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df.residual\">df.residual</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"nobs\">nobs</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"r.squared\" class=\"gt_row gt_right\">0.6762609</td>\n<td headers=\"adj.r.squared\" class=\"gt_row gt_right\">0.6389064</td>\n<td headers=\"sigma\" class=\"gt_row gt_right\">4.005778</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">18.10386</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">1.501369e-06</td>\n<td headers=\"df\" class=\"gt_row gt_right\">3</td>\n<td headers=\"logLik\" class=\"gt_row gt_right\">-82.05377</td>\n<td headers=\"AIC\" class=\"gt_row gt_right\">174.1075</td>\n<td headers=\"BIC\" class=\"gt_row gt_right\">181.1135</td>\n<td headers=\"deviance\" class=\"gt_row gt_right\">417.2026</td>\n<td headers=\"df.residual\" class=\"gt_row gt_right\">26</td>\n<td headers=\"nobs\" class=\"gt_row gt_right\">30</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nmodel_tidy |>\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"jgidhpkcqa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#jgidhpkcqa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#jgidhpkcqa thead, #jgidhpkcqa tbody, #jgidhpkcqa tfoot, #jgidhpkcqa tr, #jgidhpkcqa td, #jgidhpkcqa th {\n  border-style: none;\n}\n\n#jgidhpkcqa p {\n  margin: 0;\n  padding: 0;\n}\n\n#jgidhpkcqa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#jgidhpkcqa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#jgidhpkcqa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#jgidhpkcqa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#jgidhpkcqa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#jgidhpkcqa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#jgidhpkcqa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#jgidhpkcqa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#jgidhpkcqa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#jgidhpkcqa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#jgidhpkcqa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#jgidhpkcqa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#jgidhpkcqa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#jgidhpkcqa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#jgidhpkcqa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jgidhpkcqa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#jgidhpkcqa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#jgidhpkcqa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#jgidhpkcqa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jgidhpkcqa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#jgidhpkcqa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jgidhpkcqa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#jgidhpkcqa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jgidhpkcqa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#jgidhpkcqa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#jgidhpkcqa .gt_left {\n  text-align: left;\n}\n\n#jgidhpkcqa .gt_center {\n  text-align: center;\n}\n\n#jgidhpkcqa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#jgidhpkcqa .gt_font_normal {\n  font-weight: normal;\n}\n\n#jgidhpkcqa .gt_font_bold {\n  font-weight: bold;\n}\n\n#jgidhpkcqa .gt_font_italic {\n  font-style: italic;\n}\n\n#jgidhpkcqa .gt_super {\n  font-size: 65%;\n}\n\n#jgidhpkcqa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#jgidhpkcqa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#jgidhpkcqa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#jgidhpkcqa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#jgidhpkcqa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#jgidhpkcqa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#jgidhpkcqa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#jgidhpkcqa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#jgidhpkcqa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">-3.8808094</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">1.9862017</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">-1.9538849</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">6.155192e-02</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">drugD</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.1089713</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">1.7951351</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">0.0607037</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">9.520594e-01</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">drugF</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">3.4461383</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">1.8867806</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">1.8264647</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">7.928458e-02</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">pre</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.9871838</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.1644976</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">6.0012061</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">2.454330e-06</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_table <- model_ancova |>\n  anova() |>\n  tidy()\n\ntotal_df <- sum(model_table$df)\ntotal_sumsq <- sum(model_table$sumsq)\n\nmodel_table |>\n  add_row(term = \"Total\", df = total_df, sumsq = total_sumsq) |>\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"reimgcbcmh\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#reimgcbcmh table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#reimgcbcmh thead, #reimgcbcmh tbody, #reimgcbcmh tfoot, #reimgcbcmh tr, #reimgcbcmh td, #reimgcbcmh th {\n  border-style: none;\n}\n\n#reimgcbcmh p {\n  margin: 0;\n  padding: 0;\n}\n\n#reimgcbcmh .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#reimgcbcmh .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#reimgcbcmh .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#reimgcbcmh .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#reimgcbcmh .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#reimgcbcmh .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#reimgcbcmh .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#reimgcbcmh .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#reimgcbcmh .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#reimgcbcmh .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#reimgcbcmh .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#reimgcbcmh .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#reimgcbcmh .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#reimgcbcmh .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#reimgcbcmh .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#reimgcbcmh .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#reimgcbcmh .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#reimgcbcmh .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#reimgcbcmh .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#reimgcbcmh .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#reimgcbcmh .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#reimgcbcmh .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#reimgcbcmh .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#reimgcbcmh .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#reimgcbcmh .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#reimgcbcmh .gt_left {\n  text-align: left;\n}\n\n#reimgcbcmh .gt_center {\n  text-align: center;\n}\n\n#reimgcbcmh .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#reimgcbcmh .gt_font_normal {\n  font-weight: normal;\n}\n\n#reimgcbcmh .gt_font_bold {\n  font-weight: bold;\n}\n\n#reimgcbcmh .gt_font_italic {\n  font-style: italic;\n}\n\n#reimgcbcmh .gt_super {\n  font-size: 65%;\n}\n\n#reimgcbcmh .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#reimgcbcmh .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#reimgcbcmh .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#reimgcbcmh .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#reimgcbcmh .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#reimgcbcmh .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#reimgcbcmh .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#reimgcbcmh .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#reimgcbcmh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"sumsq\">sumsq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"meansq\">meansq</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">drug</td>\n<td headers=\"df\" class=\"gt_row gt_right\">2</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">293.6000</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">146.80000</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">9.148553</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">9.812371e-04</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">pre</td>\n<td headers=\"df\" class=\"gt_row gt_right\">1</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">577.8974</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">577.89740</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">36.014475</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">2.454330e-06</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Residuals</td>\n<td headers=\"df\" class=\"gt_row gt_right\">26</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">417.2026</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">16.04625</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">NA</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Total</td>\n<td headers=\"df\" class=\"gt_row gt_right\">29</td>\n<td headers=\"sumsq\" class=\"gt_row gt_right\">1288.7000</td>\n<td headers=\"meansq\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">NA</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">NA</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n### Sums of Squares Tables {.unnumbered}\n\n#### Type I\nThis can be calculated using, the base R {stats} package or the {rstatix} package. Both give the same result.\n\n##### stats\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats::anova(model_ancova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: post\n          Df Sum Sq Mean Sq F value    Pr(>F)    \ndrug       2  293.6  146.80  9.1486 0.0009812 ***\npre        1  577.9  577.90 36.0145 2.454e-06 ***\nResiduals 26  417.2   16.05                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n##### rstatix\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_sas |>\n  anova_test(post ~ drug + pre, type = 1, detailed = TRUE) |>\n  get_anova_table() |>\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"evizbwbxsk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#evizbwbxsk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#evizbwbxsk thead, #evizbwbxsk tbody, #evizbwbxsk tfoot, #evizbwbxsk tr, #evizbwbxsk td, #evizbwbxsk th {\n  border-style: none;\n}\n\n#evizbwbxsk p {\n  margin: 0;\n  padding: 0;\n}\n\n#evizbwbxsk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#evizbwbxsk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#evizbwbxsk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#evizbwbxsk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#evizbwbxsk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#evizbwbxsk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#evizbwbxsk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#evizbwbxsk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#evizbwbxsk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#evizbwbxsk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#evizbwbxsk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#evizbwbxsk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#evizbwbxsk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#evizbwbxsk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#evizbwbxsk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#evizbwbxsk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#evizbwbxsk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#evizbwbxsk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#evizbwbxsk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#evizbwbxsk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#evizbwbxsk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#evizbwbxsk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#evizbwbxsk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#evizbwbxsk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#evizbwbxsk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#evizbwbxsk .gt_left {\n  text-align: left;\n}\n\n#evizbwbxsk .gt_center {\n  text-align: center;\n}\n\n#evizbwbxsk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#evizbwbxsk .gt_font_normal {\n  font-weight: normal;\n}\n\n#evizbwbxsk .gt_font_bold {\n  font-weight: bold;\n}\n\n#evizbwbxsk .gt_font_italic {\n  font-style: italic;\n}\n\n#evizbwbxsk .gt_super {\n  font-size: 65%;\n}\n\n#evizbwbxsk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#evizbwbxsk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#evizbwbxsk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#evizbwbxsk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#evizbwbxsk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#evizbwbxsk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#evizbwbxsk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#evizbwbxsk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#evizbwbxsk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Effect\">Effect</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DFn\">DFn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DFd\">DFd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SSn\">SSn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SSd\">SSd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F\">F</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p&lt;.05\">p&lt;.05</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ges\">ges</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">drug</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">2</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">293.600</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"F\" class=\"gt_row gt_right\">9.149</td>\n<td headers=\"p\" class=\"gt_row gt_right\">9.81e-04</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\">*</td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.413</td></tr>\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">pre</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">1</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">577.897</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"F\" class=\"gt_row gt_right\">36.014</td>\n<td headers=\"p\" class=\"gt_row gt_right\">2.45e-06</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\">*</td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.581</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n#### Type II\n\nThis can be calculated using the {car} package or the {rstatix} package. Both give the same result.\n\n##### car\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::Anova(model_ancova, type = \"II\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type II tests)\n\nResponse: post\n          Sum Sq Df F value    Pr(>F)    \ndrug       68.55  2  2.1361    0.1384    \npre       577.90  1 36.0145 2.454e-06 ***\nResiduals 417.20 26                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n##### rstatix\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_sas |>\n  anova_test(post ~ drug + pre, type = 2, detailed = TRUE) |>\n  get_anova_table() |>\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"napwiouwdt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#napwiouwdt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#napwiouwdt thead, #napwiouwdt tbody, #napwiouwdt tfoot, #napwiouwdt tr, #napwiouwdt td, #napwiouwdt th {\n  border-style: none;\n}\n\n#napwiouwdt p {\n  margin: 0;\n  padding: 0;\n}\n\n#napwiouwdt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#napwiouwdt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#napwiouwdt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#napwiouwdt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#napwiouwdt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#napwiouwdt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#napwiouwdt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#napwiouwdt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#napwiouwdt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#napwiouwdt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#napwiouwdt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#napwiouwdt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#napwiouwdt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#napwiouwdt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#napwiouwdt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#napwiouwdt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#napwiouwdt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#napwiouwdt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#napwiouwdt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#napwiouwdt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#napwiouwdt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#napwiouwdt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#napwiouwdt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#napwiouwdt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#napwiouwdt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#napwiouwdt .gt_left {\n  text-align: left;\n}\n\n#napwiouwdt .gt_center {\n  text-align: center;\n}\n\n#napwiouwdt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#napwiouwdt .gt_font_normal {\n  font-weight: normal;\n}\n\n#napwiouwdt .gt_font_bold {\n  font-weight: bold;\n}\n\n#napwiouwdt .gt_font_italic {\n  font-style: italic;\n}\n\n#napwiouwdt .gt_super {\n  font-size: 65%;\n}\n\n#napwiouwdt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#napwiouwdt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#napwiouwdt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#napwiouwdt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#napwiouwdt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#napwiouwdt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#napwiouwdt .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#napwiouwdt .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#napwiouwdt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Effect\">Effect</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SSn\">SSn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SSd\">SSd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DFn\">DFn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DFd\">DFd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F\">F</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p&lt;.05\">p&lt;.05</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ges\">ges</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">drug</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">68.554</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">2</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"F\" class=\"gt_row gt_right\">2.136</td>\n<td headers=\"p\" class=\"gt_row gt_right\">1.38e-01</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\"></td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.141</td></tr>\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">pre</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">577.897</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">1</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"F\" class=\"gt_row gt_right\">36.014</td>\n<td headers=\"p\" class=\"gt_row gt_right\">2.45e-06</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\">*</td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.581</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n#### Type III\n\nThis can be calculated using the base R {stats} package, the {car} package or the {rstatix} package. All give the same result.\n\nNote: Calculating type III sums of squares in R is a bit tricky, because the multi-way ANOVA model is over-paramerterised. So when running the linear model we need to select a design matrix that sums to zero. In R those options will be either `\"contr.sum\"` or `\"contr.poly\"`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Drug design matrix\ncontr.sum(4) # Using 4 here as we have 4 levels of drug\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [,1] [,2] [,3]\n1    1    0    0\n2    0    1    0\n3    0    0    1\n4   -1   -1   -1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Disease design matrix\ncontr.sum(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  [,1] [,2]\n1    1    0\n2    0    1\n3   -1   -1\n```\n\n\n:::\n:::\n\n\n\nWhile not relevant for this example as the disease variable isn't ordinal the polynomial design matrix would look like\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncontr.poly(3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                .L         .Q\n[1,] -7.071068e-01  0.4082483\n[2,] -9.073800e-17 -0.8164966\n[3,]  7.071068e-01  0.4082483\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_ancova <- lm(\n  post ~ drug + pre, data = df_sas,\n  contrasts = list(drug = \"contr.sum\")\n)\n```\n:::\n\n\n\n##### stats\n\nUsing the base stats package, you can use the `drop1()` function which drops all possible single terms in a model. The scope term specifies how things can be dropped.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats::drop1(model_ancova, scope = . ~ ., test = \"F\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSingle term deletions\n\nModel:\npost ~ drug + pre\n       Df Sum of Sq    RSS     AIC F value    Pr(>F)    \n<none>              417.20  86.971                      \ndrug    2     68.55 485.76  87.535  2.1361    0.1384    \npre     1    577.90 995.10 111.049 36.0145 2.454e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n##### car\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::Anova(model_ancova, type = \"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnova Table (Type III tests)\n\nResponse: post\n            Sum Sq Df F value    Pr(>F)    \n(Intercept)  31.93  1  1.9898    0.1702    \ndrug         68.55  2  2.1361    0.1384    \npre         577.90  1 36.0145 2.454e-06 ***\nResiduals   417.20 26                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_sas |>\n  anova_test(post ~ drug + pre, type = 3, detailed = TRUE) |>\n  get_anova_table() |>\n  gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"siguaxnxcc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#siguaxnxcc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#siguaxnxcc thead, #siguaxnxcc tbody, #siguaxnxcc tfoot, #siguaxnxcc tr, #siguaxnxcc td, #siguaxnxcc th {\n  border-style: none;\n}\n\n#siguaxnxcc p {\n  margin: 0;\n  padding: 0;\n}\n\n#siguaxnxcc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#siguaxnxcc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#siguaxnxcc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#siguaxnxcc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#siguaxnxcc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#siguaxnxcc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#siguaxnxcc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#siguaxnxcc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#siguaxnxcc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#siguaxnxcc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#siguaxnxcc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#siguaxnxcc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#siguaxnxcc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#siguaxnxcc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#siguaxnxcc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#siguaxnxcc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#siguaxnxcc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#siguaxnxcc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#siguaxnxcc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#siguaxnxcc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#siguaxnxcc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#siguaxnxcc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#siguaxnxcc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#siguaxnxcc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#siguaxnxcc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#siguaxnxcc .gt_left {\n  text-align: left;\n}\n\n#siguaxnxcc .gt_center {\n  text-align: center;\n}\n\n#siguaxnxcc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#siguaxnxcc .gt_font_normal {\n  font-weight: normal;\n}\n\n#siguaxnxcc .gt_font_bold {\n  font-weight: bold;\n}\n\n#siguaxnxcc .gt_font_italic {\n  font-style: italic;\n}\n\n#siguaxnxcc .gt_super {\n  font-size: 65%;\n}\n\n#siguaxnxcc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#siguaxnxcc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#siguaxnxcc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#siguaxnxcc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#siguaxnxcc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#siguaxnxcc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#siguaxnxcc .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#siguaxnxcc .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#siguaxnxcc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Effect\">Effect</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SSn\">SSn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SSd\">SSd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DFn\">DFn</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"DFd\">DFd</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"F\">F</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p&lt;.05\">p&lt;.05</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"ges\">ges</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">31.929</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">1</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"F\" class=\"gt_row gt_right\">1.990</td>\n<td headers=\"p\" class=\"gt_row gt_right\">1.70e-01</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\"></td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.071</td></tr>\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">drug</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">68.554</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">2</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"F\" class=\"gt_row gt_right\">2.136</td>\n<td headers=\"p\" class=\"gt_row gt_right\">1.38e-01</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\"></td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.141</td></tr>\n    <tr><td headers=\"Effect\" class=\"gt_row gt_left\">pre</td>\n<td headers=\"SSn\" class=\"gt_row gt_right\">577.897</td>\n<td headers=\"SSd\" class=\"gt_row gt_right\">417.203</td>\n<td headers=\"DFn\" class=\"gt_row gt_right\">1</td>\n<td headers=\"DFd\" class=\"gt_row gt_right\">26</td>\n<td headers=\"F\" class=\"gt_row gt_right\">36.014</td>\n<td headers=\"p\" class=\"gt_row gt_right\">2.45e-06</td>\n<td headers=\"p<.05\" class=\"gt_row gt_right\">*</td>\n<td headers=\"ges\" class=\"gt_row gt_right\">0.581</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n### Least Squares Means\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_ancova |>\n  emmeans::lsmeans(\"drug\") |>\n  emmeans::pwpm(pvals = TRUE, means = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        A       D       F\nA [ 6.71]  0.9980  0.1809\nD  -0.109 [ 6.82]  0.1893\nF  -3.446  -3.337 [10.16]\n\nRow and column labels: drug\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (lsmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_ancova |>\n  emmeans::lsmeans(\"drug\") |>\n  plot(comparisons = TRUE)\n```\n\n::: {.cell-output-display}\n![](ancova_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## sasLM Package\n\nThe following code performs an ANCOVA analysis using the **sasLM** package. This package was written specifically to replicate SAS statistics. The console output is also organized in a manner that is similar to SAS.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sasLM)\n\nsasLM::GLM(post ~ drug + pre, df_sas, BETA = TRUE, EMEAN = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$ANOVA\nResponse : post\n                Df Sum Sq Mean Sq F value    Pr(>F)    \nMODEL            3  871.5 290.499  18.104 1.501e-06 ***\nRESIDUALS       26  417.2  16.046                      \nCORRECTED TOTAL 29 1288.7                              \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$Fitness\n Root MSE post Mean Coef Var  R-square  Adj R-sq\n 4.005778       7.9 50.70604 0.6762609 0.6389064\n\n$`Type I`\n     Df Sum Sq Mean Sq F value    Pr(>F)    \ndrug  2  293.6   146.8  9.1486 0.0009812 ***\npre   1  577.9   577.9 36.0145 2.454e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Type II`\n     Df Sum Sq Mean Sq F value    Pr(>F)    \ndrug  2  68.55   34.28  2.1361    0.1384    \npre   1 577.90  577.90 36.0145 2.454e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Type III`\n     Df Sum Sq Mean Sq F value    Pr(>F)    \ndrug  2  68.55   34.28  2.1361    0.1384    \npre   1 577.90  577.90 36.0145 2.454e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$Parameter\n            Estimate Estimable Std. Error Df t value  Pr(>|t|)    \n(Intercept)  -0.4347         0     2.4714 26 -0.1759   0.86175    \ndrugA        -3.4461         0     1.8868 26 -1.8265   0.07928 .  \ndrugD        -3.3372         0     1.8539 26 -1.8001   0.08346 .  \ndrugF         0.0000         0     0.0000 26                      \npre           0.9872         1     0.1645 26  6.0012 2.454e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n$`Expected Mean`\n               LSmean  LowerCL   UpperCL        SE Df\n(Intercept)  7.900000 6.396685  9.403315 0.7313516 26\ndrugA        6.714963 4.066426  9.363501 1.2884943 26\ndrugD        6.823935 4.208337  9.439532 1.2724690 26\ndrugF       10.161102 7.456182 12.866021 1.3159234 26\npre          7.900000 6.396685  9.403315 0.7313516 26\n```\n\n\n:::\n:::\n\n\n\nNote that the LSMEANS statistics are produced using the `EMEAN = TRUE` option. The `BETA = TRUE` option is equivalent to the `SOLUTION` option in SAS. See the **sasLM** documentation for additional information.\n\n::: {.callout-note collapse=\"true\" title=\"Session Info\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.4.2 (2024-10-31)\n os       macOS Sequoia 15.6.1\n system   aarch64, darwin20\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       Europe/London\n date     2025-10-13\n pandoc   3.4 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n ! package * version date (UTC) lib source\n P broom   * 1.0.7   2024-09-26 [?] CRAN (R 4.4.1)\n   car       3.1-3   2024-09-27 [1] RSPM (R 4.4.0)\n P dplyr   * 1.1.4   2023-11-17 [?] CRAN (R 4.4.0)\n P emmeans * 1.10.4  2024-08-21 [?] CRAN (R 4.4.1)\n P gt      * 0.11.1  2024-10-04 [?] CRAN (R 4.4.1)\n P rstatix * 0.7.2   2023-02-01 [?] CRAN (R 4.4.0)\n P sasLM   * 0.10.5  2024-10-02 [?] CRAN (R 4.4.1)\n P tibble  * 3.2.1   2023-03-20 [?] CRAN (R 4.4.0)\n\n [1] /Users/christinafillmore/Documents/GitHub/CAMIS/renv/library/macos/R-4.4/aarch64-apple-darwin20\n [2] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library\n\n P ── Loaded and on-disk path mismatch.\n\n──────────────────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n\n:::",
    "supporting": [
      "ancova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}