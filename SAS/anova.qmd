---
title: "ANOVA"
---

### **Getting Started**

To demonstrate the various types of sums of squares, we'll create a data frame called `df_disease` taken from the SAS documentation.

### The Model {.unnumbered}

For this example, we're testing for a significant difference in `stem_length` using ANOVA.

```{SAS}
#| eval: false
proc glm data = disease;
   class drug disease;
   model y=drug disease drug*disease;
run;
```

```{r}
#| echo: false 
#| fig.align: 'center'
#| out.width: '90%'
knitr::include_graphics("../images/linear/sas-f-table.png")
```

### Sums of Squares Tables {.unnumbered}

SAS has four types of sums of squares calculations. To get these calculations, the sum of squares option needs to be added (`/ ss1 ss2 ss3 ss4`) to the model statement.

```{r}
#| eval: false
proc glm;
   class drug disease;
   model y=drug disease drug*disease / ss1 ss2 ss3 ss4;
run;
```

#### Type I

```{r, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("../images/linear/sas-ss-type-1.png")
```

#### Type II {.unnumbered}

```{r, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("../images/linear/sas-ss-type-2.png")
```

#### Type III {.unnumbered}

```{r, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("../images/linear/sas-ss-type-3.png")
```

#### Type IV {.unnumbered}

```{r, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("../images/linear/sas-ss-type-4.png")
```

### Contrasts {.unnumbered}

To get contrasts in SAS, we use the `estimate` statement. For looking at contrast we are going to fit a different model on new data, that doesn't include an interaction term as it is easier to calculate contrasts without an interaction term. For this dataset we have three different drugs A, C, and E.

```{SAS}
#| eval: false
proc glm data=testdata;
    class drug;
   model post = drug pre / solution;
   estimate 'C vs A'  drug -1  1 0;
   estimate 'E vs CA' drug -1 -1 2;
run;
```

```{r, echo=FALSE, fig.align='center', out.width="75%"}
knitr::include_graphics("../images/linear/clipboard-1394032862.png")
```

Reference: [Sum of squares type I, II, and III](http://dwoll.de/rexrepos/posts/anovaSStypes.html)
