<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Logistic Regression in SAS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ebfcb0ed0ac0539375ffcf22e0e9fa78.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/logo.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contribution/contribution.html"> 
<span class="menu-text">Contribute</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-publications-and-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Publications and projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-publications-and-projects">    
        <li>
    <a class="dropdown-item" href="../publication/white_paper.html">
 <span class="dropdown-text">White paper</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publication/conference.html">
 <span class="dropdown-text">Conferences</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../publication/dissertation.html">
 <span class="dropdown-text">Academic projects</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-news" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">News</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-news">    
        <li>
    <a class="dropdown-item" href="../minutes/index.html">
 <span class="dropdown-text">Meeting minutes</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../blogs/index.html">
 <span class="dropdown-text">Blogs</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/PSIAIMS/CAMIS/">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/PSIAIMS/CAMIS/issues/">
            Report a Difference
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#modelling-the-lung-cancer-data" id="toc-modelling-the-lung-cancer-data" class="nav-link active" data-scroll-target="#modelling-the-lung-cancer-data">Modelling the lung cancer data</a>
  <ul class="collapse">
  <li><a href="#summary-of-common-mistakes-in-sas" id="toc-summary-of-common-mistakes-in-sas" class="nav-link" data-scroll-target="#summary-of-common-mistakes-in-sas"><strong>Summary of Common Mistakes in SAS</strong></a></li>
  <li><a href="#modelling-using-proc-genmod" id="toc-modelling-using-proc-genmod" class="nav-link" data-scroll-target="#modelling-using-proc-genmod">Modelling using Proc Genmod</a></li>
  <li><a href="#modelling-using-proc-logistic" id="toc-modelling-using-proc-logistic" class="nav-link" data-scroll-target="#modelling-using-proc-logistic">Modelling using Proc Logistic</a></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><strong>Model Comparison</strong></a></li>
  <li><a href="#parameterization-of-model-effects-categorical-covariates-in-sas" id="toc-parameterization-of-model-effects-categorical-covariates-in-sas" class="nav-link" data-scroll-target="#parameterization-of-model-effects-categorical-covariates-in-sas">Parameterization of model effects (categorical covariates) in SAS</a>
  <ul class="collapse">
  <li><a href="#class-x-y-z-parameffect" id="toc-class-x-y-z-parameffect" class="nav-link" data-scroll-target="#class-x-y-z-parameffect">CLASS X Y Z /PARAM=Effect</a></li>
  <li><a href="#class-x-y-z-paramglm" id="toc-class-x-y-z-paramglm" class="nav-link" data-scroll-target="#class-x-y-z-paramglm">CLASS X Y Z /PARAM=glm</a></li>
  <li><a href="#class-x-y-z-paramref" id="toc-class-x-y-z-paramref" class="nav-link" data-scroll-target="#class-x-y-z-paramref">CLASS X Y Z /PARAM=Ref</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#contrast-statements-for-2-or-more-treatments" id="toc-contrast-statements-for-2-or-more-treatments" class="nav-link" data-scroll-target="#contrast-statements-for-2-or-more-treatments">Contrast statements for 2 or more treatments</a></li>
  <li><a href="#ensuring-you-are-modelling-the-correct-binary-event-in-sas" id="toc-ensuring-you-are-modelling-the-correct-binary-event-in-sas" class="nav-link" data-scroll-target="#ensuring-you-are-modelling-the-correct-binary-event-in-sas">Ensuring you are modelling the correct Binary event in SAS</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Logistic Regression in SAS</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">19 March, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>For a brief description of what is logistic regression see <a href="../R/logistic_regr.html">here</a>.</p>
<section id="modelling-the-lung-cancer-data" class="level1">
<h1>Modelling the lung cancer data</h1>
<p>In SAS, we can use proc logistic or proc genmod to perform a logistic regression.</p>
<p>To demonstrate the use of logistic regression we examine the same lung dataset as used in the R example <a href="../R/logistic_regr.html">here</a>.</p>
<section id="summary-of-common-mistakes-in-sas" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-common-mistakes-in-sas"><strong>Summary of Common Mistakes in SAS</strong></h2>
<ol type="1">
<li><p>Handling of missing data. Check SAS output that the number of missing values is as you expect. Make sure you have changed any <code>NA</code> results in the raw data to be missing, since SAS would consider <code>NA</code> as a valid category (a non-missing character result).</p></li>
<li><p>Make sure you consider continuous or categorical variables as you intended. Just because a variable is character or numeric in the dataset, doesn’t mean SAS will treat it that way in the model. You have to use Class row to tell SAS which variables should be treated as character factors. You also have to use <code>ref=' '</code> to tell SAS which is the reference category, otherwise SAS by default which use the last value of the variable alphabetically (e..g a categorical variable with 1, 2, 3 would default to 3 as the reference).</p></li>
<li><p>Be careful you are modelling the correct event (response vs non-response, or weight_gain vs weight_loss for example)</p></li>
<li><p>Be careful when interpreting any odds ratios that you have the factor of interest the correct way around (0 vs 1, or 1 vs 0)</p></li>
<li><p>If using proc logistic, be careful of how SAS creates its parameters used in the model as this determines how you can use the parameter estimates! It is often easiest to use <code>param=glm</code> so that the exp(maximum liklihood parameter estimate) = odds ratio. Check the class level information (Design variables) is as you would expect. See below for more detail on other parameterization methods.</p></li>
</ol>
</section>
<section id="modelling-using-proc-genmod" class="level2">
<h2 class="anchored" data-anchor-id="modelling-using-proc-genmod">Modelling using Proc Genmod</h2>
<p>Proc Genmod is a procedure that allows the fitting of Generalized Linear Models. By using the options <code>dist=bin</code> and <code>link=logit,</code> it fits a logistic regression as shown below. For more information see the SAS help <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_genmod_sect002.htm">here</a>.</p>
<p>Always check that the Class Level Information matches what you expect (SAS puts the reference class level last). Also check that you are modelling the correct ‘event’ and that the algorithm has converged.</p>
<p>Below we are fitting trt01pn and sex as categorical variables, age, ph_ecog2 and meal_caln as continuous variables.</p>
<p>You can use exponential of the maximum likelihood parameter estimate and the exponential of the Wald 95% Confidence Limits to obtain the odds ratios and 95% CIs. Proc Genmod uses GLM parameterization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Example data<span class="sc">:</span> . <span class="ot">=</span> missing, <span class="fu">trt01pn</span> (<span class="dv">1</span> or <span class="dv">2</span>), <span class="fu">sex</span> (<span class="dv">1</span> or <span class="dv">2</span>), <span class="fu">ph_ecog2</span> (<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wt_gain</span> (<span class="dv">1</span><span class="ot">=</span>gain, <span class="dv">0</span><span class="ot">=</span>no gain)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>wt_gain   trt01pn  age   sex    ph_ecog2   meal_caln</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>.         <span class="dv">1</span>        <span class="dv">74</span>    <span class="dv">1</span>       <span class="dv">1</span>          <span class="dv">1175</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>         <span class="dv">1</span>        <span class="dv">68</span>    <span class="dv">2</span>       <span class="dv">0</span>          <span class="dv">1225</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>         <span class="dv">2</span>        <span class="dv">60</span>    <span class="dv">1</span>       <span class="dv">2</span>           .</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>proc genmod data<span class="ot">=</span>lung;       </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  class <span class="fu">trt01pn</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>)  ;    </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  model <span class="fu">wt_gain</span> (<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> trt01pn age sex ph_ecog2 meal_caln <span class="sc">/</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        dist<span class="ot">=</span>bin link<span class="ot">=</span>logit;</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>run; </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>Class Level Information</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>Class     Levels      Values</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>trt01pn   <span class="dv">2</span>           <span class="dv">2</span> <span class="dv">1</span> </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>sex       <span class="dv">2</span>           <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>Response Profile</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>Ordered value     wt_gain         Total Frequency</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                 <span class="dv">1</span>                <span class="dv">48</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                 <span class="dv">0</span>                <span class="dv">122</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>PROC GENMOD is modeling the probability that wt_gain<span class="ot">=</span><span class="st">'1'</span>. </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>Algorithm Converged.</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                    Analysis of Maximum Likelihood Estimates                 </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>Parameter   DF  Estimate  Standard   Wald <span class="dv">95</span>%        Wald         Pr<span class="sc">&gt;</span>ChiSq</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>                          Error      CIs             Chi<span class="sc">-</span>Square</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>Intercept   <span class="dv">1</span>   <span class="sc">-</span><span class="fl">2.6415</span>   <span class="fl">1.5140</span>   <span class="sc">-</span><span class="fl">5.6090</span> <span class="fl">0.3259</span>    <span class="fl">3.04</span>         <span class="fl">0.0810</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>trt01pn <span class="dv">2</span>   <span class="dv">1</span>    <span class="fl">0.3888</span>   <span class="fl">0.3782</span>   <span class="sc">-</span><span class="fl">0.3524</span> <span class="fl">1.1299</span>    <span class="fl">1.03</span>         <span class="fl">0.3039</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>trt01pn <span class="dv">1</span>   <span class="dv">0</span>    <span class="fl">0.0000</span>   <span class="fl">0.0000</span>    <span class="fl">0.0000</span> <span class="fl">0.0000</span>    .            .</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>age         <span class="dv">1</span>    <span class="fl">0.0123</span>   <span class="fl">0.0212</span>   <span class="sc">-</span><span class="fl">0.0292</span> <span class="fl">0.0537</span>    <span class="fl">0.34</span>         <span class="fl">0.5624</span>    </span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>sex <span class="dv">2</span>       <span class="dv">1</span>    <span class="fl">0.8321</span>   <span class="fl">0.3744</span>    <span class="fl">0.0983</span> <span class="fl">1.5659</span>    <span class="fl">4.97</span>         <span class="fl">0.0262</span>  </span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>sex <span class="dv">1</span>       <span class="dv">0</span>    <span class="fl">0.0000</span>   <span class="fl">0.0000</span>    <span class="fl">0.0000</span> <span class="fl">0.0000</span>    .            .</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>ph_ecog     <span class="dv">1</span>   <span class="sc">-</span><span class="fl">0.3764</span>   <span class="fl">0.2638</span>   <span class="sc">-</span><span class="fl">0.8935</span> <span class="fl">0.1407</span>    <span class="fl">2.03</span>         <span class="fl">0.1537</span>   </span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>meal_cal    <span class="dv">1</span>   <span class="sc">-</span><span class="fl">0.0008</span>   <span class="fl">0.0004</span>   <span class="sc">-</span><span class="fl">0.0000</span> <span class="fl">0.0017</span>    <span class="fl">3.59</span>         <span class="fl">0.0581</span>  </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>scale       <span class="dv">0</span>    <span class="fl">1.0000</span>   <span class="fl">0.0000</span>    <span class="fl">1.0000</span> <span class="fl">1.0000</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="sc">----------------------------------------------------------------------------</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>Note<span class="sc">:</span> The scale parameter was held fixed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelling-using-proc-logistic" class="level2">
<h2 class="anchored" data-anchor-id="modelling-using-proc-logistic">Modelling using Proc Logistic</h2>
<p>The same model above can also be modelled using Proc Logistic. You no longer have to specify the distribution and link function, however you do need to add an option <code>/ param=glm</code> on the class row. Different parameterizations are discussed later in the context of forming treatment contrast statements.</p>
<p>For now, all you need to know is that using <code>/param=glm</code> ensures exp(estimates)=odds ratio. You will also note that in the <code>class level information</code>, SAS now tells you the <code>design variables</code>. This will also be important later when we learn more about parameterization.</p>
<p>Proc Logistic is often preferred above Proc Genmod as it outputs the Odds Ratios and 95% CIs for you, without you having to back transform them using exponential of the MLEs yourself.</p>
<p>NOTE: that the 95% confidence limits are being calculated using the Wald method. This assumes symmetric intervals around the maximum likelihood estimate using a normal distribution assumption (MLE +/-1.96* SE). Alternative confidence interval estimation methods exist such as the profile likelihood method but SAS does not calculate these.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">trt01pn</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>glm;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> trt01pn age sex ph_ecog2 meal_caln;</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Response Profile</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>Ordered value     wt_gain         Total Frequency</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>                 <span class="dv">0</span>                <span class="dv">122</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>                 <span class="dv">1</span>                <span class="dv">48</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>Probability modeled is wt_gain<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>Note<span class="sc">:</span> <span class="dv">58</span> observations were deleted due to missing values fro the repsonse or</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>explanatory variables.</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>Class Level Information</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>Class     Levels      Design Variables</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>trt01pn   <span class="dv">2</span>           <span class="dv">1</span>  <span class="dv">0</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span>           <span class="dv">0</span>  <span class="dv">1</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>sex       <span class="dv">2</span>           <span class="dv">1</span>  <span class="dv">0</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span>           <span class="dv">0</span>  <span class="dv">1</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>Convergence <span class="fu">criterion</span> (<span class="at">GCONV=</span><span class="fl">1E-8</span>) satisfied.</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                    Analysis of Maximum Likelihood Estimates                 </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>Parameter   DF  Estimate  Standard     Wald         Pr<span class="sc">&gt;</span>ChiSq</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                          Error        Chi<span class="sc">-</span>Square</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>Intercept   <span class="dv">1</span>   <span class="sc">-</span><span class="fl">2.6415</span>   <span class="fl">1.5140</span>       <span class="fl">3.0440</span>       <span class="fl">0.0810</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>trt01pn <span class="dv">2</span>   <span class="dv">1</span>    <span class="fl">0.3888</span>   <span class="fl">0.3782</span>       <span class="fl">1.0569</span>       <span class="fl">0.3039</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>trt01pn <span class="dv">1</span>   <span class="dv">0</span>    <span class="fl">0.0000</span>   .            .            .</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>age         <span class="dv">1</span>    <span class="fl">0.0123</span>   <span class="fl">0.0212</span>       <span class="fl">0.3356</span>       <span class="fl">0.5624</span>    </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>sex <span class="dv">2</span>       <span class="dv">1</span>    <span class="fl">0.8321</span>   <span class="fl">0.3744</span>       <span class="fl">4.9400</span>       <span class="fl">0.0262</span>  </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>sex <span class="dv">1</span>       <span class="dv">0</span>    <span class="fl">0.0000</span>   .            .            .</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>ph_ecog     <span class="dv">1</span>   <span class="sc">-</span><span class="fl">0.3764</span>   <span class="fl">0.2638</span>       <span class="fl">2.0349</span>       <span class="fl">0.1537</span>   </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>meal_cal    <span class="dv">1</span>   <span class="sc">-</span><span class="fl">0.000850</span> <span class="fl">0.000449</span>     <span class="fl">3.5895</span>       <span class="fl">0.0581</span>  </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="sc">----------------------------------------------------------------------------</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>                   Odds Ratio Estimates                </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>Effect           Point Estimate    <span class="dv">95</span>% Wald Confidence Limits</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>trt01pn <span class="dv">2</span> vs <span class="dv">1</span>   <span class="fl">1.475</span>             <span class="fl">0.703</span>   <span class="fl">3.095</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>age              <span class="fl">1.012</span>             <span class="fl">0.971</span>   <span class="fl">1.055</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>sex     <span class="dv">2</span> vs <span class="dv">1</span>   <span class="fl">2.298</span>             <span class="fl">1.103</span>   <span class="fl">4.787</span>    </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>ph_ecog          <span class="fl">0.686</span>             <span class="fl">0.409</span>   <span class="fl">1.151</span>  </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>meal_cal         <span class="fl">1.001</span>             <span class="fl">1.000</span>   <span class="fl">1.002</span> </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a><span class="sc">----------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison"><strong>Model Comparison</strong></h2>
<p>To compare two logistic models, the -2 * Log Likelihood from each model can be compared against a <span class="math inline">\(\chi^2\)</span>-distribution with degrees of freedom calculated using the difference in the two models’ parameters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Model <span class="dv">1</span><span class="sc">:</span>  model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> trt01pn age sex ph_ecog2 meal_caln;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Model Fit Statistics</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Criterion   Intercept Only     Intercept and Covariates       </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>AIC         <span class="fl">204.355</span>            <span class="fl">202.460</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>SC          <span class="fl">207.491</span>            <span class="fl">221.274</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> Log L    <span class="fl">202.355</span>            <span class="fl">190.460</span>   </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Model <span class="dv">2</span><span class="sc">:</span>  model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> trt01pn sex ph_ecog2 meal_caln;</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>Model Fit Statistics</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>Criterion   Intercept Only     Intercept and Covariates       </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>AIC         <span class="fl">204.355</span>            <span class="fl">200.798</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>SC          <span class="fl">207.491</span>            <span class="fl">216.477</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span> Log L    <span class="fl">202.355</span>            <span class="fl">190.798</span>   </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>190.460 - 190.798 = -0.338 which using a <span class="math inline">\(\chi^2\)</span>-distribution corresponds to p=0.5606</p>
<p>SAS also allows us to fit forward or backwards stepwise selection. Below we specify to stop when we have 4 variables left in the model. This is not commonly done in practice but is included to highlight the difference in using a selection procedure compared to doing the difference betweeen the -2 * log likelihood models using a <span class="math inline">\(\chi^2\)</span>-distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">trt01pn</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>glm;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> trt01pn age sex ph_ecog2 meal_caln<span class="sc">/</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>           selection<span class="ot">=</span>backward stop<span class="ot">=</span><span class="dv">4</span>;</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>run;  </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>Step <span class="dv">1</span><span class="sc">:</span> Effect age is removed</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Summary of Backward Elimination</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>Step   Effect Removed   DF     Number In     Wald Chi<span class="sc">-</span>Square   Pr<span class="sc">&gt;</span>ChiSq</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>      Age              <span class="dv">1</span>      <span class="dv">4</span>             <span class="fl">0.3356</span>            <span class="fl">0.5624</span>   </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>NOTE: the chi-square test summary of backward elimination, p=0.5624 is slightly different to using the -2 * log likelihood models using a <span class="math inline">\(\chi^2\)</span>-distribution p=0.5606.</p>
<p>This is because the backward elimination process in SAS uses the residual sums of squares and the F statistic. Starting with the full model, it removes the parameter with the least significant F statistic until all effects in the model have F statistics significant as a certain level. The F statistic is calculated as:</p>
<p><span class="math display">\[F=\frac{(RSS_{p-k}-RSS_p)/k}{RSS_p /(n-p-k)}\]</span> where RSS = Residual sums of squares, n=number of observations in the analysis, p=number of parameters in fuller model (exc. intercept), k=number of degrees of freedom associated with the effect you are dropping, <span class="math display">\[RSS_p\]</span> =RSS for the fuller model, <span class="math display">\[RSS_{p-k}\]</span> = RSS for the reduced model.</p>
</section>
<section id="parameterization-of-model-effects-categorical-covariates-in-sas" class="level2">
<h2 class="anchored" data-anchor-id="parameterization-of-model-effects-categorical-covariates-in-sas">Parameterization of model effects (categorical covariates) in SAS</h2>
<p>The most common problem when fitting logistic regression in SAS, is getting SAS to model the binary variable (events) and any categorical covariates correctly. Using <code>proc genmod</code> (using dist=bin and link=logit options), there is no issue as SAS defaults to using GLM parameterization. However using <code>proc logistic</code> there are three ways to parameterize categorical variables, and the default is <code>/PARAM=EFFECT</code> which can cause confusion when interpreting your model.</p>
<p>To demonstrate, we will now model a categorical variable called Dose, which has 3 treatment levels (1=10mg Active, 2=20 mg Active, 3=Placebo). The reference is now dose=3. You must pay close attention to the table of Class level information in order to understand how SAS is modelling your data.</p>
<section id="class-x-y-z-parameffect" class="level3">
<h3 class="anchored" data-anchor-id="class-x-y-z-parameffect">CLASS X Y Z /PARAM=Effect</h3>
<p>This is the SAS default such that if you do not specify the <code>/param</code> option, SAS defaults to using this method.</p>
<p>With the EFFECT option, dose_id has 3 levels, and so needs 2 design variables (β1 and β2). Sex has 2 levels so uses just 1 design variable (β1). For dose_id, the reference level (Placebo) is given values of “-1” for both of the β1 and β2 parameters. General model: Y= α + β1x1 + β2x1 {+β3x3} etc, representing each parameter in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>effect;</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Class Level Information</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Class       Value            Design Variables</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                             dose_β1  dose_β2</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>dose_id      <span class="dv">1</span>                <span class="dv">1</span>           <span class="dv">0</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>                <span class="dv">0</span>           <span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span>               <span class="sc">-</span><span class="dv">1</span>          <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                             sex_β3      </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>SEX          <span class="dv">1</span>               <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>                <span class="dv">1</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>If we want to estimate the effect of <span class="fu">treatment</span> (ignoring the other covariates), the Class Level Information can be translated into the table below, which is then used to form contrast statements.</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>α is the intercept, and β1 and β2 (including the sign <span class="sc">+</span><span class="er">/</span><span class="sc">-</span>) are from the design variables above.</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>Dose_id       Effect          </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>mg Active   Y <span class="ot">=</span> α <span class="sc">+</span> β1          </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>mg Active   Y <span class="ot">=</span> α <span class="sc">+</span> β2          </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>Placebo       Y <span class="ot">=</span> α <span class="sc">-</span> β1 <span class="sc">-</span> β2    </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>To compare <span class="dv">10</span>mg Active vs Placebo, we would do the following<span class="sc">:</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a> (α <span class="sc">+</span> β1 ) <span class="sc">-</span> (α <span class="sc">-</span> β1 <span class="sc">-</span> β2)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> <span class="dv">2</span> β1 <span class="sc">+</span> β2  </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> <span class="dv">2</span> β1 <span class="sc">+</span> <span class="dv">1</span> β2</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>This equates to a contrast statement as follows<span class="sc">:</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>effect;</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    CONTRAST <span class="st">"10mg vs. Placebo"</span> dose_id <span class="dv">2</span> <span class="dv">1</span> <span class="sc">/</span> e; </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>To compare the average <span class="fu">of</span> (<span class="dv">10</span>mg Active and <span class="dv">20</span>mg Active) vs Placebo, we would do the following<span class="sc">:</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>((α <span class="sc">+</span> β1 <span class="sc">+</span> α <span class="sc">+</span> β2 ) <span class="sc">/</span><span class="dv">2</span> ) <span class="sc">-</span> (α <span class="sc">-</span> β1 <span class="sc">-</span> β2)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> α <span class="sc">+</span> <span class="fl">0.5</span> β1 <span class="sc">+</span> <span class="fl">0.5</span> β2 <span class="sc">-</span> α <span class="sc">+</span> β1 <span class="sc">+</span> β2  </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> <span class="fl">1.5</span> β1 <span class="sc">+</span> <span class="fl">1.5</span> β2</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>This equates to a contrast statement as follows<span class="sc">:</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>effect;</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>    CONTRAST <span class="st">"Active (10mg + 20mg) vs. Placebo"</span> dose_id <span class="fl">1.5</span> <span class="fl">1.5</span> <span class="sc">/</span> e; </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>As you can see, these contrasts are not very intuitive and hence it is not reccomended to use the default SAS option of <span class="sc">/</span>param<span class="ot">=</span>effect, since its easy to end up with the wrong contrasts.</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>Contract Test Results</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>Contrast                           DF        Wald Chi<span class="sc">-</span>Square      Pr<span class="sc">&gt;</span>ChiSq</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="fu">Active</span> (<span class="dv">10</span>mg <span class="sc">+</span><span class="dv">20</span>mg) vs Placebo     <span class="dv">1</span>          <span class="fl">1.1610</span>               <span class="fl">0.2813</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="class-x-y-z-paramglm" class="level3">
<h3 class="anchored" data-anchor-id="class-x-y-z-paramglm">CLASS X Y Z /PARAM=glm</h3>
<p>Now let’s look at the <code>param=glm</code> option. GLM parameterization has a design variable for each level of a parameter. Hence for dose with 3 levels, we have 3 design variables (β1, β2 and β3).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>glm;</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Class Level Information</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Class       Value            Design Variables</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                             dose_β1  dose_β2 dose_β3</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>dose_id      <span class="dv">1</span>                <span class="dv">1</span>           <span class="dv">0</span>       <span class="dv">0</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>                <span class="dv">0</span>           <span class="dv">1</span>       <span class="dv">0</span>  </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span>                <span class="dv">0</span>           <span class="dv">0</span>       <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                             sex_β3   sex_β4   </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>SEX          <span class="dv">1</span>                <span class="dv">1</span>           <span class="dv">0</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>                <span class="dv">0</span>           <span class="dv">1</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>If we want to estimate the effect of <span class="fu">treatment</span> (ignoring the other covariates), the Class Level Information can be translated into the table below, which is then used to form contrast statements.</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>α is the intercept, and β1 and β2 and β3 (including the sign <span class="sc">+</span><span class="er">/</span><span class="sc">-</span>) are from the design variables above.</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>Dose_id       Effect          </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>mg Active   Y <span class="ot">=</span> α <span class="sc">+</span> β1          </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>mg Active   Y <span class="ot">=</span> α <span class="sc">+</span> β2          </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>Placebo       Y <span class="ot">=</span> α <span class="sc">-</span> β3    </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>To compare <span class="dv">10</span>mg Active vs Placebo, we would do the following<span class="sc">:</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a> (α <span class="sc">+</span> β1 ) <span class="sc">-</span> (α <span class="sc">-</span> β3)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>  β1 <span class="sc">-</span> β3  </span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> <span class="dv">1</span> β1 <span class="sc">-</span> <span class="dv">1</span> β3</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>This equates to a contrast statement as follows<span class="sc">:</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>glm;</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    CONTRAST <span class="st">"10mg vs. Placebo"</span> trt <span class="dv">1</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> e; </span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>As you can see, this contrast is much more intuitive. If you want to compare the effect of <span class="fu">Active</span> (<span class="dv">10</span>mg) compared to placebo,  you take the effect of <span class="dv">10</span>mg and subtract the effect of placebo <span class="sc">!</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>To compare the average <span class="fu">of</span> (<span class="dv">10</span>mg Active and <span class="dv">20</span>mg Active) vs Placebo, we would do the following<span class="sc">:</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>((α <span class="sc">+</span> β1 <span class="sc">+</span> α <span class="sc">+</span> β2)<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> (α <span class="sc">+</span> β3) </span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> α <span class="sc">+</span> <span class="fl">0.5</span> β1 <span class="sc">+</span> <span class="fl">0.5</span> β2 <span class="sc">-</span> α <span class="sc">-</span> β3 </span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> <span class="fl">0.5</span> β1 <span class="sc">+</span> <span class="fl">0.5</span> β2 <span class="sc">-</span> β3</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>This equates to a contrast statement as follows<span class="sc">:</span></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>proc logistic <span class="at">data=</span>lung;  </span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span><span class="at">param=</span>glm;</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>CONTRAST <span class="st">"Active (10mg + 20mg) vs. Placebo (1)"</span> trt <span class="fl">0.5</span> <span class="fl">0.5</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> e; </span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>As you can see, this contrast is much more intuitive. If you want to compare the average of <span class="fu">Active</span> (<span class="dv">10</span>mg <span class="sc">+</span> <span class="dv">20</span>mg) compared to placebo,  you take half the effect of <span class="dv">10</span>mg plus half the effect of <span class="dv">20</span>mg and substract the effect of placebo <span class="sc">!</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>Contract Test Results</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>Contrast                           DF        Wald Chi<span class="sc">-</span>Square      Pr<span class="sc">&gt;</span>ChiSq</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="fu">Active</span> (<span class="dv">10</span>mg <span class="sc">+</span><span class="dv">20</span>mg) vs Placebo     <span class="dv">1</span>          <span class="fl">1.1610</span>               <span class="fl">0.2813</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="class-x-y-z-paramref" class="level3">
<h3 class="anchored" data-anchor-id="class-x-y-z-paramref">CLASS X Y Z /PARAM=Ref</h3>
<p>Now let’s look at the <code>param=ref</code> option. Similar to param=effect, ref parameterization uses 1 less design variable compared to the number of levels each parameter has, but the parameterization is different. For dose with 3 levels, we have 2 design variables (β1 and β2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;   </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>ref;</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>Class Level Information</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>Class       Value            Design Variables</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                             dose_β1  dose_β2 </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>dose_id      <span class="dv">1</span>                <span class="dv">1</span>           <span class="dv">0</span>       </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>                <span class="dv">0</span>           <span class="dv">1</span>         </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span>                <span class="dv">0</span>           <span class="dv">0</span>       </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>             </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                             sex_β3     </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>SEX          <span class="dv">1</span>                <span class="dv">0</span>           </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span>                <span class="dv">1</span>           </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>If we want to estimate the effect of <span class="fu">treatment</span> (ignoring the other covariates), the Class Level Information can be translated into the table below, which is then used to form contrast statements.</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>α is the intercept, and β1 and β2 and β3 (including the sign <span class="sc">+</span><span class="er">/</span><span class="sc">-</span>) are from the design variables above.</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                              </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>Dose_id       Effect          </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span>mg Active   Y <span class="ot">=</span> α <span class="sc">+</span> β1          </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>mg Active   Y <span class="ot">=</span> α <span class="sc">+</span> β2          </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>Placebo       Y <span class="ot">=</span> α     </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>To compare <span class="dv">10</span>mg Active vs Placebo, we would do the following<span class="sc">:</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a> (α <span class="sc">+</span> β1 ) <span class="sc">-</span> (α )</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>  β1  </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>This equates to a contrast statement as follows<span class="sc">:</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;  </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>glm;</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    CONTRAST <span class="st">"10mg vs. Placebo"</span> trt <span class="dv">1</span>  <span class="sc">/</span> e; </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>To compare the average <span class="fu">of</span> (<span class="dv">10</span>mg Active and <span class="dv">20</span>mg Active) vs Placebo, we would do the following<span class="sc">:</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>((α <span class="sc">+</span> β1 <span class="sc">+</span> α <span class="sc">+</span> β2)<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span>  α  </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> α <span class="sc">+</span> <span class="fl">0.5</span> β1 <span class="sc">+</span> <span class="fl">0.5</span> β2 <span class="sc">-</span> α  </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> <span class="fl">0.5</span> β1 <span class="sc">+</span> <span class="fl">0.5</span> β2 </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>This equates to a contrast statement as follows<span class="sc">:</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>proc logistic <span class="at">data=</span>lung;  </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span><span class="at">param=</span>glm;</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    model  <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln;</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>CONTRAST <span class="st">"Active (10mg + 20mg) vs. Placebo (1)"</span> trt <span class="fl">0.5</span> <span class="fl">0.5</span>  <span class="sc">/</span> e; </span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>Again this is less intuitive than the <span class="at">param=</span>glm parameterization,  but the same results are obtained.</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>Contract Test Results</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>Contrast                           DF        Wald Chi<span class="sc">-</span>Square      Pr<span class="sc">&gt;</span>ChiSq</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a><span class="fu">Active</span> (<span class="dv">10</span>mg <span class="sc">+</span><span class="dv">20</span>mg) vs Placebo     <span class="dv">1</span>          <span class="fl">1.1610</span>               <span class="fl">0.2813</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="contrast-statements-for-2-or-more-treatments" class="level1">
<h1>Contrast statements for 2 or more treatments</h1>
<p>The Contrast statement, only outputs the p-value for the contrast, but it is common to also require an estimate of the difference between the treatments, with associated 95% CI. You can do this by changing <code>contrast</code> to an <code>estimate</code> statement. Note that the parameterization of the contrast remains the same as when using a contrast statement as shown below. These estimates and 95% CI’s can be back transformed to give you the Odds ratio of the contrast and associated 95% CI. The estimate coefficients table should be checked for accuracy versus the contrast you are trying to do.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>proc logistic data<span class="ot">=</span>lung;</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>class <span class="fu">dose_id</span> (<span class="at">ref=</span><span class="st">"3"</span>) <span class="fu">sex</span> (<span class="at">ref=</span><span class="st">"1"</span>) <span class="sc">/</span>param<span class="ot">=</span>glm;</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>model <span class="fu">wt_gain</span>(<span class="at">event=</span><span class="st">"1"</span>) <span class="ot">=</span> dose_id age sex ph_ecog2 meal_caln; </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Estimate <span class="st">"Active (10mg + 20mg) vs. Placebo (1)"</span> dose_id <span class="fl">0.5</span> <span class="fl">0.5</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> e cl; </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>run;</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>Estimate Coefficients</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>Parameter   dose_id    sex    Row1</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>dose_id <span class="dv">1</span>   <span class="dv">1</span>                 <span class="fl">0.5</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>dose_id <span class="dv">2</span>   <span class="dv">2</span>                 <span class="fl">0.5</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>dose_id <span class="dv">3</span>   <span class="dv">3</span>                 <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>Estimate</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>Label      estimate   Std Err   Z value   Pr<span class="sc">&gt;</span><span class="er">|</span>z<span class="sc">|</span> Alpha  Lower  Upper</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">Active</span> (<span class="dv">10</span>mg <span class="sc">+</span><span class="dv">20</span>mg) vs. <span class="fu">Placebo</span> (<span class="dv">1</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>           <span class="sc">-</span><span class="fl">0.4096</span>    <span class="fl">0.3802</span>    <span class="sc">-</span><span class="fl">1.08</span>     <span class="fl">0.2813</span>  <span class="fl">0.05</span>  <span class="sc">-</span><span class="fl">1.1547</span>  <span class="fl">0.3355</span>  </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="sc">--------------------------------------------------------------------------</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>The odds ratio <span class="cf">for</span> the comparison of <span class="fu">Active</span> (<span class="dv">10</span>mg <span class="sc">+</span><span class="dv">20</span>mg) vs. Placebo is </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.4096</span>) (<span class="dv">95</span>% CI<span class="sc">:</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">1.1547</span>) to <span class="fu">exp</span>(<span class="fl">0.3355</span>))</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span> OR<span class="sc">:</span> <span class="fl">0.664</span> (<span class="dv">95</span>%CI <span class="cf">for</span> OR<span class="sc">:</span> <span class="fl">0.315</span> to <span class="fl">1.399</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ensuring-you-are-modelling-the-correct-binary-event-in-sas" class="level1">
<h1>Ensuring you are modelling the correct Binary event in SAS</h1>
<p>With logistic regression, we often want to model the number of “Successes”. However, by default, SAS sorts alphabetically/numerically and selects the first occurring EVENT alphabetically as the one it’s going to model.</p>
<p>It’s a common mistake, and we find SAS modelling the number of failures instead of successes. Very common when your response is: ‘Responder’ vs ‘Non-responder’, SAS will model the Non-responders as ‘N’ is alphabetically first before ‘R’!</p>
<p>For this reason, It is recommended to always use the event=“Y” option.</p>
<p>Options such as <code>ORDER=DATA|FORMATTED|FREQ|INTERNAL</code> as well as descending can be used to ensure the correct levels of classification variables are being modelled. More detail <a href="https://support.sas.com/documentation/cdl/en/statug/63347/HTML/default/viewer.htm#statug_logistic_sect006.htm">here</a></p>
</section>
<section id="references" class="level1">
<h1>References</h1>
<p>Created using : SAS release:9.04.01M7P08062020”</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>